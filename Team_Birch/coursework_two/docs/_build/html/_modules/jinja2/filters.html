

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>jinja2.filters &mdash; Coursework Two 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Coursework Two
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation_guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage_instructions.html">Usage Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture_overview.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Coursework Two</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">jinja2.filters</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for jinja2.filters</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Built-in template filters used with the ``|`` operator.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">typing</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">t</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">abc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inspect</span><span class="w"> </span><span class="kn">import</span> <span class="n">getattr_static</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">chain</span><span class="p">,</span> <span class="n">groupby</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">markupsafe</span><span class="w"> </span><span class="kn">import</span> <span class="n">Markup</span><span class="p">,</span> <span class="n">escape</span><span class="p">,</span> <span class="n">soft_str</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.async_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">async_variant</span><span class="p">,</span> <span class="n">auto_aiter</span><span class="p">,</span> <span class="n">auto_await</span><span class="p">,</span> <span class="n">auto_to_list</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">FilterArgumentError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.runtime</span><span class="w"> </span><span class="kn">import</span> <span class="n">Undefined</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">htmlsafe_json_dumps</span><span class="p">,</span>
    <span class="n">pass_context</span><span class="p">,</span>
    <span class="n">pass_environment</span><span class="p">,</span>
    <span class="n">pass_eval_context</span><span class="p">,</span>
    <span class="n">pformat</span><span class="p">,</span>
    <span class="n">url_quote</span><span class="p">,</span>
    <span class="n">urlize</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">typing_extensions</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">te</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">.environment</span><span class="w"> </span><span class="kn">import</span> <span class="n">Environment</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.nodes</span><span class="w"> </span><span class="kn">import</span> <span class="n">EvalContext</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.runtime</span><span class="w"> </span><span class="kn">import</span> <span class="n">Context</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.sandbox</span><span class="w"> </span><span class="kn">import</span> <span class="n">SandboxedEnvironment</span>  <span class="c1"># noqa: F401</span>

<div class="viewcode-block" id="HasHTML">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.HasHTML">[docs]</a>
    <span class="k">class</span><span class="w"> </span><span class="nc">HasHTML</span><span class="p">(</span><span class="n">te</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">__html__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">pass</span></div>



<div class="viewcode-block" id="F">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.F">[docs]</a>
<span class="n">F</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">])</span></div>

<div class="viewcode-block" id="K">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.K">[docs]</a>
<span class="n">K</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="V">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.V">[docs]</a>
<span class="n">V</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="ignore_case">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.ignore_case">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ignore_case</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">V</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">V</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;For use as a postprocessor for :func:`make_attrgetter`. Converts strings</span>
<span class="sd">    to lowercase and returns other types as-is.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">value</span></div>



<div class="viewcode-block" id="make_attrgetter">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.make_attrgetter">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">make_attrgetter</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
    <span class="n">postprocess</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a callable that looks up the given attribute from a</span>
<span class="sd">    passed object with the rules of the environment.  Dots are allowed</span>
<span class="sd">    to access attributes of attributes.  Integer parts in paths are</span>
<span class="sd">    looked up as integers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">_prepare_attribute_parts</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">attrgetter</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="n">getitem</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">part</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Undefined</span><span class="p">):</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">default</span>

        <span class="k">if</span> <span class="n">postprocess</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">postprocess</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">item</span>

    <span class="k">return</span> <span class="n">attrgetter</span></div>



<div class="viewcode-block" id="make_multi_attrgetter">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.make_multi_attrgetter">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">make_multi_attrgetter</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
    <span class="n">postprocess</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a callable that looks up the given comma separated</span>
<span class="sd">    attributes from a passed object with the rules of the environment.</span>
<span class="sd">    Dots are allowed to access attributes of each attribute.  Integer</span>
<span class="sd">    parts in paths are looked up as integers.</span>

<span class="sd">    The value returned by the returned callable is a list of extracted</span>
<span class="sd">    attribute values.</span>

<span class="sd">    Examples of attribute: &quot;attr1,attr2&quot;, &quot;attr1.inner1.0,attr2.inner2.0&quot;, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">split</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">split</span> <span class="o">=</span> <span class="p">[</span><span class="n">attribute</span><span class="p">]</span>

    <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">_prepare_attribute_parts</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">split</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">attrgetter</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">attribute_part</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parts</span><span class="p">):</span>
            <span class="n">item_i</span> <span class="o">=</span> <span class="n">item</span>

            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">attribute_part</span><span class="p">:</span>
                <span class="n">item_i</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="n">getitem</span><span class="p">(</span><span class="n">item_i</span><span class="p">,</span> <span class="n">part</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">postprocess</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">item_i</span> <span class="o">=</span> <span class="n">postprocess</span><span class="p">(</span><span class="n">item_i</span><span class="p">)</span>

            <span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">item_i</span>

        <span class="k">return</span> <span class="n">items</span>

    <span class="k">return</span> <span class="n">attrgetter</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">_prepare_attribute_parts</span><span class="p">(</span>
    <span class="n">attr</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="k">if</span> <span class="n">attr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">attr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">attr</span><span class="p">]</span>


<div class="viewcode-block" id="do_forceescape">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_forceescape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_forceescape</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Union[str, HasHTML]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Markup</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enforce HTML escaping.  This will probably double escape variables.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;__html__&quot;</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;HasHTML&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">__html__</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">escape</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></div>



<div class="viewcode-block" id="do_urlencode">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_urlencode">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_urlencode</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Quote data for use in a URL path or query using UTF-8.</span>

<span class="sd">    Basic wrapper around :func:`urllib.parse.quote` when given a</span>
<span class="sd">    string, or :func:`urllib.parse.urlencode` for a dict or iterable.</span>

<span class="sd">    :param value: Data to quote. A string will be quoted directly. A</span>
<span class="sd">        dict or iterable of ``(key, value)`` pairs will be joined as a</span>
<span class="sd">        query string.</span>

<span class="sd">    When given a string, &quot;/&quot; is not quoted. HTTP servers treat &quot;/&quot; and</span>
<span class="sd">    &quot;%2F&quot; equivalently in paths. If you need quoted slashes, use the</span>
<span class="sd">    ``|replace(&quot;/&quot;, &quot;%2F&quot;)`` filter.</span>

<span class="sd">    .. versionadded:: 2.7</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">url_quote</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">items</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">value</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="s2">&quot;&amp;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url_quote</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">for_qs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">url_quote</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">for_qs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">items</span>
    <span class="p">)</span></div>



<span class="nd">@pass_eval_context</span>
<div class="viewcode-block" id="do_replace">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_replace">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_replace</span><span class="p">(</span>
    <span class="n">eval_ctx</span><span class="p">:</span> <span class="s2">&quot;EvalContext&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">old</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a copy of the value with all occurrences of a substring</span>
<span class="sd">    replaced with a new one. The first argument is the substring</span>
<span class="sd">    that should be replaced, the second is the replacement string.</span>
<span class="sd">    If the optional third argument ``count`` is given, only the first</span>
<span class="sd">    ``count`` occurrences are replaced:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ &quot;Hello World&quot;|replace(&quot;Hello&quot;, &quot;Goodbye&quot;) }}</span>
<span class="sd">            -&gt; Goodbye World</span>

<span class="sd">        {{ &quot;aaaaargh&quot;|replace(&quot;a&quot;, &quot;d&#39;oh, &quot;, 2) }}</span>
<span class="sd">            -&gt; d&#39;oh, d&#39;oh, aaargh</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">count</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">eval_ctx</span><span class="o">.</span><span class="n">autoescape</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">old</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">new</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">hasattr</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="s2">&quot;__html__&quot;</span><span class="p">)</span>
        <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="s2">&quot;__html__&quot;</span><span class="p">)</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;__html__&quot;</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">escape</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">soft_str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">soft_str</span><span class="p">(</span><span class="n">old</span><span class="p">),</span> <span class="n">soft_str</span><span class="p">(</span><span class="n">new</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span></div>



<div class="viewcode-block" id="do_upper">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_upper">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_upper</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a value to uppercase.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">soft_str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span></div>



<div class="viewcode-block" id="do_lower">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_lower">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_lower</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a value to lowercase.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">soft_str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></div>



<div class="viewcode-block" id="do_items">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_items">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_items</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">V</span><span class="p">],</span> <span class="n">Undefined</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">V</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an iterator over the ``(key, value)`` items of a mapping.</span>

<span class="sd">    ``x|items`` is the same as ``x.items()``, except if ``x`` is</span>
<span class="sd">    undefined an empty iterator is returned.</span>

<span class="sd">    This filter is useful if you expect the template to be rendered with</span>
<span class="sd">    an implementation of Jinja in another programming language that does</span>
<span class="sd">    not have a ``.items()`` method on its mapping type.</span>

<span class="sd">    .. code-block:: html+jinja</span>

<span class="sd">        &lt;dl&gt;</span>
<span class="sd">        {% for key, value in my_dict|items %}</span>
<span class="sd">            &lt;dt&gt;{{ key }}</span>
<span class="sd">            &lt;dd&gt;{{ value }}</span>
<span class="sd">        {% endfor %}</span>
<span class="sd">        &lt;/dl&gt;</span>

<span class="sd">    .. versionadded:: 3.1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Undefined</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can only get item pairs from a mapping.&quot;</span><span class="p">)</span>

    <span class="k">yield from</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">()</span></div>



<span class="c1"># Check for characters that would move the parser state from key to value.</span>
<span class="c1"># https://html.spec.whatwg.org/#attribute-name-state</span>
<span class="n">_attr_key_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[\s/&gt;=]&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">ASCII</span><span class="p">)</span>


<span class="nd">@pass_eval_context</span>
<div class="viewcode-block" id="do_xmlattr">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_xmlattr">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_xmlattr</span><span class="p">(</span>
    <span class="n">eval_ctx</span><span class="p">:</span> <span class="s2">&quot;EvalContext&quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">autospace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an SGML/XML attribute string based on the items in a dict.</span>

<span class="sd">    **Values** that are neither ``none`` nor ``undefined`` are automatically</span>
<span class="sd">    escaped, safely allowing untrusted user input.</span>

<span class="sd">    User input should not be used as **keys** to this filter. If any key</span>
<span class="sd">    contains a space, ``/`` solidus, ``&gt;`` greater-than sign, or ``=`` equals</span>
<span class="sd">    sign, this fails with a ``ValueError``. Regardless of this, user input</span>
<span class="sd">    should never be used as keys to this filter, or must be separately validated</span>
<span class="sd">    first.</span>

<span class="sd">    .. sourcecode:: html+jinja</span>

<span class="sd">        &lt;ul{{ {&#39;class&#39;: &#39;my_list&#39;, &#39;missing&#39;: none,</span>
<span class="sd">                &#39;id&#39;: &#39;list-%d&#39;|format(variable)}|xmlattr }}&gt;</span>
<span class="sd">        ...</span>
<span class="sd">        &lt;/ul&gt;</span>

<span class="sd">    Results in something like this:</span>

<span class="sd">    .. sourcecode:: html</span>

<span class="sd">        &lt;ul class=&quot;my_list&quot; id=&quot;list-42&quot;&gt;</span>
<span class="sd">        ...</span>
<span class="sd">        &lt;/ul&gt;</span>

<span class="sd">    As you can see it automatically prepends a space in front of the item</span>
<span class="sd">    if the filter returned something unless the second parameter is false.</span>

<span class="sd">    .. versionchanged:: 3.1.4</span>
<span class="sd">        Keys with ``/`` solidus, ``&gt;`` greater-than sign, or ``=`` equals sign</span>
<span class="sd">        are not allowed.</span>

<span class="sd">    .. versionchanged:: 3.1.3</span>
<span class="sd">        Keys with spaces are not allowed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Undefined</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">_attr_key_re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid character in attribute name: </span><span class="si">{</span><span class="n">key</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">escape</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s1">=&quot;</span><span class="si">{</span><span class="n">escape</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

    <span class="n">rv</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">autospace</span> <span class="ow">and</span> <span class="n">rv</span><span class="p">:</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">rv</span>

    <span class="k">if</span> <span class="n">eval_ctx</span><span class="o">.</span><span class="n">autoescape</span><span class="p">:</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">Markup</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rv</span></div>



<div class="viewcode-block" id="do_capitalize">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_capitalize">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_capitalize</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Capitalize a value. The first character will be uppercase, all others</span>
<span class="sd">    lowercase.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">soft_str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span></div>



<span class="n">_word_beginning_split_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([-\s({\[&lt;]+)&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="do_title">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_title">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_title</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a titlecased version of the value. I.e. words will start with</span>
<span class="sd">    uppercase letters, all remaining characters are lowercase.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">_word_beginning_split_re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">soft_str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">item</span>
        <span class="p">]</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="do_dictsort">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_dictsort">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_dictsort</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">V</span><span class="p">],</span>
    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">by</span><span class="p">:</span> <span class="s1">&#39;te.Literal[&quot;key&quot;, &quot;value&quot;]&#39;</span> <span class="o">=</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span>
    <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">V</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort a dict and yield (key, value) pairs. Python dicts may not</span>
<span class="sd">    be in the order you want to display them in, so sort them first.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {% for key, value in mydict|dictsort %}</span>
<span class="sd">            sort the dict by key, case insensitive</span>

<span class="sd">        {% for key, value in mydict|dictsort(reverse=true) %}</span>
<span class="sd">            sort the dict by key, case insensitive, reverse order</span>

<span class="sd">        {% for key, value in mydict|dictsort(true) %}</span>
<span class="sd">            sort the dict by key, case sensitive</span>

<span class="sd">        {% for key, value in mydict|dictsort(false, &#39;value&#39;) %}</span>
<span class="sd">            sort the dict by value, case insensitive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">by</span> <span class="o">==</span> <span class="s2">&quot;key&quot;</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">by</span> <span class="o">==</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">FilterArgumentError</span><span class="p">(</span><span class="s1">&#39;You can only sort by either &quot;key&quot; or &quot;value&quot;&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sort_func</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">case_sensitive</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">ignore_case</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">sort_func</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span></div>



<span class="nd">@pass_environment</span>
<div class="viewcode-block" id="do_sort">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_sort">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_sort</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span>
    <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.List[V]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort an iterable using Python&#39;s :func:`sorted`.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {% for city in cities|sort %}</span>
<span class="sd">            ...</span>
<span class="sd">        {% endfor %}</span>

<span class="sd">    :param reverse: Sort descending instead of ascending.</span>
<span class="sd">    :param case_sensitive: When sorting strings, sort upper and lower</span>
<span class="sd">        case separately.</span>
<span class="sd">    :param attribute: When sorting objects or dicts, an attribute or</span>
<span class="sd">        key to sort by. Can use dot notation like ``&quot;address.city&quot;``.</span>
<span class="sd">        Can be a list of attributes like ``&quot;age,name&quot;``.</span>

<span class="sd">    The sort is stable, it does not change the relative order of</span>
<span class="sd">    elements that compare equal. This makes it is possible to chain</span>
<span class="sd">    sorts on different attributes and ordering.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {% for user in users|sort(attribute=&quot;name&quot;)</span>
<span class="sd">            |sort(reverse=true, attribute=&quot;age&quot;) %}</span>
<span class="sd">            ...</span>
<span class="sd">        {% endfor %}</span>

<span class="sd">    As a shortcut to chaining when the direction is the same for all</span>
<span class="sd">    attributes, pass a comma separate list of attributes.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {% for user in users|sort(attribute=&quot;age,name&quot;) %}</span>
<span class="sd">            ...</span>
<span class="sd">        {% endfor %}</span>

<span class="sd">    .. versionchanged:: 2.11.0</span>
<span class="sd">        The ``attribute`` parameter can be a comma separated list of</span>
<span class="sd">        attributes, e.g. ``&quot;age,name&quot;``.</span>

<span class="sd">    .. versionchanged:: 2.6</span>
<span class="sd">       The ``attribute`` parameter was added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key_func</span> <span class="o">=</span> <span class="n">make_multi_attrgetter</span><span class="p">(</span>
        <span class="n">environment</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">postprocess</span><span class="o">=</span><span class="n">ignore_case</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">case_sensitive</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key_func</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span></div>



<span class="nd">@pass_environment</span>
<div class="viewcode-block" id="sync_do_unique">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_unique">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_unique</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span>
    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Iterator[V]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a list of unique items from the given iterable.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ [&#39;foo&#39;, &#39;bar&#39;, &#39;foobar&#39;, &#39;FooBar&#39;]|unique|list }}</span>
<span class="sd">            -&gt; [&#39;foo&#39;, &#39;bar&#39;, &#39;foobar&#39;]</span>

<span class="sd">    The unique items are yielded in the same order as their first occurrence in</span>
<span class="sd">    the iterable passed to the filter.</span>

<span class="sd">    :param case_sensitive: Treat upper and lower case strings as distinct.</span>
<span class="sd">    :param attribute: Filter objects with unique values for this attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">getter</span> <span class="o">=</span> <span class="n">make_attrgetter</span><span class="p">(</span>
        <span class="n">environment</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">postprocess</span><span class="o">=</span><span class="n">ignore_case</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">case_sensitive</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">getter</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
            <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">item</span></div>



<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_unique</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<div class="viewcode-block" id="do_unique">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_unique">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_unique</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Union[t.AsyncIterable[V], t.Iterable[V]]&quot;</span><span class="p">,</span>
    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Iterator[V]&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">sync_do_unique</span><span class="p">(</span>
        <span class="n">environment</span><span class="p">,</span> <span class="k">await</span> <span class="n">auto_to_list</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">case_sensitive</span><span class="p">,</span> <span class="n">attribute</span>
    <span class="p">)</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">_min_or_max</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="s2">&quot;t.Callable[..., V]&quot;</span><span class="p">,</span>
    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Union[V, Undefined]&quot;</span><span class="p">:</span>
    <span class="n">it</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">first</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">environment</span><span class="o">.</span><span class="n">undefined</span><span class="p">(</span><span class="s2">&quot;No aggregated item, sequence was empty.&quot;</span><span class="p">)</span>

    <span class="n">key_func</span> <span class="o">=</span> <span class="n">make_attrgetter</span><span class="p">(</span>
        <span class="n">environment</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">postprocess</span><span class="o">=</span><span class="n">ignore_case</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">case_sensitive</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">chain</span><span class="p">([</span><span class="n">first</span><span class="p">],</span> <span class="n">it</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">key_func</span><span class="p">)</span>


<span class="nd">@pass_environment</span>
<div class="viewcode-block" id="do_min">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_min">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_min</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span>
    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Union[V, Undefined]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the smallest item from the sequence.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ [1, 2, 3]|min }}</span>
<span class="sd">            -&gt; 1</span>

<span class="sd">    :param case_sensitive: Treat upper and lower case strings as distinct.</span>
<span class="sd">    :param attribute: Get the object with the min value of this attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_min_or_max</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span></div>



<span class="nd">@pass_environment</span>
<div class="viewcode-block" id="do_max">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_max">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_max</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span>
    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Union[V, Undefined]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the largest item from the sequence.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ [1, 2, 3]|max }}</span>
<span class="sd">            -&gt; 3</span>

<span class="sd">    :param case_sensitive: Treat upper and lower case strings as distinct.</span>
<span class="sd">    :param attribute: Get the object with the max value of this attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_min_or_max</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span></div>



<div class="viewcode-block" id="do_default">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_default">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_default</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">V</span><span class="p">,</span>
    <span class="n">default_value</span><span class="p">:</span> <span class="n">V</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
    <span class="n">boolean</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">V</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;If the value is undefined it will return the passed default value,</span>
<span class="sd">    otherwise the value of the variable:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ my_variable|default(&#39;my_variable is not defined&#39;) }}</span>

<span class="sd">    This will output the value of ``my_variable`` if the variable was</span>
<span class="sd">    defined, otherwise ``&#39;my_variable is not defined&#39;``. If you want</span>
<span class="sd">    to use default with variables that evaluate to false you have to</span>
<span class="sd">    set the second parameter to `true`:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ &#39;&#39;|default(&#39;the string was empty&#39;, true) }}</span>

<span class="sd">    .. versionchanged:: 2.11</span>
<span class="sd">       It&#39;s now possible to configure the :class:`~jinja2.Environment` with</span>
<span class="sd">       :class:`~jinja2.ChainableUndefined` to make the `default` filter work</span>
<span class="sd">       on nested elements and attributes that may contain undefined values</span>
<span class="sd">       in the chain without getting an :exc:`~jinja2.UndefinedError`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Undefined</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">boolean</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">default_value</span>

    <span class="k">return</span> <span class="n">value</span></div>



<span class="nd">@pass_eval_context</span>
<div class="viewcode-block" id="sync_do_join">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_join">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_join</span><span class="p">(</span>
    <span class="n">eval_ctx</span><span class="p">:</span> <span class="s2">&quot;EvalContext&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">d</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string which is the concatenation of the strings in the</span>
<span class="sd">    sequence. The separator between elements is an empty string per</span>
<span class="sd">    default, you can define it with the optional parameter:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ [1, 2, 3]|join(&#39;|&#39;) }}</span>
<span class="sd">            -&gt; 1|2|3</span>

<span class="sd">        {{ [1, 2, 3]|join }}</span>
<span class="sd">            -&gt; 123</span>

<span class="sd">    It is also possible to join certain attributes of an object:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ users|join(&#39;, &#39;, attribute=&#39;username&#39;) }}</span>

<span class="sd">    .. versionadded:: 2.6</span>
<span class="sd">       The `attribute` parameter was added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">attribute</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">make_attrgetter</span><span class="p">(</span><span class="n">eval_ctx</span><span class="o">.</span><span class="n">environment</span><span class="p">,</span> <span class="n">attribute</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>

    <span class="c1"># no automatic escaping?  joining is a lot easier then</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">eval_ctx</span><span class="o">.</span><span class="n">autoescape</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

    <span class="c1"># if the delimiter doesn&#39;t have an html representation we check</span>
    <span class="c1"># if any of the items has.  If yes we do a coercion to Markup</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s2">&quot;__html__&quot;</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">do_escape</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;__html__&quot;</span><span class="p">):</span>
                <span class="n">do_escape</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">do_escape</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">escape</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="c1"># no html involved, to normal joining</span>
    <span class="k">return</span> <span class="n">soft_str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">soft_str</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span></div>



<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_join</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<div class="viewcode-block" id="do_join">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_join">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_join</span><span class="p">(</span>
    <span class="n">eval_ctx</span><span class="p">:</span> <span class="s2">&quot;EvalContext&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">AsyncIterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span>
    <span class="n">d</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">sync_do_join</span><span class="p">(</span><span class="n">eval_ctx</span><span class="p">,</span> <span class="k">await</span> <span class="n">auto_to_list</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">d</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span></div>



<div class="viewcode-block" id="do_center">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_center">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_center</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Centers the value in a field of a given width.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">soft_str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">)</span></div>



<span class="nd">@pass_environment</span>
<div class="viewcode-block" id="sync_do_first">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_first">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_first</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span> <span class="n">seq</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Union[V, Undefined]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the first item of a sequence.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">environment</span><span class="o">.</span><span class="n">undefined</span><span class="p">(</span><span class="s2">&quot;No first item, sequence was empty.&quot;</span><span class="p">)</span></div>



<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_first</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<div class="viewcode-block" id="do_first">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_first">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_first</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span> <span class="n">seq</span><span class="p">:</span> <span class="s2">&quot;t.Union[t.AsyncIterable[V], t.Iterable[V]]&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Union[V, Undefined]&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">auto_aiter</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">StopAsyncIteration</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">environment</span><span class="o">.</span><span class="n">undefined</span><span class="p">(</span><span class="s2">&quot;No first item, sequence was empty.&quot;</span><span class="p">)</span></div>



<span class="nd">@pass_environment</span>
<div class="viewcode-block" id="do_last">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_last">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_last</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span> <span class="n">seq</span><span class="p">:</span> <span class="s2">&quot;t.Reversible[V]&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Union[V, Undefined]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the last item of a sequence.</span>

<span class="sd">    Note: Does not work with generators. You may want to explicitly</span>
<span class="sd">    convert it to a list:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ data | selectattr(&#39;name&#39;, &#39;==&#39;, &#39;Jinja&#39;) | list | last }}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">seq</span><span class="p">)))</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">environment</span><span class="o">.</span><span class="n">undefined</span><span class="p">(</span><span class="s2">&quot;No last item, sequence was empty.&quot;</span><span class="p">)</span></div>



<span class="c1"># No async do_last, it may not be safe in async mode.</span>


<span class="nd">@pass_context</span>
<div class="viewcode-block" id="do_random">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_random">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_random</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span> <span class="n">seq</span><span class="p">:</span> <span class="s2">&quot;t.Sequence[V]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Union[V, Undefined]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a random item from the sequence.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">undefined</span><span class="p">(</span><span class="s2">&quot;No random item, sequence was empty.&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="do_filesizeformat">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_filesizeformat">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_filesizeformat</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">binary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format the value like a &#39;human-readable&#39; file size (i.e. 13 kB,</span>
<span class="sd">    4.1 MB, 102 Bytes, etc).  Per default decimal prefixes are used (Mega,</span>
<span class="sd">    Giga, etc.), if the second parameter is set to `True` the binary</span>
<span class="sd">    prefixes are used (Mebi, Gibi).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">bytes</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="n">base</span> <span class="o">=</span> <span class="mi">1024</span> <span class="k">if</span> <span class="n">binary</span> <span class="k">else</span> <span class="mi">1000</span>
    <span class="n">prefixes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;KiB&quot;</span> <span class="k">if</span> <span class="n">binary</span> <span class="k">else</span> <span class="s2">&quot;kB&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;MiB&quot;</span> <span class="k">if</span> <span class="n">binary</span> <span class="k">else</span> <span class="s2">&quot;MB&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;GiB&quot;</span> <span class="k">if</span> <span class="n">binary</span> <span class="k">else</span> <span class="s2">&quot;GB&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;TiB&quot;</span> <span class="k">if</span> <span class="n">binary</span> <span class="k">else</span> <span class="s2">&quot;TB&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;PiB&quot;</span> <span class="k">if</span> <span class="n">binary</span> <span class="k">else</span> <span class="s2">&quot;PB&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;EiB&quot;</span> <span class="k">if</span> <span class="n">binary</span> <span class="k">else</span> <span class="s2">&quot;EB&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;ZiB&quot;</span> <span class="k">if</span> <span class="n">binary</span> <span class="k">else</span> <span class="s2">&quot;ZB&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;YiB&quot;</span> <span class="k">if</span> <span class="n">binary</span> <span class="k">else</span> <span class="s2">&quot;YB&quot;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="nb">bytes</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;1 Byte&quot;</span>
    <span class="k">elif</span> <span class="nb">bytes</span> <span class="o">&lt;</span> <span class="n">base</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="nb">bytes</span><span class="p">)</span><span class="si">}</span><span class="s2"> Bytes&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prefixes</span><span class="p">):</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="n">base</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">bytes</span> <span class="o">&lt;</span> <span class="n">unit</span><span class="p">:</span>
                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">unit</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">unit</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">&quot;</span></div>



<div class="viewcode-block" id="do_pprint">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_pprint">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_pprint</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pretty print a variable. Useful for debugging.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pformat</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>



<span class="n">_uri_scheme_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^([\w.+-]{2,}:(/){0,2})$&quot;</span><span class="p">)</span>


<span class="nd">@pass_eval_context</span>
<div class="viewcode-block" id="do_urlize">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_urlize">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_urlize</span><span class="p">(</span>
    <span class="n">eval_ctx</span><span class="p">:</span> <span class="s2">&quot;EvalContext&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">trim_url_limit</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">nofollow</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rel</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">extra_schemes</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert URLs in text into clickable links.</span>

<span class="sd">    This may not recognize links in some situations. Usually, a more</span>
<span class="sd">    comprehensive formatter, such as a Markdown library, is a better</span>
<span class="sd">    choice.</span>

<span class="sd">    Works on ``http://``, ``https://``, ``www.``, ``mailto:``, and email</span>
<span class="sd">    addresses. Links with trailing punctuation (periods, commas, closing</span>
<span class="sd">    parentheses) and leading punctuation (opening parentheses) are</span>
<span class="sd">    recognized excluding the punctuation. Email addresses that include</span>
<span class="sd">    header fields are not recognized (for example,</span>
<span class="sd">    ``mailto:address@example.com?cc=copy@example.com``).</span>

<span class="sd">    :param value: Original text containing URLs to link.</span>
<span class="sd">    :param trim_url_limit: Shorten displayed URL values to this length.</span>
<span class="sd">    :param nofollow: Add the ``rel=nofollow`` attribute to links.</span>
<span class="sd">    :param target: Add the ``target`` attribute to links.</span>
<span class="sd">    :param rel: Add the ``rel`` attribute to links.</span>
<span class="sd">    :param extra_schemes: Recognize URLs that start with these schemes</span>
<span class="sd">        in addition to the default behavior. Defaults to</span>
<span class="sd">        ``env.policies[&quot;urlize.extra_schemes&quot;]``, which defaults to no</span>
<span class="sd">        extra schemes.</span>

<span class="sd">    .. versionchanged:: 3.0</span>
<span class="sd">        The ``extra_schemes`` parameter was added.</span>

<span class="sd">    .. versionchanged:: 3.0</span>
<span class="sd">        Generate ``https://`` links for URLs without a scheme.</span>

<span class="sd">    .. versionchanged:: 3.0</span>
<span class="sd">        The parsing rules were updated. Recognize email addresses with</span>
<span class="sd">        or without the ``mailto:`` scheme. Validate IP addresses. Ignore</span>
<span class="sd">        parentheses and brackets in more cases.</span>

<span class="sd">    .. versionchanged:: 2.8</span>
<span class="sd">       The ``target`` parameter was added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">policies</span> <span class="o">=</span> <span class="n">eval_ctx</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">policies</span>
    <span class="n">rel_parts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="n">rel</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">nofollow</span><span class="p">:</span>
        <span class="n">rel_parts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;nofollow&quot;</span><span class="p">)</span>

    <span class="n">rel_parts</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">policies</span><span class="p">[</span><span class="s2">&quot;urlize.rel&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="n">rel</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">rel_parts</span><span class="p">))</span> <span class="ow">or</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">policies</span><span class="p">[</span><span class="s2">&quot;urlize.target&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">extra_schemes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">extra_schemes</span> <span class="o">=</span> <span class="n">policies</span><span class="p">[</span><span class="s2">&quot;urlize.extra_schemes&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="p">()</span>

    <span class="k">for</span> <span class="n">scheme</span> <span class="ow">in</span> <span class="n">extra_schemes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">_uri_scheme_re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">scheme</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FilterArgumentError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">scheme</span><span class="si">!r}</span><span class="s2"> is not a valid URI scheme prefix.&quot;</span><span class="p">)</span>

    <span class="n">rv</span> <span class="o">=</span> <span class="n">urlize</span><span class="p">(</span>
        <span class="n">value</span><span class="p">,</span>
        <span class="n">trim_url_limit</span><span class="o">=</span><span class="n">trim_url_limit</span><span class="p">,</span>
        <span class="n">rel</span><span class="o">=</span><span class="n">rel</span><span class="p">,</span>
        <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
        <span class="n">extra_schemes</span><span class="o">=</span><span class="n">extra_schemes</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">eval_ctx</span><span class="o">.</span><span class="n">autoescape</span><span class="p">:</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">Markup</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rv</span></div>



<div class="viewcode-block" id="do_indent">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_indent">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_indent</span><span class="p">(</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">blank</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a copy of the string with each line indented by 4 spaces. The</span>
<span class="sd">    first line and blank lines are not indented by default.</span>

<span class="sd">    :param width: Number of spaces, or a string, to indent by.</span>
<span class="sd">    :param first: Don&#39;t skip indenting the first line.</span>
<span class="sd">    :param blank: Don&#39;t skip indenting empty lines.</span>

<span class="sd">    .. versionchanged:: 3.0</span>
<span class="sd">        ``width`` can be a string.</span>

<span class="sd">    .. versionchanged:: 2.10</span>
<span class="sd">        Blank lines are not indented by default.</span>

<span class="sd">        Rename the ``indentfirst`` argument to ``first``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">indention</span> <span class="o">=</span> <span class="n">width</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">indention</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">width</span>

    <span class="n">newline</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">Markup</span><span class="p">):</span>
        <span class="n">indention</span> <span class="o">=</span> <span class="n">Markup</span><span class="p">(</span><span class="n">indention</span><span class="p">)</span>
        <span class="n">newline</span> <span class="o">=</span> <span class="n">Markup</span><span class="p">(</span><span class="n">newline</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">+=</span> <span class="n">newline</span>  <span class="c1"># this quirk is necessary for splitlines method</span>

    <span class="k">if</span> <span class="n">blank</span><span class="p">:</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="p">(</span><span class="n">newline</span> <span class="o">+</span> <span class="n">indention</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">+=</span> <span class="n">newline</span> <span class="o">+</span> <span class="n">newline</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">indention</span> <span class="o">+</span> <span class="n">line</span> <span class="k">if</span> <span class="n">line</span> <span class="k">else</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">first</span><span class="p">:</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">indention</span> <span class="o">+</span> <span class="n">rv</span>

    <span class="k">return</span> <span class="n">rv</span></div>



<span class="nd">@pass_environment</span>
<div class="viewcode-block" id="do_truncate">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_truncate">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_truncate</span><span class="p">(</span>
    <span class="n">env</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">255</span><span class="p">,</span>
    <span class="n">killwords</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">end</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="n">leeway</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a truncated copy of the string. The length is specified</span>
<span class="sd">    with the first parameter which defaults to ``255``. If the second</span>
<span class="sd">    parameter is ``true`` the filter will cut the text at length. Otherwise</span>
<span class="sd">    it will discard the last word. If the text was in fact</span>
<span class="sd">    truncated it will append an ellipsis sign (``&quot;...&quot;``). If you want a</span>
<span class="sd">    different ellipsis sign than ``&quot;...&quot;`` you can specify it using the</span>
<span class="sd">    third parameter. Strings that only exceed the length by the tolerance</span>
<span class="sd">    margin given in the fourth parameter will not be truncated.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ &quot;foo bar baz qux&quot;|truncate(9) }}</span>
<span class="sd">            -&gt; &quot;foo...&quot;</span>
<span class="sd">        {{ &quot;foo bar baz qux&quot;|truncate(9, True) }}</span>
<span class="sd">            -&gt; &quot;foo ba...&quot;</span>
<span class="sd">        {{ &quot;foo bar baz qux&quot;|truncate(11) }}</span>
<span class="sd">            -&gt; &quot;foo bar baz qux&quot;</span>
<span class="sd">        {{ &quot;foo bar baz qux&quot;|truncate(11, False, &#39;...&#39;, 0) }}</span>
<span class="sd">            -&gt; &quot;foo bar...&quot;</span>

<span class="sd">    The default leeway on newer Jinja versions is 5 and was 0 before but</span>
<span class="sd">    can be reconfigured globally.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">leeway</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">leeway</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">policies</span><span class="p">[</span><span class="s2">&quot;truncate.leeway&quot;</span><span class="p">]</span>

    <span class="k">assert</span> <span class="n">length</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">end</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;expected length &gt;= </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">end</span><span class="p">)</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="n">leeway</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;expected leeway &gt;= 0, got </span><span class="si">{</span><span class="n">leeway</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">length</span> <span class="o">+</span> <span class="n">leeway</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">if</span> <span class="n">killwords</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">s</span><span class="p">[:</span> <span class="n">length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">end</span><span class="p">)]</span> <span class="o">+</span> <span class="n">end</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">s</span><span class="p">[:</span> <span class="n">length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">end</span><span class="p">)]</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">result</span> <span class="o">+</span> <span class="n">end</span></div>



<span class="nd">@pass_environment</span>
<div class="viewcode-block" id="do_wordwrap">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_wordwrap">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_wordwrap</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">79</span><span class="p">,</span>
    <span class="n">break_long_words</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">wrapstring</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">break_on_hyphens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrap a string to the given width. Existing newlines are treated</span>
<span class="sd">    as paragraphs to be wrapped separately.</span>

<span class="sd">    :param s: Original text to wrap.</span>
<span class="sd">    :param width: Maximum length of wrapped lines.</span>
<span class="sd">    :param break_long_words: If a word is longer than ``width``, break</span>
<span class="sd">        it across lines.</span>
<span class="sd">    :param break_on_hyphens: If a word contains hyphens, it may be split</span>
<span class="sd">        across lines.</span>
<span class="sd">    :param wrapstring: String to join each wrapped line. Defaults to</span>
<span class="sd">        :attr:`Environment.newline_sequence`.</span>

<span class="sd">    .. versionchanged:: 2.11</span>
<span class="sd">        Existing newlines are treated as paragraphs wrapped separately.</span>

<span class="sd">    .. versionchanged:: 2.11</span>
<span class="sd">        Added the ``break_on_hyphens`` parameter.</span>

<span class="sd">    .. versionchanged:: 2.7</span>
<span class="sd">        Added the ``wrapstring`` parameter.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">textwrap</span>

    <span class="k">if</span> <span class="n">wrapstring</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">wrapstring</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="n">newline_sequence</span>

    <span class="c1"># textwrap.wrap doesn&#39;t consider existing newlines when wrapping.</span>
    <span class="c1"># If the string has a newline before width, wrap will still insert</span>
    <span class="c1"># a newline at width, resulting in a short line. Instead, split and</span>
    <span class="c1"># wrap each paragraph individually.</span>
    <span class="k">return</span> <span class="n">wrapstring</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">wrapstring</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span>
                    <span class="n">line</span><span class="p">,</span>
                    <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
                    <span class="n">expand_tabs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">replace_whitespace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">break_long_words</span><span class="o">=</span><span class="n">break_long_words</span><span class="p">,</span>
                    <span class="n">break_on_hyphens</span><span class="o">=</span><span class="n">break_on_hyphens</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="p">]</span>
    <span class="p">)</span></div>



<span class="n">_word_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\w+&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="do_wordcount">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_wordcount">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_wordcount</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Count the words in that string.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">_word_re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">soft_str</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span></div>



<div class="viewcode-block" id="do_int">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_int">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_int</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the value into an integer. If the</span>
<span class="sd">    conversion doesn&#39;t work it will return ``0``. You can</span>
<span class="sd">    override this default using the first parameter. You</span>
<span class="sd">    can also override the default base (10) in the second</span>
<span class="sd">    parameter, which handles input with prefixes such as</span>
<span class="sd">    0b, 0o and 0x for bases 2, 8 and 16 respectively.</span>
<span class="sd">    The base is ignored for decimal numbers and non-string values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="c1"># this quirk is necessary so that &quot;42.23&quot;|int gives 42.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="ne">OverflowError</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">default</span></div>



<div class="viewcode-block" id="do_float">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_float">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_float</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the value into a floating point number. If the</span>
<span class="sd">    conversion doesn&#39;t work it will return ``0.0``. You can</span>
<span class="sd">    override this default using the first parameter.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">default</span></div>



<div class="viewcode-block" id="do_format">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_format">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_format</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply the given values to a `printf-style`_ format string, like</span>
<span class="sd">    ``string % values``.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ &quot;%s, %s!&quot;|format(greeting, name) }}</span>
<span class="sd">        Hello, World!</span>

<span class="sd">    In most cases it should be more convenient and efficient to use the</span>
<span class="sd">    ``%`` operator or :meth:`str.format`.</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        {{ &quot;%s, %s!&quot; % (greeting, name) }}</span>
<span class="sd">        {{ &quot;{}, {}!&quot;.format(greeting, name) }}</span>

<span class="sd">    .. _printf-style: https://docs.python.org/library/stdtypes.html</span>
<span class="sd">        #printf-style-string-formatting</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">args</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">FilterArgumentError</span><span class="p">(</span>
            <span class="s2">&quot;can&#39;t handle positional and keyword arguments at the same time&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">soft_str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">kwargs</span> <span class="ow">or</span> <span class="n">args</span><span class="p">)</span></div>



<div class="viewcode-block" id="do_trim">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_trim">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_trim</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">chars</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Strip leading and trailing characters, by default whitespace.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">soft_str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span></div>



<div class="viewcode-block" id="do_striptags">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_striptags">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_striptags</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Union[str, HasHTML]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Strip SGML/XML tags and replace adjacent whitespace by one space.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;__html__&quot;</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;HasHTML&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">__html__</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">Markup</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="o">.</span><span class="n">striptags</span><span class="p">()</span></div>



<div class="viewcode-block" id="sync_do_slice">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_slice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_slice</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Collection[V]&quot;</span><span class="p">,</span> <span class="n">slices</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">fill_with</span><span class="p">:</span> <span class="s2">&quot;t.Optional[V]&quot;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Iterator[t.List[V]]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Slice an iterator and return a list of lists containing</span>
<span class="sd">    those items. Useful if you want to create a div containing</span>
<span class="sd">    three ul tags that represent columns:</span>

<span class="sd">    .. sourcecode:: html+jinja</span>

<span class="sd">        &lt;div class=&quot;columnwrapper&quot;&gt;</span>
<span class="sd">          {%- for column in items|slice(3) %}</span>
<span class="sd">            &lt;ul class=&quot;column-{{ loop.index }}&quot;&gt;</span>
<span class="sd">            {%- for item in column %}</span>
<span class="sd">              &lt;li&gt;{{ item }}&lt;/li&gt;</span>
<span class="sd">            {%- endfor %}</span>
<span class="sd">            &lt;/ul&gt;</span>
<span class="sd">          {%- endfor %}</span>
<span class="sd">        &lt;/div&gt;</span>

<span class="sd">    If you pass it a second argument it&#39;s used to fill missing</span>
<span class="sd">    values on the last iteration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seq</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="n">items_per_slice</span> <span class="o">=</span> <span class="n">length</span> <span class="o">//</span> <span class="n">slices</span>
    <span class="n">slices_with_extra</span> <span class="o">=</span> <span class="n">length</span> <span class="o">%</span> <span class="n">slices</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">slice_number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">slices</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">slice_number</span> <span class="o">*</span> <span class="n">items_per_slice</span>

        <span class="k">if</span> <span class="n">slice_number</span> <span class="o">&lt;</span> <span class="n">slices_with_extra</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">end</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">+</span> <span class="p">(</span><span class="n">slice_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">items_per_slice</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">fill_with</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">slice_number</span> <span class="o">&gt;=</span> <span class="n">slices_with_extra</span><span class="p">:</span>
            <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fill_with</span><span class="p">)</span>

        <span class="k">yield</span> <span class="n">tmp</span></div>



<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_slice</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<div class="viewcode-block" id="do_slice">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_slice">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_slice</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Union[t.AsyncIterable[V], t.Iterable[V]]&quot;</span><span class="p">,</span>
    <span class="n">slices</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fill_with</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Iterator[t.List[V]]&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">sync_do_slice</span><span class="p">(</span><span class="k">await</span> <span class="n">auto_to_list</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">slices</span><span class="p">,</span> <span class="n">fill_with</span><span class="p">)</span></div>



<div class="viewcode-block" id="do_batch">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_batch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_batch</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span> <span class="n">linecount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">fill_with</span><span class="p">:</span> <span class="s2">&quot;t.Optional[V]&quot;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Iterator[t.List[V]]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A filter that batches items. It works pretty much like `slice`</span>
<span class="sd">    just the other way round. It returns a list of lists with the</span>
<span class="sd">    given number of items. If you provide a second parameter this</span>
<span class="sd">    is used to fill up missing items. See this example:</span>

<span class="sd">    .. sourcecode:: html+jinja</span>

<span class="sd">        &lt;table&gt;</span>
<span class="sd">        {%- for row in items|batch(3, &#39;&amp;nbsp;&#39;) %}</span>
<span class="sd">          &lt;tr&gt;</span>
<span class="sd">          {%- for column in row %}</span>
<span class="sd">            &lt;td&gt;{{ column }}&lt;/td&gt;</span>
<span class="sd">          {%- endfor %}</span>
<span class="sd">          &lt;/tr&gt;</span>
<span class="sd">        {%- endfor %}</span>
<span class="sd">        &lt;/table&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tmp</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">V</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">==</span> <span class="n">linecount</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">tmp</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fill_with</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">linecount</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">+=</span> <span class="p">[</span><span class="n">fill_with</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">linecount</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">))</span>

        <span class="k">yield</span> <span class="n">tmp</span></div>



<div class="viewcode-block" id="do_round">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_round">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_round</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="s1">&#39;te.Literal[&quot;common&quot;, &quot;ceil&quot;, &quot;floor&quot;]&#39;</span> <span class="o">=</span> <span class="s2">&quot;common&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Round the number to a given precision. The first</span>
<span class="sd">    parameter specifies the precision (default is ``0``), the</span>
<span class="sd">    second the rounding method:</span>

<span class="sd">    - ``&#39;common&#39;`` rounds either up or down</span>
<span class="sd">    - ``&#39;ceil&#39;`` always rounds up</span>
<span class="sd">    - ``&#39;floor&#39;`` always rounds down</span>

<span class="sd">    If you don&#39;t specify a method ``&#39;common&#39;`` is used.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ 42.55|round }}</span>
<span class="sd">            -&gt; 43.0</span>
<span class="sd">        {{ 42.55|round(1, &#39;floor&#39;) }}</span>
<span class="sd">            -&gt; 42.5</span>

<span class="sd">    Note that even if rounded to 0 precision, a float is returned.  If</span>
<span class="sd">    you need a real integer, pipe it through `int`:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ 42.55|round|int }}</span>
<span class="sd">            -&gt; 43</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;common&quot;</span><span class="p">,</span> <span class="s2">&quot;ceil&quot;</span><span class="p">,</span> <span class="s2">&quot;floor&quot;</span><span class="p">}:</span>
        <span class="k">raise</span> <span class="n">FilterArgumentError</span><span class="p">(</span><span class="s2">&quot;method must be common, ceil or floor&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;common&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>

    <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">math</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">precision</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">precision</span><span class="p">))</span></div>



<span class="k">class</span><span class="w"> </span><span class="nc">_GroupTuple</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">grouper</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
    <span class="nb">list</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>

    <span class="c1"># Use the regular tuple repr to hide this subclass if users print</span>
    <span class="c1"># out the value during debugging.</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


<span class="nd">@pass_environment</span>
<div class="viewcode-block" id="sync_do_groupby">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_groupby">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_groupby</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.List[_GroupTuple]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Group a sequence of objects by an attribute using Python&#39;s</span>
<span class="sd">    :func:`itertools.groupby`. The attribute can use dot notation for</span>
<span class="sd">    nested access, like ``&quot;address.city&quot;``. Unlike Python&#39;s ``groupby``,</span>
<span class="sd">    the values are sorted first so only one group is returned for each</span>
<span class="sd">    unique value.</span>

<span class="sd">    For example, a list of ``User`` objects with a ``city`` attribute</span>
<span class="sd">    can be rendered in groups. In this example, ``grouper`` refers to</span>
<span class="sd">    the ``city`` value of the group.</span>

<span class="sd">    .. sourcecode:: html+jinja</span>

<span class="sd">        &lt;ul&gt;{% for city, items in users|groupby(&quot;city&quot;) %}</span>
<span class="sd">          &lt;li&gt;{{ city }}</span>
<span class="sd">            &lt;ul&gt;{% for user in items %}</span>
<span class="sd">              &lt;li&gt;{{ user.name }}</span>
<span class="sd">            {% endfor %}&lt;/ul&gt;</span>
<span class="sd">          &lt;/li&gt;</span>
<span class="sd">        {% endfor %}&lt;/ul&gt;</span>

<span class="sd">    ``groupby`` yields namedtuples of ``(grouper, list)``, which</span>
<span class="sd">    can be used instead of the tuple unpacking above. ``grouper`` is the</span>
<span class="sd">    value of the attribute, and ``list`` is the items with that value.</span>

<span class="sd">    .. sourcecode:: html+jinja</span>

<span class="sd">        &lt;ul&gt;{% for group in users|groupby(&quot;city&quot;) %}</span>
<span class="sd">          &lt;li&gt;{{ group.grouper }}: {{ group.list|join(&quot;, &quot;) }}</span>
<span class="sd">        {% endfor %}&lt;/ul&gt;</span>

<span class="sd">    You can specify a ``default`` value to use if an object in the list</span>
<span class="sd">    does not have the given attribute.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        &lt;ul&gt;{% for city, items in users|groupby(&quot;city&quot;, default=&quot;NY&quot;) %}</span>
<span class="sd">          &lt;li&gt;{{ city }}: {{ items|map(attribute=&quot;name&quot;)|join(&quot;, &quot;) }}&lt;/li&gt;</span>
<span class="sd">        {% endfor %}&lt;/ul&gt;</span>

<span class="sd">    Like the :func:`~jinja-filters.sort` filter, sorting and grouping is</span>
<span class="sd">    case-insensitive by default. The ``key`` for each group will have</span>
<span class="sd">    the case of the first item in that group of values. For example, if</span>
<span class="sd">    a list of users has cities ``[&quot;CA&quot;, &quot;NY&quot;, &quot;ca&quot;]``, the &quot;CA&quot; group</span>
<span class="sd">    will have two values. This can be disabled by passing</span>
<span class="sd">    ``case_sensitive=True``.</span>

<span class="sd">    .. versionchanged:: 3.1</span>
<span class="sd">        Added the ``case_sensitive`` parameter. Sorting and grouping is</span>
<span class="sd">        case-insensitive by default, matching other filters that do</span>
<span class="sd">        comparisons.</span>

<span class="sd">    .. versionchanged:: 3.0</span>
<span class="sd">        Added the ``default`` parameter.</span>

<span class="sd">    .. versionchanged:: 2.6</span>
<span class="sd">        The attribute supports dot notation for nested access.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="n">make_attrgetter</span><span class="p">(</span>
        <span class="n">environment</span><span class="p">,</span>
        <span class="n">attribute</span><span class="p">,</span>
        <span class="n">postprocess</span><span class="o">=</span><span class="n">ignore_case</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">case_sensitive</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">_GroupTuple</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">expr</span><span class="p">),</span> <span class="n">expr</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">case_sensitive</span><span class="p">:</span>
        <span class="c1"># Return the real key from the first value instead of the lowercase key.</span>
        <span class="n">output_expr</span> <span class="o">=</span> <span class="n">make_attrgetter</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">_GroupTuple</span><span class="p">(</span><span class="n">output_expr</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">out</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">out</span></div>



<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_groupby</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<div class="viewcode-block" id="do_groupby">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_groupby">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_groupby</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Union[t.AsyncIterable[V], t.Iterable[V]]&quot;</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.List[_GroupTuple]&quot;</span><span class="p">:</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="n">make_attrgetter</span><span class="p">(</span>
        <span class="n">environment</span><span class="p">,</span>
        <span class="n">attribute</span><span class="p">,</span>
        <span class="n">postprocess</span><span class="o">=</span><span class="n">ignore_case</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">case_sensitive</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">_GroupTuple</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="k">await</span> <span class="n">auto_to_list</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="k">await</span> <span class="n">auto_to_list</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">expr</span><span class="p">),</span> <span class="n">expr</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">case_sensitive</span><span class="p">:</span>
        <span class="c1"># Return the real key from the first value instead of the lowercase key.</span>
        <span class="n">output_expr</span> <span class="o">=</span> <span class="n">make_attrgetter</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">_GroupTuple</span><span class="p">(</span><span class="n">output_expr</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">out</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">out</span></div>



<span class="nd">@pass_environment</span>
<div class="viewcode-block" id="sync_do_sum">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_sum">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_sum</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">iterable</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">start</span><span class="p">:</span> <span class="n">V</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">V</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the sum of a sequence of numbers plus the value of parameter</span>
<span class="sd">    &#39;start&#39; (which defaults to 0).  When the sequence is empty it returns</span>
<span class="sd">    start.</span>

<span class="sd">    It is also possible to sum up only certain attributes:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        Total: {{ items|sum(attribute=&#39;price&#39;) }}</span>

<span class="sd">    .. versionchanged:: 2.6</span>
<span class="sd">       The ``attribute`` parameter was added to allow summing up over</span>
<span class="sd">       attributes.  Also the ``start`` parameter was moved on to the right.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">attribute</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">make_attrgetter</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="n">attribute</span><span class="p">),</span> <span class="n">iterable</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>  <span class="c1"># type: ignore[no-any-return, call-overload]</span></div>



<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_sum</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<div class="viewcode-block" id="do_sum">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_sum">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_sum</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span>
    <span class="n">iterable</span><span class="p">:</span> <span class="s2">&quot;t.Union[t.AsyncIterable[V], t.Iterable[V]]&quot;</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">start</span><span class="p">:</span> <span class="n">V</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">V</span><span class="p">:</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">start</span>

    <span class="k">if</span> <span class="n">attribute</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">make_attrgetter</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">V</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">V</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>

    <span class="k">async</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">auto_aiter</span><span class="p">(</span><span class="n">iterable</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">+=</span> <span class="n">func</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rv</span></div>



<div class="viewcode-block" id="sync_do_list">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_list">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_list</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.List[V]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the value into a list.  If it was a string the returned list</span>
<span class="sd">    will be a list of characters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>



<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_list</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<div class="viewcode-block" id="do_list">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_list">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_list</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Union[t.AsyncIterable[V], t.Iterable[V]]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.List[V]&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="k">await</span> <span class="n">auto_to_list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="do_mark_safe">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_mark_safe">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_mark_safe</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Markup</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mark the value as safe which means that in an environment with automatic</span>
<span class="sd">    escaping enabled this variable will not be escaped.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Markup</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="do_mark_unsafe">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_mark_unsafe">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_mark_unsafe</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mark a value as unsafe.  This is the reverse operation for :func:`safe`.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>



<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<div class="viewcode-block" id="do_reverse">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_reverse">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_reverse</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="o">...</span></div>



<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span><span class="w"> </span><span class="nf">do_reverse</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">:</span>
    <span class="o">...</span>


<span class="k">def</span><span class="w"> </span><span class="nf">do_reverse</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">V</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">V</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reverse the object or return an iterator that iterates over it the other</span>
<span class="sd">    way round.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">rv</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">rv</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FilterArgumentError</span><span class="p">(</span><span class="s2">&quot;argument must be iterable&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>


<span class="nd">@pass_environment</span>
<div class="viewcode-block" id="do_attr">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_attr">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_attr</span><span class="p">(</span>
    <span class="n">environment</span><span class="p">:</span> <span class="s2">&quot;Environment&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Undefined</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an attribute of an object. ``foo|attr(&quot;bar&quot;)`` works like</span>
<span class="sd">    ``foo.bar``, but returns undefined instead of falling back to ``foo[&quot;bar&quot;]``</span>
<span class="sd">    if the attribute doesn&#39;t exist.</span>

<span class="sd">    See :ref:`Notes on subscriptions &lt;notes-on-subscriptions&gt;` for more details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Environment.getattr will fall back to obj[name] if obj.name doesn&#39;t exist.</span>
    <span class="c1"># But we want to call env.getattr to get behavior such as sandboxing.</span>
    <span class="c1"># Determine if the attr exists first, so we know the fallback won&#39;t trigger.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># This avoids executing properties/descriptors, but misses __getattr__</span>
        <span class="c1"># and __getattribute__ dynamic attrs.</span>
        <span class="n">getattr_static</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="c1"># This finds dynamic attrs, and we know it&#39;s not a descriptor at this point.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">environment</span><span class="o">.</span><span class="n">undefined</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">environment</span><span class="o">.</span><span class="n">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>



<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<div class="viewcode-block" id="sync_do_map">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_map">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_map</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
    <span class="o">...</span></div>



<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_map</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
    <span class="o">...</span>


<span class="nd">@pass_context</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_map</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies a filter on a sequence of objects or looks up an attribute.</span>
<span class="sd">    This is useful when dealing with lists of objects but you are really</span>
<span class="sd">    only interested in a certain value of it.</span>

<span class="sd">    The basic usage is mapping on an attribute.  Imagine you have a list</span>
<span class="sd">    of users but you are only interested in a list of usernames:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        Users on this page: {{ users|map(attribute=&#39;username&#39;)|join(&#39;, &#39;) }}</span>

<span class="sd">    You can specify a ``default`` value to use if an object in the list</span>
<span class="sd">    does not have the given attribute.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ users|map(attribute=&quot;username&quot;, default=&quot;Anonymous&quot;)|join(&quot;, &quot;) }}</span>

<span class="sd">    Alternatively you can let it invoke a filter by passing the name of the</span>
<span class="sd">    filter and the arguments afterwards.  A good example would be applying a</span>
<span class="sd">    text conversion filter on a sequence:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        Users on this page: {{ titles|map(&#39;lower&#39;)|join(&#39;, &#39;) }}</span>

<span class="sd">    Similar to a generator comprehension such as:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        (u.username for u in users)</span>
<span class="sd">        (getattr(u, &quot;username&quot;, &quot;Anonymous&quot;) for u in users)</span>
<span class="sd">        (do_lower(x) for x in titles)</span>

<span class="sd">    .. versionchanged:: 2.11.0</span>
<span class="sd">        Added the ``default`` parameter.</span>

<span class="sd">    .. versionadded:: 2.7</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">prepare_map</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">func</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<div class="viewcode-block" id="do_map">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_map">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_map</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">AsyncIterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
    <span class="o">...</span></div>



<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span><span class="w"> </span><span class="nf">do_map</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">AsyncIterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
    <span class="o">...</span>


<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_map</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_map</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">AsyncIterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">AsyncIterable</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">prepare_map</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">auto_aiter</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">yield</span> <span class="k">await</span> <span class="n">auto_await</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>


<span class="nd">@pass_context</span>
<div class="viewcode-block" id="sync_do_select">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_select">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_select</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Iterator[V]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filters a sequence of objects by applying a test to each object,</span>
<span class="sd">    and only selecting the objects with the test succeeding.</span>

<span class="sd">    If no test is specified, each object will be evaluated as a boolean.</span>

<span class="sd">    Example usage:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ numbers|select(&quot;odd&quot;) }}</span>
<span class="sd">        {{ numbers|select(&quot;odd&quot;) }}</span>
<span class="sd">        {{ numbers|select(&quot;divisibleby&quot;, 3) }}</span>
<span class="sd">        {{ numbers|select(&quot;lessthan&quot;, 42) }}</span>
<span class="sd">        {{ strings|select(&quot;equalto&quot;, &quot;mystring&quot;) }}</span>

<span class="sd">    Similar to a generator comprehension such as:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        (n for n in numbers if test_odd(n))</span>
<span class="sd">        (n for n in numbers if test_divisibleby(n, 3))</span>

<span class="sd">    .. versionadded:: 2.7</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">select_or_reject</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>



<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_select</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<div class="viewcode-block" id="do_select">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_select">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_select</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Union[t.AsyncIterable[V], t.Iterable[V]]&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.AsyncIterator[V]&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">async_select_or_reject</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>



<span class="nd">@pass_context</span>
<div class="viewcode-block" id="sync_do_reject">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_reject">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_reject</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Iterator[V]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filters a sequence of objects by applying a test to each object,</span>
<span class="sd">    and rejecting the objects with the test succeeding.</span>

<span class="sd">    If no test is specified, each object will be evaluated as a boolean.</span>

<span class="sd">    Example usage:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ numbers|reject(&quot;odd&quot;) }}</span>

<span class="sd">    Similar to a generator comprehension such as:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        (n for n in numbers if not test_odd(n))</span>

<span class="sd">    .. versionadded:: 2.7</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">select_or_reject</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>



<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_reject</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<div class="viewcode-block" id="do_reject">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_reject">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_reject</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Union[t.AsyncIterable[V], t.Iterable[V]]&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.AsyncIterator[V]&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">async_select_or_reject</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>



<span class="nd">@pass_context</span>
<div class="viewcode-block" id="sync_do_selectattr">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_selectattr">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_selectattr</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Iterator[V]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filters a sequence of objects by applying a test to the specified</span>
<span class="sd">    attribute of each object, and only selecting the objects with the</span>
<span class="sd">    test succeeding.</span>

<span class="sd">    If no test is specified, the attribute&#39;s value will be evaluated as</span>
<span class="sd">    a boolean.</span>

<span class="sd">    Example usage:</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ users|selectattr(&quot;is_active&quot;) }}</span>
<span class="sd">        {{ users|selectattr(&quot;email&quot;, &quot;none&quot;) }}</span>

<span class="sd">    Similar to a generator comprehension such as:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        (user for user in users if user.is_active)</span>
<span class="sd">        (user for user in users if test_none(user.email))</span>

<span class="sd">    .. versionadded:: 2.7</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">select_or_reject</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>



<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_selectattr</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<div class="viewcode-block" id="do_selectattr">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_selectattr">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_selectattr</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Union[t.AsyncIterable[V], t.Iterable[V]]&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.AsyncIterator[V]&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">async_select_or_reject</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>



<span class="nd">@pass_context</span>
<div class="viewcode-block" id="sync_do_rejectattr">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.sync_do_rejectattr">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_do_rejectattr</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Iterator[V]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filters a sequence of objects by applying a test to the specified</span>
<span class="sd">    attribute of each object, and rejecting the objects with the test</span>
<span class="sd">    succeeding.</span>

<span class="sd">    If no test is specified, the attribute&#39;s value will be evaluated as</span>
<span class="sd">    a boolean.</span>

<span class="sd">    .. sourcecode:: jinja</span>

<span class="sd">        {{ users|rejectattr(&quot;is_active&quot;) }}</span>
<span class="sd">        {{ users|rejectattr(&quot;email&quot;, &quot;none&quot;) }}</span>

<span class="sd">    Similar to a generator comprehension such as:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        (user for user in users if not user.is_active)</span>
<span class="sd">        (user for user in users if not test_none(user.email))</span>

<span class="sd">    .. versionadded:: 2.7</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">select_or_reject</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>



<span class="nd">@async_variant</span><span class="p">(</span><span class="n">sync_do_rejectattr</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<div class="viewcode-block" id="do_rejectattr">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_rejectattr">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_rejectattr</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Union[t.AsyncIterable[V], t.Iterable[V]]&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.AsyncIterator[V]&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">async_select_or_reject</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>



<span class="nd">@pass_eval_context</span>
<div class="viewcode-block" id="do_tojson">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.do_tojson">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">do_tojson</span><span class="p">(</span>
    <span class="n">eval_ctx</span><span class="p">:</span> <span class="s2">&quot;EvalContext&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Markup</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialize an object to a string of JSON, and mark it safe to</span>
<span class="sd">    render in HTML. This filter is only for use in HTML documents.</span>

<span class="sd">    The returned string is safe to render in HTML documents and</span>
<span class="sd">    ``&lt;script&gt;`` tags. The exception is in HTML attributes that are</span>
<span class="sd">    double quoted; either use single quotes or the ``|forceescape``</span>
<span class="sd">    filter.</span>

<span class="sd">    :param value: The object to serialize to JSON.</span>
<span class="sd">    :param indent: The ``indent`` parameter passed to ``dumps``, for</span>
<span class="sd">        pretty-printing the value.</span>

<span class="sd">    .. versionadded:: 2.9</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">policies</span> <span class="o">=</span> <span class="n">eval_ctx</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">policies</span>
    <span class="n">dumps</span> <span class="o">=</span> <span class="n">policies</span><span class="p">[</span><span class="s2">&quot;json.dumps_function&quot;</span><span class="p">]</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="n">policies</span><span class="p">[</span><span class="s2">&quot;json.dumps_kwargs&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">indent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;indent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indent</span>

    <span class="k">return</span> <span class="n">htmlsafe_json_dumps</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dumps</span><span class="o">=</span><span class="n">dumps</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>



<div class="viewcode-block" id="prepare_map">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.prepare_map">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">prepare_map</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span> <span class="ow">and</span> <span class="s2">&quot;attribute&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">attribute</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;attribute&quot;</span><span class="p">)</span>
        <span class="n">default</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FilterArgumentError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected keyword argument </span><span class="si">{</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">func</span> <span class="o">=</span> <span class="n">make_attrgetter</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">environment</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">except</span> <span class="ne">LookupError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FilterArgumentError</span><span class="p">(</span><span class="s2">&quot;map requires a filter argument&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">call_filter</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">func</span></div>



<div class="viewcode-block" id="prepare_select_or_reject">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.prepare_select_or_reject">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">prepare_select_or_reject</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">modfunc</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">lookup_attr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">lookup_attr</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">LookupError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FilterArgumentError</span><span class="p">(</span><span class="s2">&quot;Missing parameter for attribute name&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>

        <span class="n">transfunc</span> <span class="o">=</span> <span class="n">make_attrgetter</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">environment</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="n">off</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">off</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">transfunc</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">V</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">V</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">off</span><span class="p">]</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span> <span class="o">+</span> <span class="n">off</span> <span class="p">:]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">call_test</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">LookupError</span><span class="p">:</span>
        <span class="n">func</span> <span class="o">=</span> <span class="nb">bool</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">modfunc</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">transfunc</span><span class="p">(</span><span class="n">item</span><span class="p">)))</span></div>



<div class="viewcode-block" id="select_or_reject">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.select_or_reject">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">select_or_reject</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Iterable[V]&quot;</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">modfunc</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">lookup_attr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.Iterator[V]&quot;</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">prepare_select_or_reject</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">modfunc</span><span class="p">,</span> <span class="n">lookup_attr</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">func</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">item</span></div>



<div class="viewcode-block" id="async_select_or_reject">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.async_select_or_reject">[docs]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">async_select_or_reject</span><span class="p">(</span>
    <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;t.Union[t.AsyncIterable[V], t.Iterable[V]]&quot;</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">modfunc</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">lookup_attr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;t.AsyncIterator[V]&quot;</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">prepare_select_or_reject</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">modfunc</span><span class="p">,</span> <span class="n">lookup_attr</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">auto_aiter</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">func</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">item</span></div>



<div class="viewcode-block" id="FILTERS">
<a class="viewcode-back" href="../../autoapi/jinja2/filters/index.html#jinja2.filters.FILTERS">[docs]</a>
<span class="n">FILTERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;abs&quot;</span><span class="p">:</span> <span class="nb">abs</span><span class="p">,</span>
    <span class="s2">&quot;attr&quot;</span><span class="p">:</span> <span class="n">do_attr</span><span class="p">,</span>
    <span class="s2">&quot;batch&quot;</span><span class="p">:</span> <span class="n">do_batch</span><span class="p">,</span>
    <span class="s2">&quot;capitalize&quot;</span><span class="p">:</span> <span class="n">do_capitalize</span><span class="p">,</span>
    <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="n">do_center</span><span class="p">,</span>
    <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">,</span>
    <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="n">do_default</span><span class="p">,</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">do_default</span><span class="p">,</span>
    <span class="s2">&quot;dictsort&quot;</span><span class="p">:</span> <span class="n">do_dictsort</span><span class="p">,</span>
    <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="n">escape</span><span class="p">,</span>
    <span class="s2">&quot;escape&quot;</span><span class="p">:</span> <span class="n">escape</span><span class="p">,</span>
    <span class="s2">&quot;filesizeformat&quot;</span><span class="p">:</span> <span class="n">do_filesizeformat</span><span class="p">,</span>
    <span class="s2">&quot;first&quot;</span><span class="p">:</span> <span class="n">do_first</span><span class="p">,</span>
    <span class="s2">&quot;float&quot;</span><span class="p">:</span> <span class="n">do_float</span><span class="p">,</span>
    <span class="s2">&quot;forceescape&quot;</span><span class="p">:</span> <span class="n">do_forceescape</span><span class="p">,</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="n">do_format</span><span class="p">,</span>
    <span class="s2">&quot;groupby&quot;</span><span class="p">:</span> <span class="n">do_groupby</span><span class="p">,</span>
    <span class="s2">&quot;indent&quot;</span><span class="p">:</span> <span class="n">do_indent</span><span class="p">,</span>
    <span class="s2">&quot;int&quot;</span><span class="p">:</span> <span class="n">do_int</span><span class="p">,</span>
    <span class="s2">&quot;join&quot;</span><span class="p">:</span> <span class="n">do_join</span><span class="p">,</span>
    <span class="s2">&quot;last&quot;</span><span class="p">:</span> <span class="n">do_last</span><span class="p">,</span>
    <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">,</span>
    <span class="s2">&quot;list&quot;</span><span class="p">:</span> <span class="n">do_list</span><span class="p">,</span>
    <span class="s2">&quot;lower&quot;</span><span class="p">:</span> <span class="n">do_lower</span><span class="p">,</span>
    <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="n">do_items</span><span class="p">,</span>
    <span class="s2">&quot;map&quot;</span><span class="p">:</span> <span class="n">do_map</span><span class="p">,</span>
    <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="n">do_min</span><span class="p">,</span>
    <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="n">do_max</span><span class="p">,</span>
    <span class="s2">&quot;pprint&quot;</span><span class="p">:</span> <span class="n">do_pprint</span><span class="p">,</span>
    <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">do_random</span><span class="p">,</span>
    <span class="s2">&quot;reject&quot;</span><span class="p">:</span> <span class="n">do_reject</span><span class="p">,</span>
    <span class="s2">&quot;rejectattr&quot;</span><span class="p">:</span> <span class="n">do_rejectattr</span><span class="p">,</span>
    <span class="s2">&quot;replace&quot;</span><span class="p">:</span> <span class="n">do_replace</span><span class="p">,</span>
    <span class="s2">&quot;reverse&quot;</span><span class="p">:</span> <span class="n">do_reverse</span><span class="p">,</span>
    <span class="s2">&quot;round&quot;</span><span class="p">:</span> <span class="n">do_round</span><span class="p">,</span>
    <span class="s2">&quot;safe&quot;</span><span class="p">:</span> <span class="n">do_mark_safe</span><span class="p">,</span>
    <span class="s2">&quot;select&quot;</span><span class="p">:</span> <span class="n">do_select</span><span class="p">,</span>
    <span class="s2">&quot;selectattr&quot;</span><span class="p">:</span> <span class="n">do_selectattr</span><span class="p">,</span>
    <span class="s2">&quot;slice&quot;</span><span class="p">:</span> <span class="n">do_slice</span><span class="p">,</span>
    <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="n">do_sort</span><span class="p">,</span>
    <span class="s2">&quot;string&quot;</span><span class="p">:</span> <span class="n">soft_str</span><span class="p">,</span>
    <span class="s2">&quot;striptags&quot;</span><span class="p">:</span> <span class="n">do_striptags</span><span class="p">,</span>
    <span class="s2">&quot;sum&quot;</span><span class="p">:</span> <span class="n">do_sum</span><span class="p">,</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">do_title</span><span class="p">,</span>
    <span class="s2">&quot;trim&quot;</span><span class="p">:</span> <span class="n">do_trim</span><span class="p">,</span>
    <span class="s2">&quot;truncate&quot;</span><span class="p">:</span> <span class="n">do_truncate</span><span class="p">,</span>
    <span class="s2">&quot;unique&quot;</span><span class="p">:</span> <span class="n">do_unique</span><span class="p">,</span>
    <span class="s2">&quot;upper&quot;</span><span class="p">:</span> <span class="n">do_upper</span><span class="p">,</span>
    <span class="s2">&quot;urlencode&quot;</span><span class="p">:</span> <span class="n">do_urlencode</span><span class="p">,</span>
    <span class="s2">&quot;urlize&quot;</span><span class="p">:</span> <span class="n">do_urlize</span><span class="p">,</span>
    <span class="s2">&quot;wordcount&quot;</span><span class="p">:</span> <span class="n">do_wordcount</span><span class="p">,</span>
    <span class="s2">&quot;wordwrap&quot;</span><span class="p">:</span> <span class="n">do_wordwrap</span><span class="p">,</span>
    <span class="s2">&quot;xmlattr&quot;</span><span class="p">:</span> <span class="n">do_xmlattr</span><span class="p">,</span>
    <span class="s2">&quot;tojson&quot;</span><span class="p">:</span> <span class="n">do_tojson</span><span class="p">,</span>
<span class="p">}</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>