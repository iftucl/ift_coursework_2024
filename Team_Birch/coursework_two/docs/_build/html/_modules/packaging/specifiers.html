

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>packaging.specifiers &mdash; Coursework Two 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Coursework Two
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation_guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage_instructions.html">Usage Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture_overview.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Coursework Two</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">packaging.specifiers</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for packaging.specifiers</h1><div class="highlight"><pre>
<span></span><span class="c1"># This file is dual licensed under the terms of the Apache License, Version</span>
<span class="c1"># 2.0, and the BSD License. See the LICENSE file in the root of this repository</span>
<span class="c1"># for complete details.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. testsetup::</span>

<span class="sd">    from packaging.specifiers import Specifier, SpecifierSet, InvalidSpecifier</span>
<span class="sd">    from packaging.version import Version</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">abc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">canonicalize_version</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.version</span><span class="w"> </span><span class="kn">import</span> <span class="n">Version</span>

<div class="viewcode-block" id="UnparsedVersion">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.UnparsedVersion">[docs]</a>
<span class="n">UnparsedVersion</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">Version</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span></div>

<div class="viewcode-block" id="UnparsedVersionVar">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.UnparsedVersionVar">[docs]</a>
<span class="n">UnparsedVersionVar</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;UnparsedVersionVar&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">UnparsedVersion</span><span class="p">)</span></div>

<div class="viewcode-block" id="CallableOperator">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.CallableOperator">[docs]</a>
<span class="n">CallableOperator</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Version</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">_coerce_version</span><span class="p">(</span><span class="n">version</span><span class="p">:</span> <span class="n">UnparsedVersion</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Version</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="n">Version</span><span class="p">):</span>
        <span class="n">version</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">version</span>


<div class="viewcode-block" id="InvalidSpecifier">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.InvalidSpecifier">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">InvalidSpecifier</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Raised when attempting to create a :class:`Specifier` with a specifier</span>
<span class="sd">    string that is invalid.</span>

<span class="sd">    &gt;&gt;&gt; Specifier(&quot;lolwat&quot;)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">    packaging.specifiers.InvalidSpecifier: Invalid specifier: &#39;lolwat&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span></div>



<div class="viewcode-block" id="BaseSpecifier">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.BaseSpecifier">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">BaseSpecifier</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span><span class="p">):</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the str representation of this Specifier-like object. This</span>
<span class="sd">        should be representative of the Specifier itself.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a hash value for this Specifier-like object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a boolean representing whether or not the two Specifier-like</span>
<span class="sd">        objects are equal.</span>

<span class="sd">        :param other: The other object to check against.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="BaseSpecifier.prereleases">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.BaseSpecifier.prereleases">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">prereleases</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether or not pre-releases as a whole are allowed.</span>

<span class="sd">        This can be set to either ``True`` or ``False`` to explicitly enable or disable</span>
<span class="sd">        prereleases or it can be set to ``None`` (the default) to use default semantics.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>


    <span class="nd">@prereleases</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prereleases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setter for :attr:`prereleases`.</span>

<span class="sd">        :param value: The value to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="BaseSpecifier.contains">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.BaseSpecifier.contains">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prereleases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines if the given item is contained within this specifier.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>


    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="BaseSpecifier.filter">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.BaseSpecifier.filter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">iterable</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">UnparsedVersionVar</span><span class="p">],</span> <span class="n">prereleases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">UnparsedVersionVar</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes an iterable of items and filters them so that only items which</span>
<span class="sd">        are contained within this specifier are allowed in it.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>
</div>



<div class="viewcode-block" id="Specifier">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.Specifier">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Specifier</span><span class="p">(</span><span class="n">BaseSpecifier</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This class abstracts handling of version specifiers.</span>

<span class="sd">    .. tip::</span>

<span class="sd">        It is generally not required to instantiate this manually. You should instead</span>
<span class="sd">        prefer to work with :class:`SpecifierSet` instead, which can parse</span>
<span class="sd">        comma-separated version specifiers (which is what package metadata contains).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_operator_regex_str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        (?P&lt;operator&gt;(~=|==|!=|&lt;=|&gt;=|&lt;|&gt;|===))</span>
<span class="s2">        &quot;&quot;&quot;</span>
    <span class="n">_version_regex_str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        (?P&lt;version&gt;</span>
<span class="s2">            (?:</span>
<span class="s2">                # The identity operators allow for an escape hatch that will</span>
<span class="s2">                # do an exact string match of the version you wish to install.</span>
<span class="s2">                # This will not be parsed by PEP 440 and we cannot determine</span>
<span class="s2">                # any semantic meaning from it. This operator is discouraged</span>
<span class="s2">                # but included entirely as an escape hatch.</span>
<span class="s2">                (?&lt;====)  # Only match for the identity operator</span>
<span class="s2">                \s*</span>
<span class="s2">                [^\s;)]*  # The arbitrary version can be just about anything,</span>
<span class="s2">                          # we match everything except for whitespace, a</span>
<span class="s2">                          # semi-colon for marker support, and a closing paren</span>
<span class="s2">                          # since versions can be enclosed in them.</span>
<span class="s2">            )</span>
<span class="s2">            |</span>
<span class="s2">            (?:</span>
<span class="s2">                # The (non)equality operators allow for wild card and local</span>
<span class="s2">                # versions to be specified so we have to define these two</span>
<span class="s2">                # operators separately to enable that.</span>
<span class="s2">                (?&lt;===|!=)            # Only match for equals and not equals</span>

<span class="s2">                \s*</span>
<span class="s2">                v?</span>
<span class="s2">                (?:[0-9]+!)?          # epoch</span>
<span class="s2">                [0-9]+(?:\.[0-9]+)*   # release</span>

<span class="s2">                # You cannot use a wild card and a pre-release, post-release, a dev or</span>
<span class="s2">                # local version together so group them with a | and make them optional.</span>
<span class="s2">                (?:</span>
<span class="s2">                    \.\*  # Wild card syntax of .*</span>
<span class="s2">                    |</span>
<span class="s2">                    (?:                                  # pre release</span>
<span class="s2">                        [-_\.]?</span>
<span class="s2">                        (alpha|beta|preview|pre|a|b|c|rc)</span>
<span class="s2">                        [-_\.]?</span>
<span class="s2">                        [0-9]*</span>
<span class="s2">                    )?</span>
<span class="s2">                    (?:                                  # post release</span>
<span class="s2">                        (?:-[0-9]+)|(?:[-_\.]?(post|rev|r)[-_\.]?[0-9]*)</span>
<span class="s2">                    )?</span>
<span class="s2">                    (?:[-_\.]?dev[-_\.]?[0-9]*)?         # dev release</span>
<span class="s2">                    (?:\+[a-z0-9]+(?:[-_\.][a-z0-9]+)*)? # local</span>
<span class="s2">                )?</span>
<span class="s2">            )</span>
<span class="s2">            |</span>
<span class="s2">            (?:</span>
<span class="s2">                # The compatible operator requires at least two digits in the</span>
<span class="s2">                # release segment.</span>
<span class="s2">                (?&lt;=~=)               # Only match for the compatible operator</span>

<span class="s2">                \s*</span>
<span class="s2">                v?</span>
<span class="s2">                (?:[0-9]+!)?          # epoch</span>
<span class="s2">                [0-9]+(?:\.[0-9]+)+   # release  (We have a + instead of a *)</span>
<span class="s2">                (?:                   # pre release</span>
<span class="s2">                    [-_\.]?</span>
<span class="s2">                    (alpha|beta|preview|pre|a|b|c|rc)</span>
<span class="s2">                    [-_\.]?</span>
<span class="s2">                    [0-9]*</span>
<span class="s2">                )?</span>
<span class="s2">                (?:                                   # post release</span>
<span class="s2">                    (?:-[0-9]+)|(?:[-_\.]?(post|rev|r)[-_\.]?[0-9]*)</span>
<span class="s2">                )?</span>
<span class="s2">                (?:[-_\.]?dev[-_\.]?[0-9]*)?          # dev release</span>
<span class="s2">            )</span>
<span class="s2">            |</span>
<span class="s2">            (?:</span>
<span class="s2">                # All other operators only allow a sub set of what the</span>
<span class="s2">                # (non)equality operators do. Specifically they do not allow</span>
<span class="s2">                # local versions to be specified nor do they allow the prefix</span>
<span class="s2">                # matching wild cards.</span>
<span class="s2">                (?&lt;!==|!=|~=)         # We have special cases for these</span>
<span class="s2">                                      # operators so we want to make sure they</span>
<span class="s2">                                      # don&#39;t match here.</span>

<span class="s2">                \s*</span>
<span class="s2">                v?</span>
<span class="s2">                (?:[0-9]+!)?          # epoch</span>
<span class="s2">                [0-9]+(?:\.[0-9]+)*   # release</span>
<span class="s2">                (?:                   # pre release</span>
<span class="s2">                    [-_\.]?</span>
<span class="s2">                    (alpha|beta|preview|pre|a|b|c|rc)</span>
<span class="s2">                    [-_\.]?</span>
<span class="s2">                    [0-9]*</span>
<span class="s2">                )?</span>
<span class="s2">                (?:                                   # post release</span>
<span class="s2">                    (?:-[0-9]+)|(?:[-_\.]?(post|rev|r)[-_\.]?[0-9]*)</span>
<span class="s2">                )?</span>
<span class="s2">                (?:[-_\.]?dev[-_\.]?[0-9]*)?          # dev release</span>
<span class="s2">            )</span>
<span class="s2">        )</span>
<span class="s2">        &quot;&quot;&quot;</span>

    <span class="n">_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;^\s*&quot;</span> <span class="o">+</span> <span class="n">_operator_regex_str</span> <span class="o">+</span> <span class="n">_version_regex_str</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\s*$&quot;</span><span class="p">,</span>
        <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">_operators</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;~=&quot;</span><span class="p">:</span> <span class="s2">&quot;compatible&quot;</span><span class="p">,</span>
        <span class="s2">&quot;==&quot;</span><span class="p">:</span> <span class="s2">&quot;equal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;!=&quot;</span><span class="p">:</span> <span class="s2">&quot;not_equal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span> <span class="s2">&quot;less_than_equal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span> <span class="s2">&quot;greater_than_equal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;&lt;&quot;</span><span class="p">:</span> <span class="s2">&quot;less_than&quot;</span><span class="p">,</span>
        <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="s2">&quot;greater_than&quot;</span><span class="p">,</span>
        <span class="s2">&quot;===&quot;</span><span class="p">:</span> <span class="s2">&quot;arbitrary&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">prereleases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a Specifier instance.</span>

<span class="sd">        :param spec:</span>
<span class="sd">            The string representation of a specifier which will be parsed and</span>
<span class="sd">            normalized before use.</span>
<span class="sd">        :param prereleases:</span>
<span class="sd">            This tells the specifier if it should accept prerelease versions if</span>
<span class="sd">            applicable or not. The default of ``None`` will autodetect it from the</span>
<span class="sd">            given specifiers.</span>
<span class="sd">        :raises InvalidSpecifier:</span>
<span class="sd">            If the given specifier is invalid (i.e. bad syntax).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSpecifier</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid specifier: </span><span class="si">{</span><span class="n">spec</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_spec</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;operator&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
            <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
        <span class="p">)</span>

        <span class="c1"># Store whether or not this Specifier should accept prereleases</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span> <span class="o">=</span> <span class="n">prereleases</span>

    <span class="c1"># https://github.com/python/mypy/pull/13475#pullrequestreview-1079784515</span>
    <span class="nd">@property</span>  <span class="c1"># type: ignore[override]</span>
<div class="viewcode-block" id="Specifier.prereleases">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.Specifier.prereleases">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">prereleases</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># If there is an explicit prereleases set for this, then we&#39;ll just</span>
        <span class="c1"># blindly use that.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span>

        <span class="c1"># Look at all of our specifiers and determine if they are inclusive</span>
        <span class="c1"># operators, and if they are if they are including an explicit</span>
        <span class="c1"># prerelease.</span>
        <span class="n">operator</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spec</span>
        <span class="k">if</span> <span class="n">operator</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;==&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="s2">&quot;~=&quot;</span><span class="p">,</span> <span class="s2">&quot;===&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">]:</span>
            <span class="c1"># The == specifier can include a trailing .*, if it does we</span>
            <span class="c1"># want to remove before parsing.</span>
            <span class="k">if</span> <span class="n">operator</span> <span class="o">==</span> <span class="s2">&quot;==&quot;</span> <span class="ow">and</span> <span class="n">version</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.*&quot;</span><span class="p">):</span>
                <span class="n">version</span> <span class="o">=</span> <span class="n">version</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

            <span class="c1"># Parse the version, and if it is a pre-release than this</span>
            <span class="c1"># specifier allows pre-releases.</span>
            <span class="k">if</span> <span class="n">Version</span><span class="p">(</span><span class="n">version</span><span class="p">)</span><span class="o">.</span><span class="n">is_prerelease</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span></div>


    <span class="nd">@prereleases</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prereleases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Specifier.operator">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.Specifier.operator">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">operator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The operator of this specifier.</span>

<span class="sd">        &gt;&gt;&gt; Specifier(&quot;==1.2.3&quot;).operator</span>
<span class="sd">        &#39;==&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


    <span class="nd">@property</span>
<div class="viewcode-block" id="Specifier.version">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.Specifier.version">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The version of this specifier.</span>

<span class="sd">        &gt;&gt;&gt; Specifier(&quot;==1.2.3&quot;).version</span>
<span class="sd">        &#39;1.2.3&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A representation of the Specifier that shows all internal state.</span>

<span class="sd">        &gt;&gt;&gt; Specifier(&#39;&gt;=1.0.0&#39;)</span>
<span class="sd">        &lt;Specifier(&#39;&gt;=1.0.0&#39;)&gt;</span>
<span class="sd">        &gt;&gt;&gt; Specifier(&#39;&gt;=1.0.0&#39;, prereleases=False)</span>
<span class="sd">        &lt;Specifier(&#39;&gt;=1.0.0&#39;, prereleases=False)&gt;</span>
<span class="sd">        &gt;&gt;&gt; Specifier(&#39;&gt;=1.0.0&#39;, prereleases=True)</span>
<span class="sd">        &lt;Specifier(&#39;&gt;=1.0.0&#39;, prereleases=True)&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pre</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;, prereleases=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">prereleases</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">!r}{</span><span class="n">pre</span><span class="si">}</span><span class="s2">)&gt;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A string representation of the Specifier that can be round-tripped.</span>

<span class="sd">        &gt;&gt;&gt; str(Specifier(&#39;&gt;=1.0.0&#39;))</span>
<span class="sd">        &#39;&gt;=1.0.0&#39;</span>
<span class="sd">        &gt;&gt;&gt; str(Specifier(&#39;&gt;=1.0.0&#39;, prereleases=False))</span>
<span class="sd">        &#39;&gt;=1.0.0&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_spec</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_canonical_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="n">canonical_version</span> <span class="o">=</span> <span class="n">canonicalize_version</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_spec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">strip_trailing_zero</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_spec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;~=&quot;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">canonical_version</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_canonical_spec</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether or not the two Specifier-like objects are equal.</span>

<span class="sd">        :param other: The other object to check against.</span>

<span class="sd">        The value of :attr:`prereleases` is ignored.</span>

<span class="sd">        &gt;&gt;&gt; Specifier(&quot;==1.2.3&quot;) == Specifier(&quot;== 1.2.3.0&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; (Specifier(&quot;==1.2.3&quot;, prereleases=False) ==</span>
<span class="sd">        ...  Specifier(&quot;==1.2.3&quot;, prereleases=True))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Specifier(&quot;==1.2.3&quot;) == &quot;==1.2.3&quot;</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Specifier(&quot;==1.2.3&quot;) == Specifier(&quot;==1.2.4&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; Specifier(&quot;==1.2.3&quot;) == Specifier(&quot;~=1.2.3&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
            <span class="k">except</span> <span class="n">InvalidSpecifier</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_canonical_spec</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_canonical_spec</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallableOperator</span><span class="p">:</span>
        <span class="n">operator_callable</span><span class="p">:</span> <span class="n">CallableOperator</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_compare_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="p">[</span><span class="n">op</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">operator_callable</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compare_compatible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prospective</span><span class="p">:</span> <span class="n">Version</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># Compatible releases have an equivalent combination of &gt;= and ==. That</span>
        <span class="c1"># is that ~=2.2 is equivalent to &gt;=2.2,==2.*. This allows us to</span>
        <span class="c1"># implement this in terms of the other specifiers instead of</span>
        <span class="c1"># implementing it ourselves. The only thing we need to do is construct</span>
        <span class="c1"># the other specifiers.</span>

        <span class="c1"># We want everything but the last item in the version, but we want to</span>
        <span class="c1"># ignore suffix segments.</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">_version_join</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">takewhile</span><span class="p">(</span><span class="n">_is_not_suffix</span><span class="p">,</span> <span class="n">_version_split</span><span class="p">(</span><span class="n">spec</span><span class="p">)))[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># Add the prefix notation to the end of our string</span>
        <span class="n">prefix</span> <span class="o">+=</span> <span class="s2">&quot;.*&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_operator</span><span class="p">(</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">)(</span><span class="n">prospective</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_operator</span><span class="p">(</span><span class="s2">&quot;==&quot;</span><span class="p">)(</span>
            <span class="n">prospective</span><span class="p">,</span> <span class="n">prefix</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compare_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prospective</span><span class="p">:</span> <span class="n">Version</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># We need special logic to handle prefix matching</span>
        <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.*&quot;</span><span class="p">):</span>
            <span class="c1"># In the case of prefix matching we want to ignore local segment.</span>
            <span class="n">normalized_prospective</span> <span class="o">=</span> <span class="n">canonicalize_version</span><span class="p">(</span>
                <span class="n">prospective</span><span class="o">.</span><span class="n">public</span><span class="p">,</span> <span class="n">strip_trailing_zero</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
            <span class="c1"># Get the normalized version string ignoring the trailing .*</span>
            <span class="n">normalized_spec</span> <span class="o">=</span> <span class="n">canonicalize_version</span><span class="p">(</span><span class="n">spec</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">strip_trailing_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="c1"># Split the spec out by bangs and dots, and pretend that there is</span>
            <span class="c1"># an implicit dot in between a release segment and a pre-release segment.</span>
            <span class="n">split_spec</span> <span class="o">=</span> <span class="n">_version_split</span><span class="p">(</span><span class="n">normalized_spec</span><span class="p">)</span>

            <span class="c1"># Split the prospective version out by bangs and dots, and pretend</span>
            <span class="c1"># that there is an implicit dot in between a release segment and</span>
            <span class="c1"># a pre-release segment.</span>
            <span class="n">split_prospective</span> <span class="o">=</span> <span class="n">_version_split</span><span class="p">(</span><span class="n">normalized_prospective</span><span class="p">)</span>

            <span class="c1"># 0-pad the prospective version before shortening it to get the correct</span>
            <span class="c1"># shortened version.</span>
            <span class="n">padded_prospective</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_pad_version</span><span class="p">(</span><span class="n">split_prospective</span><span class="p">,</span> <span class="n">split_spec</span><span class="p">)</span>

            <span class="c1"># Shorten the prospective version to be the same length as the spec</span>
            <span class="c1"># so that we can determine if the specifier is a prefix of the</span>
            <span class="c1"># prospective version or not.</span>
            <span class="n">shortened_prospective</span> <span class="o">=</span> <span class="n">padded_prospective</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_spec</span><span class="p">)]</span>

            <span class="k">return</span> <span class="n">shortened_prospective</span> <span class="o">==</span> <span class="n">split_spec</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Convert our spec string into a Version</span>
            <span class="n">spec_version</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>

            <span class="c1"># If the specifier does not have a local segment, then we want to</span>
            <span class="c1"># act as if the prospective version also does not have a local</span>
            <span class="c1"># segment.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">spec_version</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
                <span class="n">prospective</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="n">prospective</span><span class="o">.</span><span class="n">public</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">prospective</span> <span class="o">==</span> <span class="n">spec_version</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compare_not_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prospective</span><span class="p">:</span> <span class="n">Version</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_equal</span><span class="p">(</span><span class="n">prospective</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compare_less_than_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prospective</span><span class="p">:</span> <span class="n">Version</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># NB: Local version identifiers are NOT permitted in the version</span>
        <span class="c1"># specifier, so local version labels can be universally removed from</span>
        <span class="c1"># the prospective version.</span>
        <span class="k">return</span> <span class="n">Version</span><span class="p">(</span><span class="n">prospective</span><span class="o">.</span><span class="n">public</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">Version</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compare_greater_than_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prospective</span><span class="p">:</span> <span class="n">Version</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># NB: Local version identifiers are NOT permitted in the version</span>
        <span class="c1"># specifier, so local version labels can be universally removed from</span>
        <span class="c1"># the prospective version.</span>
        <span class="k">return</span> <span class="n">Version</span><span class="p">(</span><span class="n">prospective</span><span class="o">.</span><span class="n">public</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">Version</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compare_less_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prospective</span><span class="p">:</span> <span class="n">Version</span><span class="p">,</span> <span class="n">spec_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># Convert our spec to a Version instance, since we&#39;ll want to work with</span>
        <span class="c1"># it as a version.</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="n">spec_str</span><span class="p">)</span>

        <span class="c1"># Check to see if the prospective version is less than the spec</span>
        <span class="c1"># version. If it&#39;s not we can short circuit and just return False now</span>
        <span class="c1"># instead of doing extra unneeded work.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">prospective</span> <span class="o">&lt;</span> <span class="n">spec</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># This special case is here so that, unless the specifier itself</span>
        <span class="c1"># includes is a pre-release version, that we do not accept pre-release</span>
        <span class="c1"># versions for the version mentioned in the specifier (e.g. &lt;3.1 should</span>
        <span class="c1"># not match 3.1.dev0, but should match 3.0.dev0).</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span><span class="o">.</span><span class="n">is_prerelease</span> <span class="ow">and</span> <span class="n">prospective</span><span class="o">.</span><span class="n">is_prerelease</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Version</span><span class="p">(</span><span class="n">prospective</span><span class="o">.</span><span class="n">base_version</span><span class="p">)</span> <span class="o">==</span> <span class="n">Version</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">base_version</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># If we&#39;ve gotten to here, it means that prospective version is both</span>
        <span class="c1"># less than the spec version *and* it&#39;s not a pre-release of the same</span>
        <span class="c1"># version in the spec.</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compare_greater_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prospective</span><span class="p">:</span> <span class="n">Version</span><span class="p">,</span> <span class="n">spec_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># Convert our spec to a Version instance, since we&#39;ll want to work with</span>
        <span class="c1"># it as a version.</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="n">spec_str</span><span class="p">)</span>

        <span class="c1"># Check to see if the prospective version is greater than the spec</span>
        <span class="c1"># version. If it&#39;s not we can short circuit and just return False now</span>
        <span class="c1"># instead of doing extra unneeded work.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">prospective</span> <span class="o">&gt;</span> <span class="n">spec</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># This special case is here so that, unless the specifier itself</span>
        <span class="c1"># includes is a post-release version, that we do not accept</span>
        <span class="c1"># post-release versions for the version mentioned in the specifier</span>
        <span class="c1"># (e.g. &gt;3.1 should not match 3.0.post0, but should match 3.2.post0).</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span><span class="o">.</span><span class="n">is_postrelease</span> <span class="ow">and</span> <span class="n">prospective</span><span class="o">.</span><span class="n">is_postrelease</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Version</span><span class="p">(</span><span class="n">prospective</span><span class="o">.</span><span class="n">base_version</span><span class="p">)</span> <span class="o">==</span> <span class="n">Version</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">base_version</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Ensure that we do not allow a local version of the version mentioned</span>
        <span class="c1"># in the specifier, which is technically greater than, to match.</span>
        <span class="k">if</span> <span class="n">prospective</span><span class="o">.</span><span class="n">local</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Version</span><span class="p">(</span><span class="n">prospective</span><span class="o">.</span><span class="n">base_version</span><span class="p">)</span> <span class="o">==</span> <span class="n">Version</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">base_version</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># If we&#39;ve gotten to here, it means that prospective version is both</span>
        <span class="c1"># greater than the spec version *and* it&#39;s not a pre-release of the</span>
        <span class="c1"># same version in the spec.</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compare_arbitrary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prospective</span><span class="p">:</span> <span class="n">Version</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">prospective</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Version</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether or not the item is contained in this specifier.</span>

<span class="sd">        :param item: The item to check for.</span>

<span class="sd">        This is used for the ``in`` operator and behaves the same as</span>
<span class="sd">        :meth:`contains` with no ``prereleases`` argument passed.</span>

<span class="sd">        &gt;&gt;&gt; &quot;1.2.3&quot; in Specifier(&quot;&gt;=1.2.3&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Version(&quot;1.2.3&quot;) in Specifier(&quot;&gt;=1.2.3&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; &quot;1.0.0&quot; in Specifier(&quot;&gt;=1.2.3&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; &quot;1.3.0a1&quot; in Specifier(&quot;&gt;=1.2.3&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; &quot;1.3.0a1&quot; in Specifier(&quot;&gt;=1.2.3&quot;, prereleases=True)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

<div class="viewcode-block" id="Specifier.contains">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.Specifier.contains">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">UnparsedVersion</span><span class="p">,</span> <span class="n">prereleases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether or not the item is contained in this specifier.</span>

<span class="sd">        :param item:</span>
<span class="sd">            The item to check for, which can be a version string or a</span>
<span class="sd">            :class:`Version` instance.</span>
<span class="sd">        :param prereleases:</span>
<span class="sd">            Whether or not to match prereleases with this Specifier. If set to</span>
<span class="sd">            ``None`` (the default), it uses :attr:`prereleases` to determine</span>
<span class="sd">            whether or not prereleases are allowed.</span>

<span class="sd">        &gt;&gt;&gt; Specifier(&quot;&gt;=1.2.3&quot;).contains(&quot;1.2.3&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Specifier(&quot;&gt;=1.2.3&quot;).contains(Version(&quot;1.2.3&quot;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Specifier(&quot;&gt;=1.2.3&quot;).contains(&quot;1.0.0&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; Specifier(&quot;&gt;=1.2.3&quot;).contains(&quot;1.3.0a1&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; Specifier(&quot;&gt;=1.2.3&quot;, prereleases=True).contains(&quot;1.3.0a1&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Specifier(&quot;&gt;=1.2.3&quot;).contains(&quot;1.3.0a1&quot;, prereleases=True)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Determine if prereleases are to be allowed or not.</span>
        <span class="k">if</span> <span class="n">prereleases</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prereleases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prereleases</span>

        <span class="c1"># Normalize item to a Version, this allows us to have a shortcut for</span>
        <span class="c1"># &quot;2.0&quot; in Specifier(&quot;&gt;=2&quot;)</span>
        <span class="n">normalized_item</span> <span class="o">=</span> <span class="n">_coerce_version</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="c1"># Determine if we should be supporting prereleases in this specifier</span>
        <span class="c1"># or not, if we do not support prereleases than we can short circuit</span>
        <span class="c1"># logic if this version is a prereleases.</span>
        <span class="k">if</span> <span class="n">normalized_item</span><span class="o">.</span><span class="n">is_prerelease</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">prereleases</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Actually do the comparison to determine if this item is contained</span>
        <span class="c1"># within this Specifier or not.</span>
        <span class="n">operator_callable</span><span class="p">:</span> <span class="n">CallableOperator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_operator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">operator_callable</span><span class="p">(</span><span class="n">normalized_item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">)</span></div>


<div class="viewcode-block" id="Specifier.filter">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.Specifier.filter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">iterable</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">UnparsedVersionVar</span><span class="p">],</span> <span class="n">prereleases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">UnparsedVersionVar</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter items in the given iterable, that match the specifier.</span>

<span class="sd">        :param iterable:</span>
<span class="sd">            An iterable that can contain version strings and :class:`Version` instances.</span>
<span class="sd">            The items in the iterable will be filtered according to the specifier.</span>
<span class="sd">        :param prereleases:</span>
<span class="sd">            Whether or not to allow prereleases in the returned iterator. If set to</span>
<span class="sd">            ``None`` (the default), it will be intelligently decide whether to allow</span>
<span class="sd">            prereleases or not (based on the :attr:`prereleases` attribute, and</span>
<span class="sd">            whether the only versions matching are prereleases).</span>

<span class="sd">        This method is smarter than just ``filter(Specifier().contains, [...])``</span>
<span class="sd">        because it implements the rule from :pep:`440` that a prerelease item</span>
<span class="sd">        SHOULD be accepted if no other versions match the given specifier.</span>

<span class="sd">        &gt;&gt;&gt; list(Specifier(&quot;&gt;=1.2.3&quot;).filter([&quot;1.2&quot;, &quot;1.3&quot;, &quot;1.5a1&quot;]))</span>
<span class="sd">        [&#39;1.3&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list(Specifier(&quot;&gt;=1.2.3&quot;).filter([&quot;1.2&quot;, &quot;1.2.3&quot;, &quot;1.3&quot;, Version(&quot;1.4&quot;)]))</span>
<span class="sd">        [&#39;1.2.3&#39;, &#39;1.3&#39;, &lt;Version(&#39;1.4&#39;)&gt;]</span>
<span class="sd">        &gt;&gt;&gt; list(Specifier(&quot;&gt;=1.2.3&quot;).filter([&quot;1.2&quot;, &quot;1.5a1&quot;]))</span>
<span class="sd">        [&#39;1.5a1&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list(Specifier(&quot;&gt;=1.2.3&quot;).filter([&quot;1.3&quot;, &quot;1.5a1&quot;], prereleases=True))</span>
<span class="sd">        [&#39;1.3&#39;, &#39;1.5a1&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list(Specifier(&quot;&gt;=1.2.3&quot;, prereleases=True).filter([&quot;1.3&quot;, &quot;1.5a1&quot;]))</span>
<span class="sd">        [&#39;1.3&#39;, &#39;1.5a1&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">yielded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">found_prereleases</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">kw</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;prereleases&quot;</span><span class="p">:</span> <span class="n">prereleases</span> <span class="k">if</span> <span class="n">prereleases</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span><span class="p">}</span>

        <span class="c1"># Attempt to iterate over all the values in the iterable and if any of</span>
        <span class="c1"># them match, yield them.</span>
        <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span>
            <span class="n">parsed_version</span> <span class="o">=</span> <span class="n">_coerce_version</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">parsed_version</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
                <span class="c1"># If our version is a prerelease, and we were not set to allow</span>
                <span class="c1"># prereleases, then we&#39;ll store it for later in case nothing</span>
                <span class="c1"># else matches this specifier.</span>
                <span class="k">if</span> <span class="n">parsed_version</span><span class="o">.</span><span class="n">is_prerelease</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                    <span class="n">prereleases</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">prereleases</span>
                <span class="p">):</span>
                    <span class="n">found_prereleases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>
                <span class="c1"># Either this is not a prerelease, or we should have been</span>
                <span class="c1"># accepting prereleases from the beginning.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">yielded</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">yield</span> <span class="n">version</span>

        <span class="c1"># Now that we&#39;ve iterated over everything, determine if we&#39;ve yielded</span>
        <span class="c1"># any values, and if we have not and we have any prereleases stored up</span>
        <span class="c1"># then we will go ahead and yield the prereleases.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">yielded</span> <span class="ow">and</span> <span class="n">found_prereleases</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="n">found_prereleases</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">version</span></div>
</div>



<span class="n">_prefix_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^([0-9]+)((?:a|b|c|rc)[0-9]+)$&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_version_split</span><span class="p">(</span><span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split version into components.</span>

<span class="sd">    The split components are intended for version comparison. The logic does</span>
<span class="sd">    not attempt to retain the original version string, so joining the</span>
<span class="sd">    components back with :func:`_version_join` may not produce the original</span>
<span class="sd">    version string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">epoch</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">rest</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s2">&quot;!&quot;</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">epoch</span> <span class="ow">or</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">rest</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">_prefix_regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_version_join</span><span class="p">(</span><span class="n">components</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Join split version components into a version string.</span>

<span class="sd">    This function assumes the input came from :func:`_version_split`, where the</span>
<span class="sd">    first component must be the epoch (either empty or numeric), and all other</span>
<span class="sd">    components numeric.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">epoch</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span> <span class="o">=</span> <span class="n">components</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s2">!</span><span class="si">{</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rest</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_is_not_suffix</span><span class="p">(</span><span class="n">segment</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;dev&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;rc&quot;</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">)</span>
    <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_pad_version</span><span class="p">(</span><span class="n">left</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">right</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
    <span class="n">left_split</span><span class="p">,</span> <span class="n">right_split</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="c1"># Get the release segment of our versions</span>
    <span class="n">left_split</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">takewhile</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">isdigit</span><span class="p">(),</span> <span class="n">left</span><span class="p">)))</span>
    <span class="n">right_split</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">takewhile</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">isdigit</span><span class="p">(),</span> <span class="n">right</span><span class="p">)))</span>

    <span class="c1"># Get the rest of our versions</span>
    <span class="n">left_split</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">left</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">left_split</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">:])</span>
    <span class="n">right_split</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">right_split</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">:])</span>

    <span class="c1"># Insert our padding</span>
    <span class="n">left_split</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_split</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">left_split</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
    <span class="n">right_split</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">left_split</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_split</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">left_split</span><span class="p">)),</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">right_split</span><span class="p">)),</span>
    <span class="p">)</span>


<div class="viewcode-block" id="SpecifierSet">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.SpecifierSet">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">SpecifierSet</span><span class="p">(</span><span class="n">BaseSpecifier</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This class abstracts handling of a set of version specifiers.</span>

<span class="sd">    It can be passed a single specifier (``&gt;=3.0``), a comma-separated list of</span>
<span class="sd">    specifiers (``&gt;=3.0,!=3.1``), or no specifier at all.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">specifiers</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Specifier</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">prereleases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a SpecifierSet instance.</span>

<span class="sd">        :param specifiers:</span>
<span class="sd">            The string representation of a specifier or a comma-separated list of</span>
<span class="sd">            specifiers which will be parsed and normalized before use.</span>
<span class="sd">            May also be an iterable of ``Specifier`` instances, which will be used</span>
<span class="sd">            as is.</span>
<span class="sd">        :param prereleases:</span>
<span class="sd">            This tells the SpecifierSet if it should accept prerelease versions if</span>
<span class="sd">            applicable or not. The default of ``None`` will autodetect it from the</span>
<span class="sd">            given specifiers.</span>

<span class="sd">        :raises InvalidSpecifier:</span>
<span class="sd">            If the given ``specifiers`` are not parseable than this exception will be</span>
<span class="sd">            raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">specifiers</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># Split on `,` to break each individual specifier into its own item, and</span>
            <span class="c1"># strip each item to remove leading/trailing whitespace.</span>
            <span class="n">split_specifiers</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">specifiers</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>

            <span class="c1"># Make each individual specifier a Specifier and save in a frozen set</span>
            <span class="c1"># for later.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_specs</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">Specifier</span><span class="p">,</span> <span class="n">split_specifiers</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Save the supplied specifiers in a frozen set.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_specs</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">specifiers</span><span class="p">)</span>

        <span class="c1"># Store our prereleases value so we can use it later to determine if</span>
        <span class="c1"># we accept prereleases or not.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span> <span class="o">=</span> <span class="n">prereleases</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="SpecifierSet.prereleases">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.SpecifierSet.prereleases">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">prereleases</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If we have been given an explicit prerelease modifier, then we&#39;ll</span>
        <span class="c1"># pass that through here.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span>

        <span class="c1"># If we don&#39;t have any specifiers, and we don&#39;t have a forced value,</span>
        <span class="c1"># then we&#39;ll just return None since we don&#39;t know if this should have</span>
        <span class="c1"># pre-releases or not.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_specs</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Otherwise we&#39;ll see if any of the given specifiers accept</span>
        <span class="c1"># prereleases, if any of them do we&#39;ll return True, otherwise False.</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">prereleases</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_specs</span><span class="p">)</span></div>


    <span class="nd">@prereleases</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prereleases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A representation of the specifier set that shows all internal state.</span>

<span class="sd">        Note that the ordering of the individual specifiers within the set may not</span>
<span class="sd">        match the input string.</span>

<span class="sd">        &gt;&gt;&gt; SpecifierSet(&#39;&gt;=1.0.0,!=2.0.0&#39;)</span>
<span class="sd">        &lt;SpecifierSet(&#39;!=2.0.0,&gt;=1.0.0&#39;)&gt;</span>
<span class="sd">        &gt;&gt;&gt; SpecifierSet(&#39;&gt;=1.0.0,!=2.0.0&#39;, prereleases=False)</span>
<span class="sd">        &lt;SpecifierSet(&#39;!=2.0.0,&gt;=1.0.0&#39;, prereleases=False)&gt;</span>
<span class="sd">        &gt;&gt;&gt; SpecifierSet(&#39;&gt;=1.0.0,!=2.0.0&#39;, prereleases=True)</span>
<span class="sd">        &lt;SpecifierSet(&#39;!=2.0.0,&gt;=1.0.0&#39;, prereleases=True)&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pre</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;, prereleases=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">prereleases</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;SpecifierSet(</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">!r}{</span><span class="n">pre</span><span class="si">}</span><span class="s2">)&gt;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A string representation of the specifier set that can be round-tripped.</span>

<span class="sd">        Note that the ordering of the individual specifiers within the set may not</span>
<span class="sd">        match the input string.</span>

<span class="sd">        &gt;&gt;&gt; str(SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;))</span>
<span class="sd">        &#39;!=1.0.1,&gt;=1.0.0&#39;</span>
<span class="sd">        &gt;&gt;&gt; str(SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;, prereleases=False))</span>
<span class="sd">        &#39;!=1.0.1,&gt;=1.0.0&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_specs</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_specs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SpecifierSet</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SpecifierSet</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a SpecifierSet which is a combination of the two sets.</span>

<span class="sd">        :param other: The other object to combine with.</span>

<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;) &amp; &#39;&lt;=2.0.0,!=2.0.1&#39;</span>
<span class="sd">        &lt;SpecifierSet(&#39;!=1.0.1,!=2.0.1,&lt;=2.0.0,&gt;=1.0.0&#39;)&gt;</span>
<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;) &amp; SpecifierSet(&#39;&lt;=2.0.0,!=2.0.1&#39;)</span>
<span class="sd">        &lt;SpecifierSet(&#39;!=1.0.1,!=2.0.1,&lt;=2.0.0,&gt;=1.0.0&#39;)&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">SpecifierSet</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SpecifierSet</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="n">specifier</span> <span class="o">=</span> <span class="n">SpecifierSet</span><span class="p">()</span>
        <span class="n">specifier</span><span class="o">.</span><span class="n">_specs</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_specs</span> <span class="o">|</span> <span class="n">other</span><span class="o">.</span><span class="n">_specs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">_prereleases</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">specifier</span><span class="o">.</span><span class="n">_prereleases</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_prereleases</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">_prereleases</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">specifier</span><span class="o">.</span><span class="n">_prereleases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_prereleases</span><span class="p">:</span>
            <span class="n">specifier</span><span class="o">.</span><span class="n">_prereleases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prereleases</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot combine SpecifierSets with True and False prerelease overrides.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">specifier</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether or not the two SpecifierSet-like objects are equal.</span>

<span class="sd">        :param other: The other object to check against.</span>

<span class="sd">        The value of :attr:`prereleases` is ignored.</span>

<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;) == SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; (SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;, prereleases=False) ==</span>
<span class="sd">        ...  SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;, prereleases=True))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;) == &quot;&gt;=1.0.0,!=1.0.1&quot;</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;) == SpecifierSet(&quot;&gt;=1.0.0&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;) == SpecifierSet(&quot;&gt;=1.0.0,!=1.0.2&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Specifier</span><span class="p">)):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">SpecifierSet</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SpecifierSet</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_specs</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_specs</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the number of specifiers in this specifier set.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_specs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Specifier</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an iterator over all the underlying :class:`Specifier` instances</span>
<span class="sd">        in this specifier set.</span>

<span class="sd">        &gt;&gt;&gt; sorted(SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;), key=str)</span>
<span class="sd">        [&lt;Specifier(&#39;!=1.0.1&#39;)&gt;, &lt;Specifier(&#39;&gt;=1.0.0&#39;)&gt;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_specs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">UnparsedVersion</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether or not the item is contained in this specifier.</span>

<span class="sd">        :param item: The item to check for.</span>

<span class="sd">        This is used for the ``in`` operator and behaves the same as</span>
<span class="sd">        :meth:`contains` with no ``prereleases`` argument passed.</span>

<span class="sd">        &gt;&gt;&gt; &quot;1.2.3&quot; in SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Version(&quot;1.2.3&quot;) in SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; &quot;1.0.1&quot; in SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; &quot;1.3.0a1&quot; in SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; &quot;1.3.0a1&quot; in SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;, prereleases=True)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

<div class="viewcode-block" id="SpecifierSet.contains">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.SpecifierSet.contains">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">item</span><span class="p">:</span> <span class="n">UnparsedVersion</span><span class="p">,</span>
        <span class="n">prereleases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">installed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether or not the item is contained in this SpecifierSet.</span>

<span class="sd">        :param item:</span>
<span class="sd">            The item to check for, which can be a version string or a</span>
<span class="sd">            :class:`Version` instance.</span>
<span class="sd">        :param prereleases:</span>
<span class="sd">            Whether or not to match prereleases with this SpecifierSet. If set to</span>
<span class="sd">            ``None`` (the default), it uses :attr:`prereleases` to determine</span>
<span class="sd">            whether or not prereleases are allowed.</span>

<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;).contains(&quot;1.2.3&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;).contains(Version(&quot;1.2.3&quot;))</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;).contains(&quot;1.0.1&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;).contains(&quot;1.3.0a1&quot;)</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;, prereleases=True).contains(&quot;1.3.0a1&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; SpecifierSet(&quot;&gt;=1.0.0,!=1.0.1&quot;).contains(&quot;1.3.0a1&quot;, prereleases=True)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Ensure that our item is a Version instance.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Version</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="c1"># Determine if we&#39;re forcing a prerelease or not, if we&#39;re not forcing</span>
        <span class="c1"># one for this particular filter call, then we&#39;ll use whatever the</span>
        <span class="c1"># SpecifierSet thinks for whether or not we should support prereleases.</span>
        <span class="k">if</span> <span class="n">prereleases</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prereleases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prereleases</span>

        <span class="c1"># We can determine if we&#39;re going to allow pre-releases by looking to</span>
        <span class="c1"># see if any of the underlying items supports them. If none of them do</span>
        <span class="c1"># and this item is a pre-release then we do not allow it and we can</span>
        <span class="c1"># short circuit that here.</span>
        <span class="c1"># Note: This means that 1.0.dev1 would not be contained in something</span>
        <span class="c1">#       like &gt;=1.0.devabc however it would be in &gt;=1.0.debabc,&gt;0.0.dev0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">prereleases</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">is_prerelease</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">installed</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">is_prerelease</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">base_version</span><span class="p">)</span>

        <span class="c1"># We simply dispatch to the underlying specs here to make sure that the</span>
        <span class="c1"># given version is contained within all of them.</span>
        <span class="c1"># Note: This use of all() here means that an empty set of specifiers</span>
        <span class="c1">#       will always return True, this is an explicit design decision.</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">prereleases</span><span class="o">=</span><span class="n">prereleases</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_specs</span><span class="p">)</span></div>


<div class="viewcode-block" id="SpecifierSet.filter">
<a class="viewcode-back" href="../../autoapi/packaging/specifiers/index.html#packaging.specifiers.SpecifierSet.filter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">iterable</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">UnparsedVersionVar</span><span class="p">],</span> <span class="n">prereleases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">UnparsedVersionVar</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter items in the given iterable, that match the specifiers in this set.</span>

<span class="sd">        :param iterable:</span>
<span class="sd">            An iterable that can contain version strings and :class:`Version` instances.</span>
<span class="sd">            The items in the iterable will be filtered according to the specifier.</span>
<span class="sd">        :param prereleases:</span>
<span class="sd">            Whether or not to allow prereleases in the returned iterator. If set to</span>
<span class="sd">            ``None`` (the default), it will be intelligently decide whether to allow</span>
<span class="sd">            prereleases or not (based on the :attr:`prereleases` attribute, and</span>
<span class="sd">            whether the only versions matching are prereleases).</span>

<span class="sd">        This method is smarter than just ``filter(SpecifierSet(...).contains, [...])``</span>
<span class="sd">        because it implements the rule from :pep:`440` that a prerelease item</span>
<span class="sd">        SHOULD be accepted if no other versions match the given specifier.</span>

<span class="sd">        &gt;&gt;&gt; list(SpecifierSet(&quot;&gt;=1.2.3&quot;).filter([&quot;1.2&quot;, &quot;1.3&quot;, &quot;1.5a1&quot;]))</span>
<span class="sd">        [&#39;1.3&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list(SpecifierSet(&quot;&gt;=1.2.3&quot;).filter([&quot;1.2&quot;, &quot;1.3&quot;, Version(&quot;1.4&quot;)]))</span>
<span class="sd">        [&#39;1.3&#39;, &lt;Version(&#39;1.4&#39;)&gt;]</span>
<span class="sd">        &gt;&gt;&gt; list(SpecifierSet(&quot;&gt;=1.2.3&quot;).filter([&quot;1.2&quot;, &quot;1.5a1&quot;]))</span>
<span class="sd">        []</span>
<span class="sd">        &gt;&gt;&gt; list(SpecifierSet(&quot;&gt;=1.2.3&quot;).filter([&quot;1.3&quot;, &quot;1.5a1&quot;], prereleases=True))</span>
<span class="sd">        [&#39;1.3&#39;, &#39;1.5a1&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list(SpecifierSet(&quot;&gt;=1.2.3&quot;, prereleases=True).filter([&quot;1.3&quot;, &quot;1.5a1&quot;]))</span>
<span class="sd">        [&#39;1.3&#39;, &#39;1.5a1&#39;]</span>

<span class="sd">        An &quot;empty&quot; SpecifierSet will filter items based on the presence of prerelease</span>
<span class="sd">        versions in the set.</span>

<span class="sd">        &gt;&gt;&gt; list(SpecifierSet(&quot;&quot;).filter([&quot;1.3&quot;, &quot;1.5a1&quot;]))</span>
<span class="sd">        [&#39;1.3&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list(SpecifierSet(&quot;&quot;).filter([&quot;1.5a1&quot;]))</span>
<span class="sd">        [&#39;1.5a1&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list(SpecifierSet(&quot;&quot;, prereleases=True).filter([&quot;1.3&quot;, &quot;1.5a1&quot;]))</span>
<span class="sd">        [&#39;1.3&#39;, &#39;1.5a1&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list(SpecifierSet(&quot;&quot;).filter([&quot;1.3&quot;, &quot;1.5a1&quot;], prereleases=True))</span>
<span class="sd">        [&#39;1.3&#39;, &#39;1.5a1&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Determine if we&#39;re forcing a prerelease or not, if we&#39;re not forcing</span>
        <span class="c1"># one for this particular filter call, then we&#39;ll use whatever the</span>
        <span class="c1"># SpecifierSet thinks for whether or not we should support prereleases.</span>
        <span class="k">if</span> <span class="n">prereleases</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prereleases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prereleases</span>

        <span class="c1"># If we have any specifiers, then we want to wrap our iterable in the</span>
        <span class="c1"># filter method for each one, this will act as a logical AND amongst</span>
        <span class="c1"># each specifier.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_specs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_specs</span><span class="p">:</span>
                <span class="n">iterable</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">prereleases</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">prereleases</span><span class="p">))</span>
            <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
        <span class="c1"># If we do not have any specifiers, then we need to have a rough filter</span>
        <span class="c1"># which will filter out any pre-releases, unless there are no final</span>
        <span class="c1"># releases.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filtered</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">UnparsedVersionVar</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">found_prereleases</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">UnparsedVersionVar</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span>
                <span class="n">parsed_version</span> <span class="o">=</span> <span class="n">_coerce_version</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

                <span class="c1"># Store any item which is a pre-release for later unless we&#39;ve</span>
                <span class="c1"># already found a final version or we are accepting prereleases</span>
                <span class="k">if</span> <span class="n">parsed_version</span><span class="o">.</span><span class="n">is_prerelease</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">prereleases</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">filtered</span><span class="p">:</span>
                        <span class="n">found_prereleases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">filtered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

            <span class="c1"># If we&#39;ve found no items except for pre-releases, then we&#39;ll go</span>
            <span class="c1"># ahead and use the pre-releases</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">filtered</span> <span class="ow">and</span> <span class="n">found_prereleases</span> <span class="ow">and</span> <span class="n">prereleases</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">found_prereleases</span><span class="p">)</span>

            <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>