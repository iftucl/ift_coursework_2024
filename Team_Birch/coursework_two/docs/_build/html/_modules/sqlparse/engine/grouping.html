

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sqlparse.engine.grouping &mdash; Coursework Two 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Coursework Two
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation_guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage_instructions.html">Usage Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture_overview.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Coursework Two</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">sqlparse.engine.grouping</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sqlparse.engine.grouping</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Copyright (C) 2009-2020 the sqlparse authors and contributors</span>
<span class="c1"># &lt;see AUTHORS file&gt;</span>
<span class="c1">#</span>
<span class="c1"># This module is part of python-sqlparse and is released under</span>
<span class="c1"># the BSD License: https://opensource.org/licenses/BSD-3-Clause</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sqlparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">sql</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">tokens</span> <span class="k">as</span> <span class="n">T</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlparse.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">imt</span><span class="p">,</span> <span class="n">recurse</span>

<div class="viewcode-block" id="T_NUMERICAL">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.T_NUMERICAL">[docs]</a>
<span class="n">T_NUMERICAL</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">Number</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">Number</span><span class="o">.</span><span class="n">Float</span><span class="p">)</span></div>

<div class="viewcode-block" id="T_STRING">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.T_STRING">[docs]</a>
<span class="n">T_STRING</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">String</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">String</span><span class="o">.</span><span class="n">Single</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">String</span><span class="o">.</span><span class="n">Symbol</span><span class="p">)</span></div>

<div class="viewcode-block" id="T_NAME">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.T_NAME">[docs]</a>
<span class="n">T_NAME</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">Placeholder</span><span class="p">)</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">_group_matching</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Groups Tokens that have beginning and end.&quot;&quot;&quot;</span>
    <span class="n">opens</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tidx_offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tlist</span><span class="p">)):</span>
        <span class="n">tidx</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">-</span> <span class="n">tidx_offset</span>

        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_whitespace</span><span class="p">:</span>
            <span class="c1"># ~50% of tokens will be whitespace. Will checking early</span>
            <span class="c1"># for them avoid 3 comparisons, but then add 1 more comparison</span>
            <span class="c1"># for the other ~50% of tokens...</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_group</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="c1"># Check inside previously grouped (i.e. parenthesis) if group</span>
            <span class="c1"># of different type is inside (i.e., case). though ideally  should</span>
            <span class="c1"># should check for all open/close tokens at once to avoid recursion</span>
            <span class="n">_group_matching</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="o">*</span><span class="bp">cls</span><span class="o">.</span><span class="n">M_OPEN</span><span class="p">):</span>
            <span class="n">opens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tidx</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="o">*</span><span class="bp">cls</span><span class="o">.</span><span class="n">M_CLOSE</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">open_idx</span> <span class="o">=</span> <span class="n">opens</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="c1"># this indicates invalid sql and unbalanced tokens.</span>
                <span class="c1"># instead of break, continue in case other &quot;valid&quot; groups exist</span>
                <span class="k">continue</span>
            <span class="n">close_idx</span> <span class="o">=</span> <span class="n">tidx</span>
            <span class="n">tlist</span><span class="o">.</span><span class="n">group_tokens</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">open_idx</span><span class="p">,</span> <span class="n">close_idx</span><span class="p">)</span>
            <span class="n">tidx_offset</span> <span class="o">+=</span> <span class="n">close_idx</span> <span class="o">-</span> <span class="n">open_idx</span>


<div class="viewcode-block" id="group_brackets">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_brackets">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_brackets</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">_group_matching</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">SquareBrackets</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_parenthesis">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_parenthesis">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_parenthesis</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">_group_matching</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Parenthesis</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_case">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_case">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_case</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">_group_matching</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Case</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_if">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_if">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_if</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">_group_matching</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">If</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_for">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_for">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_for</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">_group_matching</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">For</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_begin">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_begin">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_begin</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">_group_matching</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Begin</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_typecasts">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_typecasts">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_typecasts</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Punctuation</span><span class="p">,</span> <span class="s2">&quot;::&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">nidx</span>

    <span class="n">valid_prev</span> <span class="o">=</span> <span class="n">valid_next</span> <span class="o">=</span> <span class="n">valid</span>
    <span class="n">_group</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">valid_prev</span><span class="p">,</span> <span class="n">valid_next</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_tzcasts">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_tzcasts">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_tzcasts</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span><span class="o">.</span><span class="n">ttype</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">Keyword</span><span class="o">.</span><span class="n">TZCast</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid_prev</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid_next</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">token</span><span class="o">.</span><span class="n">is_whitespace</span>
            <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Keyword</span><span class="p">,</span> <span class="s2">&quot;AS&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="o">*</span><span class="n">sql</span><span class="o">.</span><span class="n">TypedLiteral</span><span class="o">.</span><span class="n">M_CLOSE</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">nidx</span>

    <span class="n">_group</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">valid_prev</span><span class="p">,</span> <span class="n">valid_next</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_typed_literal">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_typed_literal">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_typed_literal</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="c1"># definitely not complete, see e.g.:</span>
    <span class="c1"># https://docs.microsoft.com/en-us/sql/odbc/reference/appendixes/interval-literal-syntax</span>
    <span class="c1"># https://docs.microsoft.com/en-us/sql/odbc/reference/appendixes/interval-literals</span>
    <span class="c1"># https://www.postgresql.org/docs/9.1/datatype-datetime.html</span>
    <span class="c1"># https://www.postgresql.org/docs/9.1/functions-datetime.html</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">imt</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">TypedLiteral</span><span class="o">.</span><span class="n">M_OPEN</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">match_to_extend</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">TypedLiteral</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid_prev</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid_next</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="o">*</span><span class="n">sql</span><span class="o">.</span><span class="n">TypedLiteral</span><span class="o">.</span><span class="n">M_CLOSE</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid_final</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="o">*</span><span class="n">sql</span><span class="o">.</span><span class="n">TypedLiteral</span><span class="o">.</span><span class="n">M_EXTEND</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span>

    <span class="n">_group</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">TypedLiteral</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">valid_prev</span><span class="p">,</span> <span class="n">valid_next</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_group</span><span class="p">(</span>
        <span class="n">tlist</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">TypedLiteral</span><span class="p">,</span>
        <span class="n">match_to_extend</span><span class="p">,</span>
        <span class="n">valid_prev</span><span class="p">,</span>
        <span class="n">valid_final</span><span class="p">,</span>
        <span class="n">post</span><span class="p">,</span>
        <span class="n">extend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="group_period">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_period">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_period</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ttype</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Punctuation</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Operator</span><span class="p">,</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Operator</span><span class="p">,</span> <span class="s2">&quot;-&gt;&gt;&quot;</span><span class="p">),</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">ttype</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid_prev</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="n">sqlcls</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">SquareBrackets</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span>
        <span class="n">ttypes</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">String</span><span class="o">.</span><span class="n">Symbol</span>
        <span class="k">return</span> <span class="n">imt</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">sqlcls</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">ttypes</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid_next</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="c1"># issue261, allow invalid next token</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">):</span>
        <span class="c1"># next_ validation is being performed here. issue261</span>
        <span class="n">sqlcls</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">SquareBrackets</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Function</span>
        <span class="n">ttypes</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">String</span><span class="o">.</span><span class="n">Symbol</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">Wildcard</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">String</span><span class="o">.</span><span class="n">Single</span>
        <span class="n">next_</span> <span class="o">=</span> <span class="n">tlist</span><span class="p">[</span><span class="n">nidx</span><span class="p">]</span> <span class="k">if</span> <span class="n">nidx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">valid_next</span> <span class="o">=</span> <span class="n">imt</span><span class="p">(</span><span class="n">next_</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">sqlcls</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">ttypes</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">pidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">)</span> <span class="k">if</span> <span class="n">valid_next</span> <span class="k">else</span> <span class="p">(</span><span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">)</span>

    <span class="n">_group</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">valid_prev</span><span class="p">,</span> <span class="n">valid_next</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_as">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_as">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_as</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span><span class="o">.</span><span class="n">is_keyword</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">normalized</span> <span class="o">==</span> <span class="s2">&quot;AS&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid_prev</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span><span class="o">.</span><span class="n">normalized</span> <span class="o">==</span> <span class="s2">&quot;NULL&quot;</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">is_keyword</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid_next</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="n">ttypes</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">DML</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">DDL</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">CTE</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">imt</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">ttypes</span><span class="p">)</span> <span class="ow">and</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">nidx</span>

    <span class="n">_group</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">valid_prev</span><span class="p">,</span> <span class="n">valid_next</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_assignment">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_assignment">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_assignment</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Assignment</span><span class="p">,</span> <span class="s2">&quot;:=&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">ttype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Keyword</span><span class="p">,)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">):</span>
        <span class="n">m_semicolon</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Punctuation</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span>
        <span class="n">snidx</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m_semicolon</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">nidx</span><span class="p">)</span>
        <span class="n">nidx</span> <span class="o">=</span> <span class="n">snidx</span> <span class="ow">or</span> <span class="n">nidx</span>
        <span class="k">return</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">nidx</span>

    <span class="n">valid_prev</span> <span class="o">=</span> <span class="n">valid_next</span> <span class="o">=</span> <span class="n">valid</span>
    <span class="n">_group</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Assignment</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">valid_prev</span><span class="p">,</span> <span class="n">valid_next</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_comparison">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_comparison">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_comparison</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">sqlcls</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Parenthesis</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Function</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Operation</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">TypedLiteral</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ttypes</span> <span class="o">=</span> <span class="n">T_NUMERICAL</span> <span class="o">+</span> <span class="n">T_STRING</span> <span class="o">+</span> <span class="n">T_NAME</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span><span class="o">.</span><span class="n">ttype</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">Operator</span><span class="o">.</span><span class="n">Comparison</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">imt</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">ttypes</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">sqlcls</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">token</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">is_keyword</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">normalized</span> <span class="o">==</span> <span class="s2">&quot;NULL&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">nidx</span>

    <span class="n">valid_prev</span> <span class="o">=</span> <span class="n">valid_next</span> <span class="o">=</span> <span class="n">valid</span>
    <span class="n">_group</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Comparison</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">valid_prev</span><span class="p">,</span> <span class="n">valid_next</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>



<span class="nd">@recurse</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">)</span>
<div class="viewcode-block" id="group_identifier">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_identifier">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_identifier</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">ttypes</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">String</span><span class="o">.</span><span class="n">Symbol</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>

    <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">ttypes</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">token</span><span class="p">:</span>
        <span class="n">tlist</span><span class="o">.</span><span class="n">group_tokens</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">)</span>
        <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">ttypes</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">tidx</span><span class="p">)</span></div>



<span class="nd">@recurse</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Over</span><span class="p">)</span>
<div class="viewcode-block" id="group_over">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_over">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_over</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Over</span><span class="o">.</span><span class="n">M_OPEN</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">token</span><span class="p">:</span>
        <span class="n">nidx</span><span class="p">,</span> <span class="n">next_</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next</span><span class="p">(</span><span class="n">tidx</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">imt</span><span class="p">(</span><span class="n">next_</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Parenthesis</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Name</span><span class="p">):</span>
            <span class="n">tlist</span><span class="o">.</span><span class="n">group_tokens</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Over</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">)</span>
        <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Over</span><span class="o">.</span><span class="n">M_OPEN</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">tidx</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_arrays">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_arrays">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_arrays</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">sqlcls</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">SquareBrackets</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Function</span>
    <span class="n">ttypes</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">String</span><span class="o">.</span><span class="n">Symbol</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">SquareBrackets</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid_prev</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">imt</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">sqlcls</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">ttypes</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid_next</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span>

    <span class="n">_group</span><span class="p">(</span>
        <span class="n">tlist</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span>
        <span class="n">match</span><span class="p">,</span>
        <span class="n">valid_prev</span><span class="p">,</span>
        <span class="n">valid_next</span><span class="p">,</span>
        <span class="n">post</span><span class="p">,</span>
        <span class="n">extend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="group_operator">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_operator">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_operator</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">ttypes</span> <span class="o">=</span> <span class="n">T_NUMERICAL</span> <span class="o">+</span> <span class="n">T_STRING</span> <span class="o">+</span> <span class="n">T_NAME</span>
    <span class="n">sqlcls</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">SquareBrackets</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Parenthesis</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Function</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Operation</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">TypedLiteral</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">imt</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Operator</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">Wildcard</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">imt</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">sqlcls</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">ttypes</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">token</span>
            <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                <span class="n">T</span><span class="o">.</span><span class="n">Keyword</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;CURRENT_DATE&quot;</span><span class="p">,</span> <span class="s2">&quot;CURRENT_TIME&quot;</span><span class="p">,</span> <span class="s2">&quot;CURRENT_TIMESTAMP&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">):</span>
        <span class="n">tlist</span><span class="p">[</span><span class="n">tidx</span><span class="p">]</span><span class="o">.</span><span class="n">ttype</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Operator</span>
        <span class="k">return</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">nidx</span>

    <span class="n">valid_prev</span> <span class="o">=</span> <span class="n">valid_next</span> <span class="o">=</span> <span class="n">valid</span>
    <span class="n">_group</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Operation</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">valid_prev</span><span class="p">,</span> <span class="n">valid_next</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_identifier_list">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_identifier_list">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_identifier_list</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">m_role</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Keyword</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="s2">&quot;role&quot;</span><span class="p">)</span>
    <span class="n">sqlcls</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Function</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Case</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Comparison</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">IdentifierList</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Operation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ttypes</span> <span class="o">=</span> <span class="n">T_NUMERICAL</span> <span class="o">+</span> <span class="n">T_STRING</span> <span class="o">+</span> <span class="n">T_NAME</span> <span class="o">+</span> <span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Keyword</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">Comment</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">Wildcard</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Punctuation</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">valid</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">imt</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">sqlcls</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m_role</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">ttypes</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">nidx</span>

    <span class="n">valid_prev</span> <span class="o">=</span> <span class="n">valid_next</span> <span class="o">=</span> <span class="n">valid</span>
    <span class="n">_group</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">IdentifierList</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">valid_prev</span><span class="p">,</span> <span class="n">valid_next</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>



<span class="nd">@recurse</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Comment</span><span class="p">)</span>
<div class="viewcode-block" id="group_comments">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_comments">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_comments</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Comment</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">token</span><span class="p">:</span>
        <span class="n">eidx</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_not_matching</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">tk</span><span class="p">:</span> <span class="n">imt</span><span class="p">(</span><span class="n">tk</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Comment</span><span class="p">)</span> <span class="ow">or</span> <span class="n">tk</span><span class="o">.</span><span class="n">is_newline</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">tidx</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">eidx</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_prev</span><span class="p">(</span><span class="n">eidx</span><span class="p">,</span> <span class="n">skip_ws</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">tlist</span><span class="o">.</span><span class="n">group_tokens</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Comment</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">eidx</span><span class="p">)</span>

        <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Comment</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">tidx</span><span class="p">)</span></div>



<span class="nd">@recurse</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Where</span><span class="p">)</span>
<div class="viewcode-block" id="group_where">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_where">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_where</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Where</span><span class="o">.</span><span class="n">M_OPEN</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">token</span><span class="p">:</span>
        <span class="n">eidx</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Where</span><span class="o">.</span><span class="n">M_CLOSE</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">tidx</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">_groupable_tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">tokens</span><span class="p">[</span><span class="n">eidx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="c1"># TODO: convert this to eidx instead of end token.</span>
        <span class="c1"># i think above values are len(tlist) and eidx-1</span>
        <span class="n">eidx</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_index</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
        <span class="n">tlist</span><span class="o">.</span><span class="n">group_tokens</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Where</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">eidx</span><span class="p">)</span>
        <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Where</span><span class="o">.</span><span class="n">M_OPEN</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">tidx</span><span class="p">)</span></div>



<span class="nd">@recurse</span><span class="p">()</span>
<div class="viewcode-block" id="group_aliased">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_aliased">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_aliased</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">I_ALIAS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Parenthesis</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Function</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Case</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Operation</span><span class="p">,</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Comparison</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">I_ALIAS</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">token</span><span class="p">:</span>
        <span class="n">nidx</span><span class="p">,</span> <span class="n">next_</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next</span><span class="p">(</span><span class="n">tidx</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">next_</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">):</span>
            <span class="n">tlist</span><span class="o">.</span><span class="n">group_tokens</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">I_ALIAS</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">tidx</span><span class="p">)</span></div>



<span class="nd">@recurse</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Function</span><span class="p">)</span>
<div class="viewcode-block" id="group_functions">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_functions">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_functions</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">has_create</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">has_table</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">has_as</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">tmp_token</span> <span class="ow">in</span> <span class="n">tlist</span><span class="o">.</span><span class="n">tokens</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tmp_token</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;CREATE&quot;</span><span class="p">:</span>
            <span class="n">has_create</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">tmp_token</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;TABLE&quot;</span><span class="p">:</span>
            <span class="n">has_table</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">tmp_token</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;AS&quot;</span><span class="p">:</span>
            <span class="n">has_as</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">has_create</span> <span class="ow">and</span> <span class="n">has_table</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_as</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">token</span><span class="p">:</span>
        <span class="n">nidx</span><span class="p">,</span> <span class="n">next_</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next</span><span class="p">(</span><span class="n">tidx</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">next_</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Parenthesis</span><span class="p">):</span>
            <span class="n">over_idx</span><span class="p">,</span> <span class="n">over</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next</span><span class="p">(</span><span class="n">nidx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">over</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">over</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Over</span><span class="p">):</span>
                <span class="n">eidx</span> <span class="o">=</span> <span class="n">over_idx</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">eidx</span> <span class="o">=</span> <span class="n">nidx</span>
            <span class="n">tlist</span><span class="o">.</span><span class="n">group_tokens</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Function</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">eidx</span><span class="p">)</span>
        <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">tidx</span><span class="p">)</span></div>



<span class="nd">@recurse</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">)</span>
<div class="viewcode-block" id="group_order">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_order">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_order</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Group together Identifier and Asc/Desc token&quot;&quot;&quot;</span>
    <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Keyword</span><span class="o">.</span><span class="n">Order</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">token</span><span class="p">:</span>
        <span class="n">pidx</span><span class="p">,</span> <span class="n">prev_</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_prev</span><span class="p">(</span><span class="n">tidx</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">imt</span><span class="p">(</span><span class="n">prev_</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Number</span><span class="p">):</span>
            <span class="n">tlist</span><span class="o">.</span><span class="n">group_tokens</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">)</span>
            <span class="n">tidx</span> <span class="o">=</span> <span class="n">pidx</span>
        <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Keyword</span><span class="o">.</span><span class="n">Order</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">tidx</span><span class="p">)</span></div>



<span class="nd">@recurse</span><span class="p">()</span>
<div class="viewcode-block" id="align_comments">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.align_comments">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">align_comments</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Comment</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">token</span><span class="p">:</span>
        <span class="n">pidx</span><span class="p">,</span> <span class="n">prev_</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_prev</span><span class="p">(</span><span class="n">tidx</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prev_</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">TokenList</span><span class="p">):</span>
            <span class="n">tlist</span><span class="o">.</span><span class="n">group_tokens</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">TokenList</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">tidx</span> <span class="o">=</span> <span class="n">pidx</span>
        <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Comment</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">tidx</span><span class="p">)</span></div>



<div class="viewcode-block" id="group_values">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group_values">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group_values</span><span class="p">(</span><span class="n">tlist</span><span class="p">):</span>
    <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next_by</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Keyword</span><span class="p">,</span> <span class="s2">&quot;VALUES&quot;</span><span class="p">))</span>
    <span class="n">start_idx</span> <span class="o">=</span> <span class="n">tidx</span>
    <span class="n">end_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">while</span> <span class="n">token</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Parenthesis</span><span class="p">):</span>
            <span class="n">end_idx</span> <span class="o">=</span> <span class="n">tidx</span>
        <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next</span><span class="p">(</span><span class="n">tidx</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">end_idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">tlist</span><span class="o">.</span><span class="n">group_tokens</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Values</span><span class="p">,</span> <span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>



<div class="viewcode-block" id="group">
<a class="viewcode-back" href="../../../autoapi/sqlparse/engine/grouping/index.html#sqlparse.engine.grouping.group">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">group</span><span class="p">(</span><span class="n">stmt</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="n">group_comments</span><span class="p">,</span>
        <span class="c1"># _group_matching</span>
        <span class="n">group_brackets</span><span class="p">,</span>
        <span class="n">group_parenthesis</span><span class="p">,</span>
        <span class="n">group_case</span><span class="p">,</span>
        <span class="n">group_if</span><span class="p">,</span>
        <span class="n">group_for</span><span class="p">,</span>
        <span class="n">group_begin</span><span class="p">,</span>
        <span class="n">group_over</span><span class="p">,</span>
        <span class="n">group_functions</span><span class="p">,</span>
        <span class="n">group_where</span><span class="p">,</span>
        <span class="n">group_period</span><span class="p">,</span>
        <span class="n">group_arrays</span><span class="p">,</span>
        <span class="n">group_identifier</span><span class="p">,</span>
        <span class="n">group_order</span><span class="p">,</span>
        <span class="n">group_typecasts</span><span class="p">,</span>
        <span class="n">group_tzcasts</span><span class="p">,</span>
        <span class="n">group_typed_literal</span><span class="p">,</span>
        <span class="n">group_operator</span><span class="p">,</span>
        <span class="n">group_comparison</span><span class="p">,</span>
        <span class="n">group_as</span><span class="p">,</span>
        <span class="n">group_aliased</span><span class="p">,</span>
        <span class="n">group_assignment</span><span class="p">,</span>
        <span class="n">align_comments</span><span class="p">,</span>
        <span class="n">group_identifier_list</span><span class="p">,</span>
        <span class="n">group_values</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">func</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">stmt</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">_group</span><span class="p">(</span>
    <span class="n">tlist</span><span class="p">,</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">match</span><span class="p">,</span>
    <span class="n">valid_prev</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">valid_next</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">post</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">extend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Groups together tokens that are joined by a middle token. i.e. x &lt; y&quot;&quot;&quot;</span>

    <span class="n">tidx_offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">pidx</span><span class="p">,</span> <span class="n">prev_</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tlist</span><span class="p">)):</span>
        <span class="n">tidx</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">-</span> <span class="n">tidx_offset</span>
        <span class="k">if</span> <span class="n">tidx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># tidx shouldn&#39;t get negative</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_whitespace</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">recurse</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">is_group</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="n">_group</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">valid_prev</span><span class="p">,</span> <span class="n">valid_next</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">extend</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
            <span class="n">nidx</span><span class="p">,</span> <span class="n">next_</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">token_next</span><span class="p">(</span><span class="n">tidx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prev_</span> <span class="ow">and</span> <span class="n">valid_prev</span><span class="p">(</span><span class="n">prev_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">valid_next</span><span class="p">(</span><span class="n">next_</span><span class="p">):</span>
                <span class="n">from_idx</span><span class="p">,</span> <span class="n">to_idx</span> <span class="o">=</span> <span class="n">post</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">nidx</span><span class="p">)</span>
                <span class="n">grp</span> <span class="o">=</span> <span class="n">tlist</span><span class="o">.</span><span class="n">group_tokens</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">from_idx</span><span class="p">,</span> <span class="n">to_idx</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">)</span>

                <span class="n">tidx_offset</span> <span class="o">+=</span> <span class="n">to_idx</span> <span class="o">-</span> <span class="n">from_idx</span>
                <span class="n">pidx</span><span class="p">,</span> <span class="n">prev_</span> <span class="o">=</span> <span class="n">from_idx</span><span class="p">,</span> <span class="n">grp</span>
                <span class="k">continue</span>

        <span class="n">pidx</span><span class="p">,</span> <span class="n">prev_</span> <span class="o">=</span> <span class="n">tidx</span><span class="p">,</span> <span class="n">token</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>