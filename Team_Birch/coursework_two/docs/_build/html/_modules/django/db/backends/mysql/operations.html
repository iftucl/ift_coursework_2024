

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>django.db.backends.mysql.operations &mdash; Coursework Two 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html" class="icon icon-home">
            Coursework Two
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../installation_guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../usage_instructions.html">Usage Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../architecture_overview.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Coursework Two</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../../../../django.html">django</a></li>
          <li class="breadcrumb-item"><a href="../../../db.html">django.db</a></li>
      <li class="breadcrumb-item active">django.db.backends.mysql.operations</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for django.db.backends.mysql.operations</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">django.conf</span><span class="w"> </span><span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.db.backends.base.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseDatabaseOperations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.db.backends.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">split_tzname_delta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.db.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Exists</span><span class="p">,</span> <span class="n">ExpressionWrapper</span><span class="p">,</span> <span class="n">Lookup</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.db.models.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">OnConflict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">timezone</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.utils.encoding</span><span class="w"> </span><span class="kn">import</span> <span class="n">force_str</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.utils.regex_helper</span><span class="w"> </span><span class="kn">import</span> <span class="n">_lazy_re_compile</span>


<div class="viewcode-block" id="DatabaseOperations">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DatabaseOperations</span><span class="p">(</span><span class="n">BaseDatabaseOperations</span><span class="p">):</span>
<div class="viewcode-block" id="DatabaseOperations.compiler_module">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.compiler_module">[docs]</a>
    <span class="n">compiler_module</span> <span class="o">=</span> <span class="s2">&quot;django.db.backends.mysql.compiler&quot;</span></div>


    <span class="c1"># MySQL stores positive fields as UNSIGNED ints.</span>
<div class="viewcode-block" id="DatabaseOperations.integer_field_ranges">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.integer_field_ranges">[docs]</a>
    <span class="n">integer_field_ranges</span> <span class="o">=</span> <span class="p">{</span>
        <span class="o">**</span><span class="n">BaseDatabaseOperations</span><span class="o">.</span><span class="n">integer_field_ranges</span><span class="p">,</span>
        <span class="s2">&quot;PositiveSmallIntegerField&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">65535</span><span class="p">),</span>
        <span class="s2">&quot;PositiveIntegerField&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4294967295</span><span class="p">),</span>
        <span class="s2">&quot;PositiveBigIntegerField&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">18446744073709551615</span><span class="p">),</span>
    <span class="p">}</span></div>

<div class="viewcode-block" id="DatabaseOperations.cast_data_types">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.cast_data_types">[docs]</a>
    <span class="n">cast_data_types</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;AutoField&quot;</span><span class="p">:</span> <span class="s2">&quot;signed integer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BigAutoField&quot;</span><span class="p">:</span> <span class="s2">&quot;signed integer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SmallAutoField&quot;</span><span class="p">:</span> <span class="s2">&quot;signed integer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CharField&quot;</span><span class="p">:</span> <span class="s2">&quot;char(</span><span class="si">%(max_length)s</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;DecimalField&quot;</span><span class="p">:</span> <span class="s2">&quot;decimal(</span><span class="si">%(max_digits)s</span><span class="s2">, </span><span class="si">%(decimal_places)s</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;TextField&quot;</span><span class="p">:</span> <span class="s2">&quot;char&quot;</span><span class="p">,</span>
        <span class="s2">&quot;IntegerField&quot;</span><span class="p">:</span> <span class="s2">&quot;signed integer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BigIntegerField&quot;</span><span class="p">:</span> <span class="s2">&quot;signed integer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SmallIntegerField&quot;</span><span class="p">:</span> <span class="s2">&quot;signed integer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PositiveBigIntegerField&quot;</span><span class="p">:</span> <span class="s2">&quot;unsigned integer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PositiveIntegerField&quot;</span><span class="p">:</span> <span class="s2">&quot;unsigned integer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PositiveSmallIntegerField&quot;</span><span class="p">:</span> <span class="s2">&quot;unsigned integer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;DurationField&quot;</span><span class="p">:</span> <span class="s2">&quot;signed integer&quot;</span><span class="p">,</span>
    <span class="p">}</span></div>

<div class="viewcode-block" id="DatabaseOperations.cast_char_field_without_max_length">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.cast_char_field_without_max_length">[docs]</a>
    <span class="n">cast_char_field_without_max_length</span> <span class="o">=</span> <span class="s2">&quot;char&quot;</span></div>

<div class="viewcode-block" id="DatabaseOperations.explain_prefix">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.explain_prefix">[docs]</a>
    <span class="n">explain_prefix</span> <span class="o">=</span> <span class="s2">&quot;EXPLAIN&quot;</span></div>


    <span class="c1"># EXTRACT format cannot be passed in parameters.</span>
    <span class="n">_extract_format_re</span> <span class="o">=</span> <span class="n">_lazy_re_compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[A-Z_]+&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="DatabaseOperations.date_extract_sql">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.date_extract_sql">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">date_extract_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lookup_type</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="c1"># https://dev.mysql.com/doc/mysql/en/date-and-time-functions.html</span>
        <span class="k">if</span> <span class="n">lookup_type</span> <span class="o">==</span> <span class="s2">&quot;week_day&quot;</span><span class="p">:</span>
            <span class="c1"># DAYOFWEEK() returns an integer, 1-7, Sunday=1.</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;DAYOFWEEK(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">params</span>
        <span class="k">elif</span> <span class="n">lookup_type</span> <span class="o">==</span> <span class="s2">&quot;iso_week_day&quot;</span><span class="p">:</span>
            <span class="c1"># WEEKDAY() returns an integer, 0-6, Monday=0.</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;WEEKDAY(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">) + 1&quot;</span><span class="p">,</span> <span class="n">params</span>
        <span class="k">elif</span> <span class="n">lookup_type</span> <span class="o">==</span> <span class="s2">&quot;week&quot;</span><span class="p">:</span>
            <span class="c1"># Override the value of default_week_format for consistency with</span>
            <span class="c1"># other database backends.</span>
            <span class="c1"># Mode 3: Monday, 1-53, with 4 or more days this year.</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;WEEK(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">, 3)&quot;</span><span class="p">,</span> <span class="n">params</span>
        <span class="k">elif</span> <span class="n">lookup_type</span> <span class="o">==</span> <span class="s2">&quot;iso_year&quot;</span><span class="p">:</span>
            <span class="c1"># Get the year part from the YEARWEEK function, which returns a</span>
            <span class="c1"># number as year * 100 + week.</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;TRUNCATE(YEARWEEK(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">, 3), -2) / 100&quot;</span><span class="p">,</span> <span class="n">params</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># EXTRACT returns 1-53 based on ISO-8601 for the week number.</span>
            <span class="n">lookup_type</span> <span class="o">=</span> <span class="n">lookup_type</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_format_re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">lookup_type</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid loookup type: </span><span class="si">{</span><span class="n">lookup_type</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;EXTRACT(</span><span class="si">{</span><span class="n">lookup_type</span><span class="si">}</span><span class="s2"> FROM </span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">params</span></div>


<div class="viewcode-block" id="DatabaseOperations.date_trunc_sql">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.date_trunc_sql">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">date_trunc_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lookup_type</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">sql</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_sql_to_tz</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="p">)</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;%Y-01-01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;%Y-%m-01&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">lookup_type</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="n">format_str</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">lookup_type</span><span class="p">]</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;CAST(DATE_FORMAT(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">, %s) AS DATE)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="n">format_str</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">lookup_type</span> <span class="o">==</span> <span class="s2">&quot;quarter&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;MAKEDATE(YEAR(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">), 1) + &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;INTERVAL QUARTER(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">) QUARTER - INTERVAL 1 QUARTER&quot;</span><span class="p">,</span>
                <span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">lookup_type</span> <span class="o">==</span> <span class="s2">&quot;week&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;DATE_SUB(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">, INTERVAL WEEKDAY(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">) DAY)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;DATE(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">params</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_tzname_delta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tzname</span><span class="p">):</span>
        <span class="n">tzname</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">split_tzname_delta</span><span class="p">(</span><span class="n">tzname</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sign</span><span class="si">}{</span><span class="n">offset</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">offset</span> <span class="k">else</span> <span class="n">tzname</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_sql_to_tz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">tzname</span> <span class="ow">and</span> <span class="n">settings</span><span class="o">.</span><span class="n">USE_TZ</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">timezone_name</span> <span class="o">!=</span> <span class="n">tzname</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;CONVERT_TZ(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">, %s, %s)&quot;</span><span class="p">,</span> <span class="p">(</span>
                <span class="o">*</span><span class="n">params</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">timezone_name</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_tzname_delta</span><span class="p">(</span><span class="n">tzname</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span>

<div class="viewcode-block" id="DatabaseOperations.datetime_cast_date_sql">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.datetime_cast_date_sql">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">datetime_cast_date_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="p">):</span>
        <span class="n">sql</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_sql_to_tz</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;DATE(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">params</span></div>


<div class="viewcode-block" id="DatabaseOperations.datetime_cast_time_sql">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.datetime_cast_time_sql">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">datetime_cast_time_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="p">):</span>
        <span class="n">sql</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_sql_to_tz</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;TIME(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">params</span></div>


<div class="viewcode-block" id="DatabaseOperations.datetime_extract_sql">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.datetime_extract_sql">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">datetime_extract_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lookup_type</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="p">):</span>
        <span class="n">sql</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_sql_to_tz</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_extract_sql</span><span class="p">(</span><span class="n">lookup_type</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>


<div class="viewcode-block" id="DatabaseOperations.datetime_trunc_sql">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.datetime_trunc_sql">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">datetime_trunc_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lookup_type</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="p">):</span>
        <span class="n">sql</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_sql_to_tz</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="p">)</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="s2">&quot;hour&quot;</span><span class="p">,</span> <span class="s2">&quot;minute&quot;</span><span class="p">,</span> <span class="s2">&quot;second&quot;</span><span class="p">]</span>
        <span class="nb">format</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;%Y-&quot;</span><span class="p">,</span> <span class="s2">&quot;%m&quot;</span><span class="p">,</span> <span class="s2">&quot;-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; %H:&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;:</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">format_def</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;0000-&quot;</span><span class="p">,</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;-01&quot;</span><span class="p">,</span> <span class="s2">&quot; 00:&quot;</span><span class="p">,</span> <span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="s2">&quot;:00&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lookup_type</span> <span class="o">==</span> <span class="s2">&quot;quarter&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;CAST(DATE_FORMAT(MAKEDATE(YEAR(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">), 1) + &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;INTERVAL QUARTER(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">) QUARTER - &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;INTERVAL 1 QUARTER, %s) AS DATETIME)&quot;</span>
            <span class="p">),</span> <span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-01 00:00:00&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lookup_type</span> <span class="o">==</span> <span class="s2">&quot;week&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;CAST(DATE_FORMAT(&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;DATE_SUB(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">, INTERVAL WEEKDAY(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">) DAY), %s) AS DATETIME)&quot;</span>
            <span class="p">),</span> <span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> 00:00:00&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">lookup_type</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">format_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">format</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">format_def</span><span class="p">[</span><span class="n">i</span><span class="p">:])</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;CAST(DATE_FORMAT(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">, %s) AS DATETIME)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="n">format_str</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span></div>


<div class="viewcode-block" id="DatabaseOperations.time_trunc_sql">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.time_trunc_sql">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">time_trunc_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lookup_type</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">sql</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_sql_to_tz</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tzname</span><span class="p">)</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;hour&quot;</span><span class="p">:</span> <span class="s2">&quot;%H:00:00&quot;</span><span class="p">,</span>
            <span class="s2">&quot;minute&quot;</span><span class="p">:</span> <span class="s2">&quot;%H:</span><span class="si">%i</span><span class="s2">:00&quot;</span><span class="p">,</span>
            <span class="s2">&quot;second&quot;</span><span class="p">:</span> <span class="s2">&quot;%H:</span><span class="si">%i</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">lookup_type</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="n">format_str</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">lookup_type</span><span class="p">]</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;CAST(DATE_FORMAT(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">, %s) AS TIME)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="n">format_str</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;TIME(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">params</span></div>


<div class="viewcode-block" id="DatabaseOperations.fetch_returned_insert_rows">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.fetch_returned_insert_rows">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fetch_returned_insert_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cursor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a cursor object that has just performed an INSERT...RETURNING</span>
<span class="sd">        statement into a table, return the tuple of returned data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span></div>


<div class="viewcode-block" id="DatabaseOperations.format_for_duration_arithmetic">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.format_for_duration_arithmetic">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">format_for_duration_arithmetic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;INTERVAL </span><span class="si">%s</span><span class="s2"> MICROSECOND&quot;</span> <span class="o">%</span> <span class="n">sql</span></div>


<div class="viewcode-block" id="DatabaseOperations.force_no_ordering">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.force_no_ordering">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">force_no_ordering</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;ORDER BY NULL&quot; prevents MySQL from implicitly ordering by grouped</span>
<span class="sd">        columns. If no ordering would otherwise be applied, we don&#39;t want any</span>
<span class="sd">        implicit sorting going on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;NULL&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="kc">False</span><span class="p">))]</span></div>


<div class="viewcode-block" id="DatabaseOperations.adapt_decimalfield_value">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.adapt_decimalfield_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">adapt_decimalfield_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">max_digits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="DatabaseOperations.last_executed_query">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.last_executed_query">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">last_executed_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="c1"># With MySQLdb, cursor objects have an (undocumented) &quot;_executed&quot;</span>
        <span class="c1"># attribute where the exact query sent to the database is saved.</span>
        <span class="c1"># See MySQLdb/cursors.py in the source distribution.</span>
        <span class="c1"># MySQLdb returns string, PyMySQL bytes.</span>
        <span class="k">return</span> <span class="n">force_str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s2">&quot;_executed&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DatabaseOperations.no_limit_value">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.no_limit_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">no_limit_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># 2**64 - 1, as recommended by the MySQL documentation</span>
        <span class="k">return</span> <span class="mi">18446744073709551615</span></div>


<div class="viewcode-block" id="DatabaseOperations.quote_name">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.quote_name">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">quote_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;`&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;`&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">name</span>  <span class="c1"># Quoting once is enough.</span>
        <span class="k">return</span> <span class="s2">&quot;`</span><span class="si">%s</span><span class="s2">`&quot;</span> <span class="o">%</span> <span class="n">name</span></div>


<div class="viewcode-block" id="DatabaseOperations.return_insert_columns">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.return_insert_columns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">return_insert_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">):</span>
        <span class="c1"># MySQL and MariaDB &lt; 10.5.0 don&#39;t support an INSERT...RETURNING</span>
        <span class="c1"># statement.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fields</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="p">()</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">quote_name</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">db_table</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">quote_name</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">column</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;RETURNING </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">columns</span><span class="p">),</span> <span class="p">()</span></div>


<div class="viewcode-block" id="DatabaseOperations.sql_flush">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.sql_flush">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">sql_flush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">tables</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">reset_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_cascade</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tables</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">sql</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SET FOREIGN_KEY_CHECKS = 0;&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">reset_sequences</span><span class="p">:</span>
            <span class="c1"># It&#39;s faster to TRUNCATE tables that require a sequence reset</span>
            <span class="c1"># since ALTER TABLE AUTO_INCREMENT is slower than TRUNCATE.</span>
            <span class="n">sql</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">;&quot;</span>
                <span class="o">%</span> <span class="p">(</span>
                    <span class="n">style</span><span class="o">.</span><span class="n">SQL_KEYWORD</span><span class="p">(</span><span class="s2">&quot;TRUNCATE&quot;</span><span class="p">),</span>
                    <span class="n">style</span><span class="o">.</span><span class="n">SQL_FIELD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quote_name</span><span class="p">(</span><span class="n">table_name</span><span class="p">)),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">tables</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Otherwise issue a simple DELETE since it&#39;s faster than TRUNCATE</span>
            <span class="c1"># and preserves sequences.</span>
            <span class="n">sql</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">;&quot;</span>
                <span class="o">%</span> <span class="p">(</span>
                    <span class="n">style</span><span class="o">.</span><span class="n">SQL_KEYWORD</span><span class="p">(</span><span class="s2">&quot;DELETE&quot;</span><span class="p">),</span>
                    <span class="n">style</span><span class="o">.</span><span class="n">SQL_KEYWORD</span><span class="p">(</span><span class="s2">&quot;FROM&quot;</span><span class="p">),</span>
                    <span class="n">style</span><span class="o">.</span><span class="n">SQL_FIELD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quote_name</span><span class="p">(</span><span class="n">table_name</span><span class="p">)),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">tables</span>
            <span class="p">)</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;SET FOREIGN_KEY_CHECKS = 1;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sql</span></div>


<div class="viewcode-block" id="DatabaseOperations.sequence_reset_by_name_sql">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.sequence_reset_by_name_sql">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">sequence_reset_by_name_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">sequences</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> = 1;&quot;</span>
            <span class="o">%</span> <span class="p">(</span>
                <span class="n">style</span><span class="o">.</span><span class="n">SQL_KEYWORD</span><span class="p">(</span><span class="s2">&quot;ALTER&quot;</span><span class="p">),</span>
                <span class="n">style</span><span class="o">.</span><span class="n">SQL_KEYWORD</span><span class="p">(</span><span class="s2">&quot;TABLE&quot;</span><span class="p">),</span>
                <span class="n">style</span><span class="o">.</span><span class="n">SQL_FIELD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quote_name</span><span class="p">(</span><span class="n">sequence_info</span><span class="p">[</span><span class="s2">&quot;table&quot;</span><span class="p">])),</span>
                <span class="n">style</span><span class="o">.</span><span class="n">SQL_FIELD</span><span class="p">(</span><span class="s2">&quot;AUTO_INCREMENT&quot;</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">sequence_info</span> <span class="ow">in</span> <span class="n">sequences</span>
        <span class="p">]</span></div>


<div class="viewcode-block" id="DatabaseOperations.validate_autopk_value">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.validate_autopk_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_autopk_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c1"># Zero in AUTO_INCREMENT field does not work without the</span>
        <span class="c1"># NO_AUTO_VALUE_ON_ZERO SQL mode.</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">allows_auto_pk_0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The database backend does not accept 0 as a value for AutoField.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="DatabaseOperations.adapt_datetimefield_value">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.adapt_datetimefield_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">adapt_datetimefield_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Expression values are adapted by the database.</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;resolve_expression&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="c1"># MySQL doesn&#39;t support tz-aware datetimes</span>
        <span class="k">if</span> <span class="n">timezone</span><span class="o">.</span><span class="n">is_aware</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">USE_TZ</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">make_naive</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">timezone</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;MySQL backend does not support timezone-aware datetimes when &quot;</span>
                    <span class="s2">&quot;USE_TZ is False.&quot;</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="DatabaseOperations.adapt_timefield_value">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.adapt_timefield_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">adapt_timefield_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Expression values are adapted by the database.</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;resolve_expression&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="c1"># MySQL doesn&#39;t support tz-aware times</span>
        <span class="k">if</span> <span class="n">timezone</span><span class="o">.</span><span class="n">is_aware</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;MySQL backend does not support timezone-aware times.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(</span><span class="n">timespec</span><span class="o">=</span><span class="s2">&quot;microseconds&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DatabaseOperations.max_name_length">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.max_name_length">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">max_name_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">64</span></div>


<div class="viewcode-block" id="DatabaseOperations.pk_default_value">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.pk_default_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pk_default_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;NULL&quot;</span></div>


<div class="viewcode-block" id="DatabaseOperations.bulk_insert_sql">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.bulk_insert_sql">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">bulk_insert_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">placeholder_rows</span><span class="p">):</span>
        <span class="n">placeholder_rows_sql</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">placeholder_rows</span><span class="p">)</span>
        <span class="n">values_sql</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">sql</span> <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">placeholder_rows_sql</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;VALUES &quot;</span> <span class="o">+</span> <span class="n">values_sql</span></div>


<div class="viewcode-block" id="DatabaseOperations.combine_expression">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.combine_expression">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">combine_expression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connector</span><span class="p">,</span> <span class="n">sub_expressions</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">connector</span> <span class="o">==</span> <span class="s2">&quot;^&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;POW(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_expressions</span><span class="p">)</span>
        <span class="c1"># Convert the result to a signed integer since MySQL&#39;s binary operators</span>
        <span class="c1"># return an unsigned integer.</span>
        <span class="k">elif</span> <span class="n">connector</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;#&quot;</span><span class="p">):</span>
            <span class="n">connector</span> <span class="o">=</span> <span class="s2">&quot;^&quot;</span> <span class="k">if</span> <span class="n">connector</span> <span class="o">==</span> <span class="s2">&quot;#&quot;</span> <span class="k">else</span> <span class="n">connector</span>
            <span class="k">return</span> <span class="s2">&quot;CONVERT(</span><span class="si">%s</span><span class="s2">, SIGNED)&quot;</span> <span class="o">%</span> <span class="n">connector</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_expressions</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">connector</span> <span class="o">==</span> <span class="s2">&quot;&gt;&gt;&quot;</span><span class="p">:</span>
            <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">sub_expressions</span>
            <span class="k">return</span> <span class="s2">&quot;FLOOR(</span><span class="si">%(lhs)s</span><span class="s2"> / POW(2, </span><span class="si">%(rhs)s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">{</span><span class="s2">&quot;lhs&quot;</span><span class="p">:</span> <span class="n">lhs</span><span class="p">,</span> <span class="s2">&quot;rhs&quot;</span><span class="p">:</span> <span class="n">rhs</span><span class="p">}</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">combine_expression</span><span class="p">(</span><span class="n">connector</span><span class="p">,</span> <span class="n">sub_expressions</span><span class="p">)</span></div>


<div class="viewcode-block" id="DatabaseOperations.get_db_converters">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.get_db_converters">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_db_converters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">):</span>
        <span class="n">converters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_db_converters</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
        <span class="n">internal_type</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">output_field</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s2">&quot;BooleanField&quot;</span><span class="p">:</span>
            <span class="n">converters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_booleanfield_value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s2">&quot;DateTimeField&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">USE_TZ</span><span class="p">:</span>
                <span class="n">converters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_datetimefield_value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s2">&quot;UUIDField&quot;</span><span class="p">:</span>
            <span class="n">converters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_uuidfield_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">converters</span></div>


<div class="viewcode-block" id="DatabaseOperations.convert_booleanfield_value">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.convert_booleanfield_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">convert_booleanfield_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="DatabaseOperations.convert_datetimefield_value">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.convert_datetimefield_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">convert_datetimefield_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">make_aware</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">timezone</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="DatabaseOperations.convert_uuidfield_value">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.convert_uuidfield_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">convert_uuidfield_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="DatabaseOperations.binary_placeholder_sql">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.binary_placeholder_sql">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">binary_placeholder_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="s2">&quot;_binary </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;as_sql&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DatabaseOperations.subtract_temporals">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.subtract_temporals">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">subtract_temporals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">internal_type</span><span class="p">,</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="n">lhs_sql</span><span class="p">,</span> <span class="n">lhs_params</span> <span class="o">=</span> <span class="n">lhs</span>
        <span class="n">rhs_sql</span><span class="p">,</span> <span class="n">rhs_params</span> <span class="o">=</span> <span class="n">rhs</span>
        <span class="k">if</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s2">&quot;TimeField&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">mysql_is_mariadb</span><span class="p">:</span>
                <span class="c1"># MariaDB includes the microsecond component in TIME_TO_SEC as</span>
                <span class="c1"># a decimal. MySQL returns an integer without microseconds.</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="s2">&quot;CAST((TIME_TO_SEC(</span><span class="si">%(lhs)s</span><span class="s2">) - TIME_TO_SEC(</span><span class="si">%(rhs)s</span><span class="s2">)) &quot;</span>
                    <span class="s2">&quot;* 1000000 AS SIGNED)&quot;</span>
                <span class="p">)</span> <span class="o">%</span> <span class="p">{</span>
                    <span class="s2">&quot;lhs&quot;</span><span class="p">:</span> <span class="n">lhs_sql</span><span class="p">,</span>
                    <span class="s2">&quot;rhs&quot;</span><span class="p">:</span> <span class="n">rhs_sql</span><span class="p">,</span>
                <span class="p">},</span> <span class="p">(</span>
                    <span class="o">*</span><span class="n">lhs_params</span><span class="p">,</span>
                    <span class="o">*</span><span class="n">rhs_params</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="s2">&quot;((TIME_TO_SEC(</span><span class="si">%(lhs)s</span><span class="s2">) * 1000000 + MICROSECOND(</span><span class="si">%(lhs)s</span><span class="s2">)) -&quot;</span>
                <span class="s2">&quot; (TIME_TO_SEC(</span><span class="si">%(rhs)s</span><span class="s2">) * 1000000 + MICROSECOND(</span><span class="si">%(rhs)s</span><span class="s2">)))&quot;</span>
            <span class="p">)</span> <span class="o">%</span> <span class="p">{</span><span class="s2">&quot;lhs&quot;</span><span class="p">:</span> <span class="n">lhs_sql</span><span class="p">,</span> <span class="s2">&quot;rhs&quot;</span><span class="p">:</span> <span class="n">rhs_sql</span><span class="p">},</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">lhs_params</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">rhs_params</span>
            <span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">rhs_params</span><span class="p">,</span> <span class="o">*</span><span class="n">lhs_params</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;TIMESTAMPDIFF(MICROSECOND, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rhs_sql</span><span class="p">,</span> <span class="n">lhs_sql</span><span class="p">),</span> <span class="n">params</span></div>


<div class="viewcode-block" id="DatabaseOperations.explain_query_prefix">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.explain_query_prefix">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">explain_query_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
        <span class="c1"># Alias MySQL&#39;s TRADITIONAL to TEXT for consistency with other backends.</span>
        <span class="k">if</span> <span class="nb">format</span> <span class="ow">and</span> <span class="nb">format</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">:</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;TRADITIONAL&quot;</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="nb">format</span> <span class="ow">and</span> <span class="s2">&quot;TREE&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">supported_explain_formats</span>
        <span class="p">):</span>
            <span class="c1"># Use TREE by default (if supported) as it&#39;s more informative.</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;TREE&quot;</span>
        <span class="n">analyze</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;analyze&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">explain_query_prefix</span><span class="p">(</span><span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">analyze</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">supports_explain_analyze</span><span class="p">:</span>
            <span class="c1"># MariaDB uses ANALYZE instead of EXPLAIN ANALYZE.</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;ANALYZE&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">mysql_is_mariadb</span> <span class="k">else</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot; ANALYZE&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">format</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">analyze</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">mysql_is_mariadb</span><span class="p">):</span>
            <span class="c1"># Only MariaDB supports the analyze option with formats.</span>
            <span class="n">prefix</span> <span class="o">+=</span> <span class="s2">&quot; FORMAT=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">format</span>
        <span class="k">return</span> <span class="n">prefix</span></div>


<div class="viewcode-block" id="DatabaseOperations.regex_lookup">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.regex_lookup">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">regex_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lookup_type</span><span class="p">):</span>
        <span class="c1"># REGEXP_LIKE doesn&#39;t exist in MariaDB.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">mysql_is_mariadb</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">lookup_type</span> <span class="o">==</span> <span class="s2">&quot;regex&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> REGEXP BINARY </span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> REGEXP </span><span class="si">%s</span><span class="s2">&quot;</span>

        <span class="n">match_option</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span> <span class="k">if</span> <span class="n">lookup_type</span> <span class="o">==</span> <span class="s2">&quot;regex&quot;</span> <span class="k">else</span> <span class="s2">&quot;i&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;REGEXP_LIKE(</span><span class="si">%%</span><span class="s2">s, </span><span class="si">%%</span><span class="s2">s, &#39;</span><span class="si">%s</span><span class="s2">&#39;)&quot;</span> <span class="o">%</span> <span class="n">match_option</span></div>


<div class="viewcode-block" id="DatabaseOperations.insert_statement">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.insert_statement">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">insert_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_conflict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">on_conflict</span> <span class="o">==</span> <span class="n">OnConflict</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;INSERT IGNORE INTO&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">insert_statement</span><span class="p">(</span><span class="n">on_conflict</span><span class="o">=</span><span class="n">on_conflict</span><span class="p">)</span></div>


<div class="viewcode-block" id="DatabaseOperations.lookup_cast">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.lookup_cast">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">lookup_cast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lookup_type</span><span class="p">,</span> <span class="n">internal_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">lookup</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s2">&quot;JSONField&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">mysql_is_mariadb</span> <span class="ow">or</span> <span class="n">lookup_type</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="s2">&quot;iexact&quot;</span><span class="p">,</span>
                <span class="s2">&quot;contains&quot;</span><span class="p">,</span>
                <span class="s2">&quot;icontains&quot;</span><span class="p">,</span>
                <span class="s2">&quot;startswith&quot;</span><span class="p">,</span>
                <span class="s2">&quot;istartswith&quot;</span><span class="p">,</span>
                <span class="s2">&quot;endswith&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iendswith&quot;</span><span class="p">,</span>
                <span class="s2">&quot;regex&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iregex&quot;</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="n">lookup</span> <span class="o">=</span> <span class="s2">&quot;JSON_UNQUOTE(</span><span class="si">%s</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="n">lookup</span></div>


<div class="viewcode-block" id="DatabaseOperations.conditional_expression_supported_in_where_clause">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.conditional_expression_supported_in_where_clause">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">conditional_expression_supported_in_where_clause</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">):</span>
        <span class="c1"># MySQL ignores indexes with boolean fields unless they&#39;re compared</span>
        <span class="c1"># directly to a boolean value.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="p">(</span><span class="n">Exists</span><span class="p">,</span> <span class="n">Lookup</span><span class="p">)):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">ExpressionWrapper</span><span class="p">)</span> <span class="ow">and</span> <span class="n">expression</span><span class="o">.</span><span class="n">conditional</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditional_expression_supported_in_where_clause</span><span class="p">(</span>
                <span class="n">expression</span><span class="o">.</span><span class="n">expression</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="s2">&quot;conditional&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">conditional_expression_supported_in_where_clause</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span></div>


<div class="viewcode-block" id="DatabaseOperations.on_conflict_suffix_sql">
<a class="viewcode-back" href="../../../../../autoapi/django/db/backends/mysql/operations/index.html#django.db.backends.mysql.operations.DatabaseOperations.on_conflict_suffix_sql">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_conflict_suffix_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">on_conflict</span><span class="p">,</span> <span class="n">update_fields</span><span class="p">,</span> <span class="n">unique_fields</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">on_conflict</span> <span class="o">==</span> <span class="n">OnConflict</span><span class="o">.</span><span class="n">UPDATE</span><span class="p">:</span>
            <span class="n">conflict_suffix_sql</span> <span class="o">=</span> <span class="s2">&quot;ON DUPLICATE KEY UPDATE </span><span class="si">%(fields)s</span><span class="s2">&quot;</span>
            <span class="c1"># The use of VALUES() is deprecated in MySQL 8.0.20+. Instead, use</span>
            <span class="c1"># aliases for the new row and its columns available in MySQL</span>
            <span class="c1"># 8.0.19+.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">mysql_is_mariadb</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">mysql_version</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">):</span>
                    <span class="n">conflict_suffix_sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;AS new </span><span class="si">{</span><span class="n">conflict_suffix_sql</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="n">field_sql</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(field)s</span><span class="s2"> = new.</span><span class="si">%(field)s</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">field_sql</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(field)s</span><span class="s2"> = VALUES(</span><span class="si">%(field)s</span><span class="s2">)&quot;</span>
            <span class="c1"># Use VALUE() on MariaDB.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">field_sql</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(field)s</span><span class="s2"> = VALUE(</span><span class="si">%(field)s</span><span class="s2">)&quot;</span>

            <span class="n">fields</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">field_sql</span> <span class="o">%</span> <span class="p">{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">field</span><span class="p">}</span>
                    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quote_name</span><span class="p">,</span> <span class="n">update_fields</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">conflict_suffix_sql</span> <span class="o">%</span> <span class="p">{</span><span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">}</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">on_conflict_suffix_sql</span><span class="p">(</span>
            <span class="n">fields</span><span class="p">,</span>
            <span class="n">on_conflict</span><span class="p">,</span>
            <span class="n">update_fields</span><span class="p">,</span>
            <span class="n">unique_fields</span><span class="p">,</span>
        <span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>