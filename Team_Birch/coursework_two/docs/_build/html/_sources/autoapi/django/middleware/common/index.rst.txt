django.middleware.common
========================

.. py:module:: django.middleware.common


Classes
-------

.. autoapisummary::

   django.middleware.common.CommonMiddleware
   django.middleware.common.BrokenLinkEmailsMiddleware


Module Contents
---------------

.. py:class:: CommonMiddleware

   Bases: :py:obj:`django.utils.deprecation.MiddlewareMixin`


   "Common" middleware for taking care of some basic operations:

       - Forbid access to User-Agents in settings.DISALLOWED_USER_AGENTS

       - URL rewriting: Based on the APPEND_SLASH and PREPEND_WWW settings,
         append missing slashes and/or prepends missing "www."s.

           - If APPEND_SLASH is set and the initial URL doesn't end with a
             slash, and it is not found in urlpatterns, form a new URL by
             appending a slash at the end. If this new URL is found in
             urlpatterns, return an HTTP redirect to this new URL; otherwise
             process the initial URL as usual.

         This behavior can be customized by subclassing CommonMiddleware and
         overriding the response_redirect_class attribute.


   .. py:attribute:: response_redirect_class


   .. py:method:: process_request(request)

      Check for denied User-Agents and rewrite the URL based on
      settings.APPEND_SLASH and settings.PREPEND_WWW



   .. py:method:: should_redirect_with_slash(request)

      Return True if settings.APPEND_SLASH is True and appending a slash to
      the request path turns an invalid path into a valid one.



   .. py:method:: get_full_path_with_slash(request)

      Return the full path of the request with a trailing slash appended.

      Raise a RuntimeError if settings.DEBUG is True and request.method is
      POST, PUT, or PATCH.



   .. py:method:: process_response(request, response)

      When the status code of the response is 404, it may redirect to a path
      with an appended slash if should_redirect_with_slash() returns True.



.. py:class:: BrokenLinkEmailsMiddleware

   Bases: :py:obj:`django.utils.deprecation.MiddlewareMixin`


   .. py:method:: process_response(request, response)

      Send broken link emails for relevant 404 NOT FOUND responses.



   .. py:method:: is_internal_request(domain, referer)

      Return True if the referring URL is the same domain as the current
      request.



   .. py:method:: is_ignorable_request(request, uri, domain, referer)

      Return True if the given request *shouldn't* notify the site managers
      according to project settings or in situations outlined by the inline
      comments.



