

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>coursework_two.data_pipeline package &mdash; Team Adansonia  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="coursework_two.fast_api package" href="coursework_two.fast_api.html" />
    <link rel="prev" title="coursework_two package" href="coursework_two.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Team Adansonia
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">coursework_two</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="coursework_two.html">coursework_two package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="coursework_two.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">coursework_two.data_pipeline package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coursework_two.fast_api.html">coursework_two.fast_api package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coursework_two.frontend.html">coursework_two.frontend package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coursework_two.mongo_db.html">coursework_two.mongo_db package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coursework_two.utils.html">coursework_two.utils package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coursework_two.validation.html">coursework_two.validation package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="coursework_two.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="coursework_two.html#module-coursework_two.main">coursework_two.main module</a></li>
<li class="toctree-l3"><a class="reference internal" href="coursework_two.html#module-coursework_two">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Team Adansonia</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">coursework_two</a></li>
          <li class="breadcrumb-item"><a href="coursework_two.html">coursework_two package</a></li>
      <li class="breadcrumb-item active">coursework_two.data_pipeline package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/coursework_two.data_pipeline.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="coursework-two-data-pipeline-package">
<h1>coursework_two.data_pipeline package<a class="headerlink" href="#coursework-two-data-pipeline-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-coursework_two.data_pipeline.csr_utils">
<span id="coursework-two-data-pipeline-csr-utils-module"></span><h2>coursework_two.data_pipeline.csr_utils module<a class="headerlink" href="#module-coursework_two.data_pipeline.csr_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.csr_utils.connect_to_mongo">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.csr_utils.</span></span><span class="sig-name descname"><span class="pre">connect_to_mongo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/csr_utils.html#connect_to_mongo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.csr_utils.connect_to_mongo" title="Link to this definition"></a></dt>
<dd><p>Establishes a connection to the local MongoDB server.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A MongoClient instance if successful, otherwise None.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>MongoClient or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.csr_utils.download_pdf">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.csr_utils.</span></span><span class="sig-name descname"><span class="pre">download_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">BytesIO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/coursework_two/data_pipeline/csr_utils.html#download_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.csr_utils.download_pdf" title="Link to this definition"></a></dt>
<dd><p>Downloads a PDF from a given URL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>url</strong> (<em>str</em>) – The URL of the PDF file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A stream of the downloaded PDF content, or None if download failed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>BytesIO or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.csr_utils.filter_pdf_pages">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.csr_utils.</span></span><span class="sig-name descname"><span class="pre">filter_pdf_pages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BytesIO</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">BytesIO</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/coursework_two/data_pipeline/csr_utils.html#filter_pdf_pages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.csr_utils.filter_pdf_pages" title="Link to this definition"></a></dt>
<dd><p>Filters relevant pages from the PDF that contain ESG-related keywords and time series data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pdf_data</strong> (<em>BytesIO</em>) – The original PDF content.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>The filtered PDF content as a BytesIO object.</p></li>
<li><p>Extracted relevant text as a lowercase string.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[BytesIO, str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.csr_utils.get_company_data_by_symbol">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.csr_utils.</span></span><span class="sig-name descname"><span class="pre">get_company_data_by_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/csr_utils.html#get_company_data_by_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.csr_utils.get_company_data_by_symbol" title="Link to this definition"></a></dt>
<dd><p>Retrieves company data from the MongoDB database using the company’s stock symbol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symbol</strong> (<em>str</em>) – The stock symbol of the company.</p></li>
<li><p><strong>db</strong> (<em>Database</em>) – The MongoDB database instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The company’s data if found, otherwise None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.csr_utils.get_latest_report_url">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.csr_utils.</span></span><span class="sig-name descname"><span class="pre">get_latest_report_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csr_reports</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/csr_utils.html#get_latest_report_url"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.csr_utils.get_latest_report_url" title="Link to this definition"></a></dt>
<dd><p>Retrieves a specific or the most recent CSR report URL from the company’s CSR report metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>csr_reports</strong> (<em>dict</em>) – A dictionary mapping years to CSR report URLs.</p></li>
<li><p><strong>year</strong> (<em>int</em><em>, </em><em>optional</em>) – The specific year to retrieve the report for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The URL of the CSR report for the given year, or the most recent one available.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.csr_utils.get_latest_report_year">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.csr_utils.</span></span><span class="sig-name descname"><span class="pre">get_latest_report_year</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csr_reports</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/csr_utils.html#get_latest_report_year"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.csr_utils.get_latest_report_year" title="Link to this definition"></a></dt>
<dd><p>Retrieves the most recent CSR report year key that has a non-empty, non-null URL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>csr_reports</strong> (<em>dict</em>) – A dictionary mapping years to CSR report URLs.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The latest year with a valid report URL, or None if not found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.csr_utils.process_csr_report">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.csr_utils.</span></span><span class="sig-name descname"><span class="pre">process_csr_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">company_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/csr_utils.html#process_csr_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.csr_utils.process_csr_report" title="Link to this definition"></a></dt>
<dd><p>Downloads and filters the latest CSR report for a company.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>company_data</strong> (<em>dict</em>) – A dictionary containing company information and CSR report URLs.</p></li>
<li><p><strong>year</strong> (<em>str</em><em>, </em><em>optional</em>) – The specific year to retrieve the report for. If None, the most recent report is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The filtered PDF and extracted text, or (None, None) if no relevant content is found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[BytesIO, str] or (None, None)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.csr_utils.run_end_to_end_workflow">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.csr_utils.</span></span><span class="sig-name descname"><span class="pre">run_end_to_end_workflow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">company_symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">company_security</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/csr_utils.html#run_end_to_end_workflow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.csr_utils.run_end_to_end_workflow" title="Link to this definition"></a></dt>
<dd><p>Runs the end-to-end ESG extraction and validation workflow for a given company symbol and security.
This includes fetching the company’s CSR report, extracting ESG data using LlamaExtractor,
and validating the data using internal checks and OpenAI. It also extracts the company’s ESG goals.</p>
<p>Parameters:
- company_symbol (str): The stock symbol of the company.
- company_security (str): The security identifier of the company.
- db: MongoDB database connection.</p>
<p>Returns:
- final_data (dict): Validated and cleaned ESG data.
- goals (dict): Extracted ESG goals for the company.</p>
</dd></dl>

</section>
<section id="module-coursework_two.data_pipeline.goals_extractor">
<span id="coursework-two-data-pipeline-goals-extractor-module"></span><h2>coursework_two.data_pipeline.goals_extractor module<a class="headerlink" href="#module-coursework_two.data_pipeline.goals_extractor" title="Link to this heading"></a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.goals_extractor.DEEPSEEK_API_KEY">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.goals_extractor.</span></span><span class="sig-name descname"><span class="pre">DEEPSEEK_API_KEY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sk-6a3e1987f13b46a58eebd62bb90c3584'</span></em><a class="headerlink" href="#coursework_two.data_pipeline.goals_extractor.DEEPSEEK_API_KEY" title="Link to this definition"></a></dt>
<dd><p>This module provides tools to extract emissions and sustainability goal information
from corporate PDF reports using PyPDF2 and DeepSeek language models.</p>
<p>Functions include:
- Extracting emissions and goals data by page or paragraph
- Formatting emissions data units
- Summarizing goals and emissions via DeepSeek API</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.goals_extractor.call_deepseek_find_goals">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.goals_extractor.</span></span><span class="sig-name descname"><span class="pre">call_deepseek_find_goals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">company_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/goals_extractor.html#call_deepseek_find_goals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.goals_extractor.call_deepseek_find_goals" title="Link to this definition"></a></dt>
<dd><p>Uses DeepSeek LLM to summarize emissions reduction targets from PDF content.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>company_name</strong> (<em>str</em>) – Name of the company.</p></li>
<li><p><strong>pdf_text</strong> (<em>str</em>) – Relevant text extracted from PDF.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Summary of emissions goals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.goals_extractor.data_formatting">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.goals_extractor.</span></span><span class="sig-name descname"><span class="pre">data_formatting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/goals_extractor.html#data_formatting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.goals_extractor.data_formatting" title="Link to this definition"></a></dt>
<dd><p>Converts textual emission data to a standardized numeric format with proper unit conversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>re.Match</em>) – Regex match group containing numeric and unit data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted emission value in metric tonnes as string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.goals_extractor.extract_emissions_data_by_page">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.goals_extractor.</span></span><span class="sig-name descname"><span class="pre">extract_emissions_data_by_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/goals_extractor.html#extract_emissions_data_by_page"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.goals_extractor.extract_emissions_data_by_page" title="Link to this definition"></a></dt>
<dd><p>Extracts emissions-related pages from a PDF based on keyword and year matching.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pdf_path</strong> (<em>str</em>) – Path to the PDF file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extracted text containing emissions-related content.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.goals_extractor.extract_goals_by_page">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.goals_extractor.</span></span><span class="sig-name descname"><span class="pre">extract_goals_by_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/goals_extractor.html#extract_goals_by_page"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.goals_extractor.extract_goals_by_page" title="Link to this definition"></a></dt>
<dd><p>Extracts pages discussing sustainability or emissions goals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pdf_path</strong> (<em>str</em>) – Path to the PDF file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extracted text containing goals-related content.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.goals_extractor.extract_goals_by_paragraph">
<span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.goals_extractor.</span></span><span class="sig-name descname"><span class="pre">extract_goals_by_paragraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/goals_extractor.html#extract_goals_by_paragraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.goals_extractor.extract_goals_by_paragraph" title="Link to this definition"></a></dt>
<dd><p>Extracts relevant paragraphs from a PDF that contain sustainability goals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pdf_path</strong> (<em>str</em>) – Path to the PDF file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extracted text containing goal-related paragraphs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-coursework_two.data_pipeline.llama_extractor">
<span id="coursework-two-data-pipeline-llama-extractor-module"></span><h2>coursework_two.data_pipeline.llama_extractor module<a class="headerlink" href="#module-coursework_two.data_pipeline.llama_extractor" title="Link to this heading"></a></h2>
<p>LlamaExtractor module for parsing sustainability reports using the LlamaParse API.</p>
<p>This module defines an asynchronous class to extract key environmental metrics
such as Scope emissions, energy consumption, and water usage from PDF reports.</p>
<p>Requires: llama-parse, loguru, pydantic, dotenv</p>
<dl class="py class">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.llama_extractor.LlamaExtractor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coursework_two.data_pipeline.llama_extractor.</span></span><span class="sig-name descname"><span class="pre">LlamaExtractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'llx-tAXlpRUJqSrUvvbafetPCsU1UljDLKKuvTV1MY2gQLPr2USs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">company_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_pdf_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coursework_two/data_pipeline/llama_extractor.html#LlamaExtractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.llama_extractor.LlamaExtractor" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Asynchronous extractor for sustainability metrics using LlamaParse.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.llama_extractor.LlamaExtractor.api_key">
<span class="sig-name descname"><span class="pre">api_key</span></span><a class="headerlink" href="#coursework_two.data_pipeline.llama_extractor.LlamaExtractor.api_key" title="Link to this definition"></a></dt>
<dd><p>LlamaParse API key.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.llama_extractor.LlamaExtractor.company_name">
<span class="sig-name descname"><span class="pre">company_name</span></span><a class="headerlink" href="#coursework_two.data_pipeline.llama_extractor.LlamaExtractor.company_name" title="Link to this definition"></a></dt>
<dd><p>Name of the company being analyzed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.llama_extractor.LlamaExtractor.filtered_pdf_path">
<span class="sig-name descname"><span class="pre">filtered_pdf_path</span></span><a class="headerlink" href="#coursework_two.data_pipeline.llama_extractor.LlamaExtractor.filtered_pdf_path" title="Link to this definition"></a></dt>
<dd><p>Path to the filtered PDF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">api_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">company_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.llama_extractor.LlamaExtractor.extract_energy_metrics">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extract_energy_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">company_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/coursework_two/data_pipeline/llama_extractor.html#LlamaExtractor.extract_energy_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.llama_extractor.LlamaExtractor.extract_energy_metrics" title="Link to this definition"></a></dt>
<dd><p>Extracts energy consumption metrics from a PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf_file</strong> (<em>str</em>) – Path to the PDF file.</p></li>
<li><p><strong>company_name</strong> (<em>str</em>) – Company name for logging and context.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extracted energy data, or an empty dictionary on failure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.llama_extractor.LlamaExtractor.extract_scope_emissions">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extract_scope_emissions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">company_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/coursework_two/data_pipeline/llama_extractor.html#LlamaExtractor.extract_scope_emissions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.llama_extractor.LlamaExtractor.extract_scope_emissions" title="Link to this definition"></a></dt>
<dd><p>Extracts Scope 1 and Scope 2 emissions data from a PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf_file</strong> (<em>str</em>) – Path to the PDF file.</p></li>
<li><p><strong>company_name</strong> (<em>str</em>) – Company name for logging and context.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extracted emissions data, or an empty dictionary on failure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.llama_extractor.LlamaExtractor.extract_water_metrics">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extract_water_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">company_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/coursework_two/data_pipeline/llama_extractor.html#LlamaExtractor.extract_water_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.llama_extractor.LlamaExtractor.extract_water_metrics" title="Link to this definition"></a></dt>
<dd><p>Extracts water usage metrics from a PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf_file</strong> (<em>str</em>) – Path to the PDF file.</p></li>
<li><p><strong>company_name</strong> (<em>str</em>) – Company name for logging and context.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extracted water usage data, or an empty dictionary on failure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">filtered_pdf_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.llama_extractor.LlamaExtractor.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#coursework_two.data_pipeline.llama_extractor.LlamaExtractor.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coursework_two.data_pipeline.llama_extractor.LlamaExtractor.process">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">process</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/coursework_two/data_pipeline/llama_extractor.html#LlamaExtractor.process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coursework_two.data_pipeline.llama_extractor.LlamaExtractor.process" title="Link to this definition"></a></dt>
<dd><p>Asynchronously processes the PDF and extracts sustainability metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A dictionary containing the following keys:</dt><dd><ul class="simple">
<li><p>”Scope Data”</p></li>
<li><p>”Energy Data”</p></li>
<li><p>”Water Data”</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-coursework_two.data_pipeline">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-coursework_two.data_pipeline" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="coursework_two.html" class="btn btn-neutral float-left" title="coursework_two package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="coursework_two.fast_api.html" class="btn btn-neutral float-right" title="coursework_two.fast_api package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Balazs.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>