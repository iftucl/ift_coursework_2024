%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{Bigdata\_cw2\_Jacaranda}
\date{May 02, 2025}
\release{1.0}
\author{Roger}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxAtStartPar
Welcome to the Bigdata\_cw2\_Jacaranda project documentation!
This site contains technical documentation for all modules, FastAPI backend, and tests.

\sphinxstepscope


\chapter{modules package}
\label{\detokenize{modules:modules-package}}\label{\detokenize{modules::doc}}

\section{Subpackages}
\label{\detokenize{modules:subpackages}}
\sphinxstepscope


\subsection{modules.data\_storage package}
\label{\detokenize{modules.data_storage:modules-data-storage-package}}\label{\detokenize{modules.data_storage::doc}}

\subsubsection{Submodules}
\label{\detokenize{modules.data_storage:submodules}}

\subsubsection{modules.data\_storage.create\_table module}
\label{\detokenize{modules.data_storage:module-modules.data_storage.create_table}}\label{\detokenize{modules.data_storage:modules-data-storage-create-table-module}}\index{module@\spxentry{module}!modules.data\_storage.create\_table@\spxentry{modules.data\_storage.create\_table}}\index{modules.data\_storage.create\_table@\spxentry{modules.data\_storage.create\_table}!module@\spxentry{module}}
\sphinxAtStartPar
Database setup module for CSR reporting system.

\sphinxAtStartPar
This module connects to a PostgreSQL database, creates necessary schema and tables
for storing CSR indicators and associated data, and populates the indicators table
with predefined environmental indicators and keywords.
\index{create\_table\_and\_insert\_data() (in module modules.data\_storage.create\_table)@\spxentry{create\_table\_and\_insert\_data()}\spxextra{in module modules.data\_storage.create\_table}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.create_table.create_table_and_insert_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.create\_table.}}\sphinxbfcode{\sphinxupquote{create\_table\_and\_insert\_data}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Create the schema and tables required for CSR data reporting and
insert predefined indicator metadata into the \sphinxtitleref{CSR\_indicators} table.

\sphinxAtStartPar
This includes:
\sphinxhyphen{} Creating the \sphinxtitleref{csr\_reporting} schema if it does not exist.
\sphinxhyphen{} Creating the \sphinxtitleref{CSR\_indicators} table to store CSR indicator metadata.
\sphinxhyphen{} Creating the \sphinxtitleref{CSR\_Data} table to store extracted CSR data.
\sphinxhyphen{} Inserting predefined indicators and associated keywords.
\begin{quote}\begin{description}
\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{psycopg2.Error}} \textendash{} If any error occurs during schema/table creation or data insertion.

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{modules.data\_storage.data\_export module}
\label{\detokenize{modules.data_storage:module-modules.data_storage.data_export}}\label{\detokenize{modules.data_storage:modules-data-storage-data-export-module}}\index{module@\spxentry{module}!modules.data\_storage.data\_export@\spxentry{modules.data\_storage.data\_export}}\index{modules.data\_storage.data\_export@\spxentry{modules.data\_storage.data\_export}!module@\spxentry{module}}
\sphinxAtStartPar
This module exports tables from a PostgreSQL database to CSV files.

\sphinxAtStartPar
It uses \sphinxtitleref{psycopg2} for database connectivity and \sphinxtitleref{pandas} to execute SQL queries and export the results
to CSV files. The module supports configuration for the database connection, output file paths,
and default sorting columns for the queries.

\sphinxAtStartPar
Functions:
\sphinxhyphen{} \sphinxtitleref{export\_table\_to\_csv}: Exports a specified table from the PostgreSQL database to a CSV file.
\sphinxhyphen{} \sphinxtitleref{main}: Orchestrates the connection to the database and exports predefined tables to CSV files.
\index{export\_table\_to\_csv() (in module modules.data\_storage.data\_export)@\spxentry{export\_table\_to\_csv()}\spxextra{in module modules.data\_storage.data\_export}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.data_export.export_table_to_csv}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.data\_export.}}\sphinxbfcode{\sphinxupquote{export\_table\_to\_csv}}}
{\sphinxparam{\DUrole{n}{table\_name}}\sphinxparamcomma \sphinxparam{\DUrole{n}{output\_path}}\sphinxparamcomma \sphinxparam{\DUrole{n}{conn}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Exports a specific table from the PostgreSQL database to a CSV file.

\sphinxAtStartPar
This function fetches all data from the specified table, optionally ordering it
by a default column (if configured), and saves the results to a CSV file at the
provided output path.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{table\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The name of the table to export.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{output\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The path where the CSV file will be saved.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn}} (\sphinxstyleliteralemphasis{\sphinxupquote{psycopg2.extensions.connection}}) \textendash{} A psycopg2 connection object used to interact with the database.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
None

\sphinxlineitem{Raises}
\sphinxAtStartPar
Any exceptions raised by the \sphinxtitleref{pandas.read\_sql\_query} or \sphinxtitleref{pandas.DataFrame.to\_csv} functions.

\end{description}\end{quote}

\end{fulllineitems}

\index{main() (in module modules.data\_storage.data\_export)@\spxentry{main()}\spxextra{in module modules.data\_storage.data\_export}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.data_export.main}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.data\_export.}}\sphinxbfcode{\sphinxupquote{main}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Main function to connect to the PostgreSQL database and export multiple tables to CSV files.

\sphinxAtStartPar
This function establishes a connection to the database, iterates over a predefined
list of tables, and calls \sphinxtitleref{export\_table\_to\_csv} to export each table to a CSV file.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
None

\sphinxlineitem{Raises}
\sphinxAtStartPar
Any exceptions raised during the database connection or table export process.

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{modules.data\_storage.llm\_analyse module}
\label{\detokenize{modules.data_storage:module-modules.data_storage.llm_analyse}}\label{\detokenize{modules.data_storage:modules-data-storage-llm-analyse-module}}\index{module@\spxentry{module}!modules.data\_storage.llm\_analyse@\spxentry{modules.data\_storage.llm\_analyse}}\index{modules.data\_storage.llm\_analyse@\spxentry{modules.data\_storage.llm\_analyse}!module@\spxentry{module}}
\sphinxAtStartPar
This module processes CSR (Corporate Social Responsibility) data by interacting with a PostgreSQL database
and an OpenAI API. It performs tasks such as fetching pending CSR data from the database, building prompts
for an LLM (Large Language Model), processing the data, and updating the results in the database.

\sphinxAtStartPar
The workflow involves the following key steps:
1. Establishing a connection to the PostgreSQL database.
2. Fetching pending rows that need processing.
3. Creating prompts for the LLM based on CSR report data and indicators.
4. Sending these prompts to an OpenAI\sphinxhyphen{}powered LLM for processing.
5. Extracting and updating relevant values (numeric or goal\sphinxhyphen{}related data) in the database.

\sphinxAtStartPar
Configuration:
\sphinxhyphen{} PostgreSQL: Used for storing and retrieving CSR data.
\sphinxhyphen{} OpenAI API: Used for processing CSR report content.

\sphinxAtStartPar
Dependencies:
\sphinxhyphen{} psycopg2: PostgreSQL database adapter.
\sphinxhyphen{} dotenv: Used to load environment variables.
\sphinxhyphen{} openai: Python client for interacting with the OpenAI API.
\sphinxhyphen{} tqdm: For progress bars.
\sphinxhyphen{} concurrent.futures: For concurrent processing using threads.
\index{build\_prompt() (in module modules.data\_storage.llm\_analyse)@\spxentry{build\_prompt()}\spxextra{in module modules.data\_storage.llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_analyse.build_prompt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_analyse.}}\sphinxbfcode{\sphinxupquote{build\_prompt}}}
{\sphinxparam{\DUrole{n}{indicator\_name}}\sphinxparamcomma \sphinxparam{\DUrole{n}{description}}\sphinxparamcomma \sphinxparam{\DUrole{n}{is\_target}}\sphinxparamcomma \sphinxparam{\DUrole{n}{source\_excerpt}}\sphinxparamcomma \sphinxparam{\DUrole{n}{report\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Builds a prompt for the LLM based on the CSR report and indicator details.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indicator\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The name of the CSR indicator.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{description}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The description of the CSR indicator.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{is\_target}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} Flag indicating whether the indicator is a target indicator.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{source\_excerpt}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} List of matched paragraphs from the CSR report.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{report\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The year of the CSR report.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
The formatted prompt for the LLM.

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{call\_llm() (in module modules.data\_storage.llm\_analyse)@\spxentry{call\_llm()}\spxextra{in module modules.data\_storage.llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_analyse.call_llm}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_analyse.}}\sphinxbfcode{\sphinxupquote{call\_llm}}}
{\sphinxparam{\DUrole{n}{prompt}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calls the LLM API with the provided prompt and returns the response.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{prompt}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The prompt to be sent to the LLM.

\sphinxlineitem{Returns}
\sphinxAtStartPar
The response content from the LLM.

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{fetch\_pending\_rows() (in module modules.data\_storage.llm\_analyse)@\spxentry{fetch\_pending\_rows()}\spxextra{in module modules.data\_storage.llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_analyse.fetch_pending_rows}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_analyse.}}\sphinxbfcode{\sphinxupquote{fetch\_pending\_rows}}}
{\sphinxparam{\DUrole{n}{conn}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fetches rows from the database that have a NULL value for ‘value\_raw’ and are pending processing.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn}} (\sphinxstyleliteralemphasis{\sphinxupquote{psycopg2.extensions.connection}}) \textendash{} A psycopg2 connection object.

\sphinxlineitem{Returns}
\sphinxAtStartPar
List of tuples representing the pending rows.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list of tuples

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_connection() (in module modules.data\_storage.llm\_analyse)@\spxentry{get\_connection()}\spxextra{in module modules.data\_storage.llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_analyse.get_connection}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_analyse.}}\sphinxbfcode{\sphinxupquote{get\_connection}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Establishes a connection to the PostgreSQL database using the provided configuration.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
psycopg2 connection object.

\sphinxlineitem{Return type}
\sphinxAtStartPar
psycopg2.extensions.connection

\end{description}\end{quote}

\end{fulllineitems}

\index{is\_valid\_number() (in module modules.data\_storage.llm\_analyse)@\spxentry{is\_valid\_number()}\spxextra{in module modules.data\_storage.llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_analyse.is_valid_number}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_analyse.}}\sphinxbfcode{\sphinxupquote{is\_valid\_number}}}
{\sphinxparam{\DUrole{n}{value}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Checks if the given value is a valid number (either integer or float).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{value}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The value to check.

\sphinxlineitem{Returns}
\sphinxAtStartPar
True if the value is a valid number, otherwise False.

\sphinxlineitem{Return type}
\sphinxAtStartPar
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{main() (in module modules.data\_storage.llm\_analyse)@\spxentry{main()}\spxextra{in module modules.data\_storage.llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_analyse.main}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_analyse.}}\sphinxbfcode{\sphinxupquote{main}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Main function to process all pending rows in the database by calling the process\_row function concurrently.

\end{fulllineitems}

\index{process\_row() (in module modules.data\_storage.llm\_analyse)@\spxentry{process\_row()}\spxextra{in module modules.data\_storage.llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_analyse.process_row}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_analyse.}}\sphinxbfcode{\sphinxupquote{process\_row}}}
{\sphinxparam{\DUrole{n}{conn}}\sphinxparamcomma \sphinxparam{\DUrole{n}{row}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Processes a single row from the database, including calling the LLM API and updating the result in the database.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn}} (\sphinxstyleliteralemphasis{\sphinxupquote{psycopg2.extensions.connection}}) \textendash{} A psycopg2 connection object.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{row}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} A tuple representing a single row of CSR data to be processed.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
The ID of the processed data row.

\sphinxlineitem{Return type}
\sphinxAtStartPar
int

\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If an error occurs during processing.

\end{description}\end{quote}

\end{fulllineitems}

\index{update\_result() (in module modules.data\_storage.llm\_analyse)@\spxentry{update\_result()}\spxextra{in module modules.data\_storage.llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_analyse.update_result}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_analyse.}}\sphinxbfcode{\sphinxupquote{update\_result}}}
{\sphinxparam{\DUrole{n}{conn}}\sphinxparamcomma \sphinxparam{\DUrole{n}{data\_id}}\sphinxparamcomma \sphinxparam{\DUrole{n}{value\_raw}}\sphinxparamcomma \sphinxparam{\DUrole{n}{unit\_raw}}\sphinxparamcomma \sphinxparam{\DUrole{n}{llm\_response\_raw}}\sphinxparamcomma \sphinxparam{\DUrole{n}{pdf\_page}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Updates the processed result in the database for the given data ID.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn}} (\sphinxstyleliteralemphasis{\sphinxupquote{psycopg2.extensions.connection}}) \textendash{} A psycopg2 connection object.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{data\_id}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The ID of the data to be updated.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{value\_raw}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The raw value extracted from the CSR report.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{unit\_raw}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The unit of the extracted value.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{llm\_response\_raw}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The raw response from the LLM.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pdf\_page}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The page number(s) from the CSR report where the data was found.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{modules.data\_storage.llm\_standardize module}
\label{\detokenize{modules.data_storage:module-modules.data_storage.llm_standardize}}\label{\detokenize{modules.data_storage:modules-data-storage-llm-standardize-module}}\index{module@\spxentry{module}!modules.data\_storage.llm\_standardize@\spxentry{modules.data\_storage.llm\_standardize}}\index{modules.data\_storage.llm\_standardize@\spxentry{modules.data\_storage.llm\_standardize}!module@\spxentry{module}}
\sphinxAtStartPar
This module processes and standardizes CSR report data by converting indicator units
to a target unit using a machine learning model (LLM). It interacts with a PostgreSQL
database to fetch, process, and update the data.

\sphinxAtStartPar
Key functions:
\sphinxhyphen{} Fetch rows from the database that need unit standardization.
\sphinxhyphen{} Build prompts for the LLM to convert units based on the CSR indicator.
\sphinxhyphen{} Call the LLM API to get the conversion results.
\sphinxhyphen{} Parse the response and update the database with standardized values.

\sphinxAtStartPar
It uses \sphinxtitleref{psycopg2} for PostgreSQL interaction, \sphinxtitleref{dotenv} for environment variable management,
\sphinxtitleref{tqdm} for progress tracking, and \sphinxtitleref{concurrent.futures} for concurrent execution of row processing.
\index{build\_conversion\_prompt() (in module modules.data\_storage.llm\_standardize)@\spxentry{build\_conversion\_prompt()}\spxextra{in module modules.data\_storage.llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_standardize.build_conversion_prompt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_standardize.}}\sphinxbfcode{\sphinxupquote{build\_conversion\_prompt}}}
{\sphinxparam{\DUrole{n}{indicator\_name}}\sphinxparamcomma \sphinxparam{\DUrole{n}{description}}\sphinxparamcomma \sphinxparam{\DUrole{n}{value\_raw}}\sphinxparamcomma \sphinxparam{\DUrole{n}{unit\_raw}}\sphinxparamcomma \sphinxparam{\DUrole{n}{target\_unit}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Constructs a prompt for the LLM to convert a unit of measurement from the raw value to the target unit.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indicator\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The name of the CSR indicator.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{description}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The description of the CSR indicator.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{value\_raw}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The raw value to be converted.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{unit\_raw}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The unit of the raw value.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{target\_unit}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The target unit to convert the value to.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
The LLM prompt as a formatted string.

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{call\_llm() (in module modules.data\_storage.llm\_standardize)@\spxentry{call\_llm()}\spxextra{in module modules.data\_storage.llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_standardize.call_llm}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_standardize.}}\sphinxbfcode{\sphinxupquote{call\_llm}}}
{\sphinxparam{\DUrole{n}{prompt}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Sends a request to the LLM (DeepSeek API) to process the unit conversion based on the given prompt.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{prompt}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The conversion prompt to send to the LLM.

\sphinxlineitem{Returns}
\sphinxAtStartPar
The response content from the LLM.

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{fetch\_rows\_to\_standardize() (in module modules.data\_storage.llm\_standardize)@\spxentry{fetch\_rows\_to\_standardize()}\spxextra{in module modules.data\_storage.llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_standardize.fetch_rows_to_standardize}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_standardize.}}\sphinxbfcode{\sphinxupquote{fetch\_rows\_to\_standardize}}}
{\sphinxparam{\DUrole{n}{conn}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fetches rows from the database that require unit standardization.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn}} (\sphinxstyleliteralemphasis{\sphinxupquote{psycopg2.extensions.connection}}) \textendash{} The psycopg2 connection object to the database.

\sphinxlineitem{Returns}
\sphinxAtStartPar
List of rows containing data to be standardized.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list of tuples

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_connection() (in module modules.data\_storage.llm\_standardize)@\spxentry{get\_connection()}\spxextra{in module modules.data\_storage.llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_standardize.get_connection}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_standardize.}}\sphinxbfcode{\sphinxupquote{get\_connection}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Establishes and returns a connection to the PostgreSQL database using the specified configuration.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
psycopg2 connection object

\sphinxlineitem{Return type}
\sphinxAtStartPar
psycopg2.extensions.connection

\end{description}\end{quote}

\end{fulllineitems}

\index{is\_valid\_number() (in module modules.data\_storage.llm\_standardize)@\spxentry{is\_valid\_number()}\spxextra{in module modules.data\_storage.llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_standardize.is_valid_number}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_standardize.}}\sphinxbfcode{\sphinxupquote{is\_valid\_number}}}
{\sphinxparam{\DUrole{n}{value}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Checks if the given value is a valid numeric value (either integer or float).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{value}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The value to check.

\sphinxlineitem{Returns}
\sphinxAtStartPar
True if the value is valid, otherwise False.

\sphinxlineitem{Return type}
\sphinxAtStartPar
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{main() (in module modules.data\_storage.llm\_standardize)@\spxentry{main()}\spxextra{in module modules.data\_storage.llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_standardize.main}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_standardize.}}\sphinxbfcode{\sphinxupquote{main}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Main function to process all pending rows in the database by calling the process\_row function concurrently.

\end{fulllineitems}

\index{process\_row() (in module modules.data\_storage.llm\_standardize)@\spxentry{process\_row()}\spxextra{in module modules.data\_storage.llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_standardize.process_row}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_standardize.}}\sphinxbfcode{\sphinxupquote{process\_row}}}
{\sphinxparam{\DUrole{n}{conn}}\sphinxparamcomma \sphinxparam{\DUrole{n}{row}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Processes a single row of CSR data, including calling the LLM API and updating the database.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn}} (\sphinxstyleliteralemphasis{\sphinxupquote{psycopg2.extensions.connection}}) \textendash{} The psycopg2 connection object to the database.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{row}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} A tuple representing the CSR data to process.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
The data ID of the processed row, or None if processing failed.

\sphinxlineitem{Return type}
\sphinxAtStartPar
int or None

\end{description}\end{quote}

\end{fulllineitems}

\index{safe\_json\_parse() (in module modules.data\_storage.llm\_standardize)@\spxentry{safe\_json\_parse()}\spxextra{in module modules.data\_storage.llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_standardize.safe_json_parse}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_standardize.}}\sphinxbfcode{\sphinxupquote{safe\_json\_parse}}}
{\sphinxparam{\DUrole{n}{response\_text}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Cleans and parses the raw response text from the LLM into a structured JSON format.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{response\_text}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The raw response text from the LLM.

\sphinxlineitem{Returns}
\sphinxAtStartPar
The parsed JSON object containing the conversion result.

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ValueError}} \textendash{} If the response cannot be parsed into valid JSON.

\end{description}\end{quote}

\end{fulllineitems}

\index{update\_standardized() (in module modules.data\_storage.llm\_standardize)@\spxentry{update\_standardized()}\spxextra{in module modules.data\_storage.llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.llm_standardize.update_standardized}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.llm\_standardize.}}\sphinxbfcode{\sphinxupquote{update\_standardized}}}
{\sphinxparam{\DUrole{n}{conn}}\sphinxparamcomma \sphinxparam{\DUrole{n}{data\_id}}\sphinxparamcomma \sphinxparam{\DUrole{n}{value\_standardized}}\sphinxparamcomma \sphinxparam{\DUrole{n}{unit\_standardized}}\sphinxparamcomma \sphinxparam{\DUrole{n}{unit\_conversion\_note}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Updates the database with the standardized value and unit for the given data ID.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn}} (\sphinxstyleliteralemphasis{\sphinxupquote{psycopg2.extensions.connection}}) \textendash{} The psycopg2 connection object to the database.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{data\_id}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The ID of the data row to update.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{value\_standardized}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The standardized value to be saved.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{unit\_standardized}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The unit of the standardized value.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{unit\_conversion\_note}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Additional notes about the unit conversion (optional).

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{modules.data\_storage.main module}
\label{\detokenize{modules.data_storage:module-modules.data_storage.main}}\label{\detokenize{modules.data_storage:modules-data-storage-main-module}}\index{module@\spxentry{module}!modules.data\_storage.main@\spxentry{modules.data\_storage.main}}\index{modules.data\_storage.main@\spxentry{modules.data\_storage.main}!module@\spxentry{module}}
\sphinxAtStartPar
This module defines and manages the execution of a series of Python scripts in a data processing pipeline.

\sphinxAtStartPar
It includes functions for executing shell commands, logging the results, tracking completed modules,
and executing the pipeline with progress reporting. The pipeline logs progress and execution times
of individual modules, ensuring each module is executed only once.

\sphinxAtStartPar
Modules run by this pipeline:
\sphinxhyphen{} \sphinxtitleref{create\_table.py}
\sphinxhyphen{} \sphinxtitleref{paragraph\_extraction.py}
\sphinxhyphen{} \sphinxtitleref{retry\_failed\_reports.py}
\sphinxhyphen{} \sphinxtitleref{llm\_analyse.py}
\sphinxhyphen{} \sphinxtitleref{llm\_standardize.py}
\sphinxhyphen{} \sphinxtitleref{data\_export.py}

\sphinxAtStartPar
Functions:
\sphinxhyphen{} \sphinxtitleref{read\_completed\_modules}: Reads a list of completed modules from a file.
\sphinxhyphen{} \sphinxtitleref{write\_completed\_module}: Appends a completed module to a record file.
\sphinxhyphen{} \sphinxtitleref{run\_command}: Executes a shell command and logs the result.
\sphinxhyphen{} \sphinxtitleref{main}: Orchestrates the pipeline execution, including dependency installation, module execution, and logging.
\index{main() (in module modules.data\_storage.main)@\spxentry{main()}\spxextra{in module modules.data\_storage.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.main.main}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.main.}}\sphinxbfcode{\sphinxupquote{main}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Orchestrates the execution of the full data processing pipeline.

\sphinxAtStartPar
This function installs the necessary dependencies, loads the list of completed modules,
and iterates over a predefined set of modules to execute. It tracks the execution progress
and logs each step. Each module is only executed once, and the completion is recorded.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
None

\sphinxlineitem{Raises}
\sphinxAtStartPar
Any exceptions raised during the pipeline execution.

\end{description}\end{quote}

\end{fulllineitems}

\index{read\_completed\_modules() (in module modules.data\_storage.main)@\spxentry{read\_completed\_modules()}\spxextra{in module modules.data\_storage.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.main.read_completed_modules}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.main.}}\sphinxbfcode{\sphinxupquote{read\_completed\_modules}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Reads the list of modules that have already been completed from a file.

\sphinxAtStartPar
This function checks for a file containing the names of completed modules and returns
a set of these module names. If the file does not exist, an empty set is returned.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
A set of module names that have been completed.

\sphinxlineitem{Return type}
\sphinxAtStartPar
set

\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{FileNotFoundError}} \textendash{} If the completed modules file is not found.

\end{description}\end{quote}

\end{fulllineitems}

\index{run\_command() (in module modules.data\_storage.main)@\spxentry{run\_command()}\spxextra{in module modules.data\_storage.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.main.run_command}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.main.}}\sphinxbfcode{\sphinxupquote{run\_command}}}
{\sphinxparam{\DUrole{n}{command}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Executes a shell command and logs the result.

\sphinxAtStartPar
This function runs the specified command in the shell, logging the start and success of the execution.
If the command fails, the error is logged, and the script exits with a failure code.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{command}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The shell command to execute.

\sphinxlineitem{Returns}
\sphinxAtStartPar
None

\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{subprocess.CalledProcessError}} \textendash{} If the command fails during execution.

\end{description}\end{quote}

\end{fulllineitems}

\index{write\_completed\_module() (in module modules.data\_storage.main)@\spxentry{write\_completed\_module()}\spxextra{in module modules.data\_storage.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.main.write_completed_module}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.main.}}\sphinxbfcode{\sphinxupquote{write\_completed\_module}}}
{\sphinxparam{\DUrole{n}{module}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Appends the name of a completed module to the record file.

\sphinxAtStartPar
This function writes the provided module name to a file that tracks which modules
have been executed. Each module name is written on a new line.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{module}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The name of the module that has been completed.

\sphinxlineitem{Returns}
\sphinxAtStartPar
None

\sphinxlineitem{Raises}
\sphinxAtStartPar
Any exceptions raised during file operations.

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{modules.data\_storage.paragraph\_extraction module}
\label{\detokenize{modules.data_storage:module-modules.data_storage.paragraph_extraction}}\label{\detokenize{modules.data_storage:modules-data-storage-paragraph-extraction-module}}\index{module@\spxentry{module}!modules.data\_storage.paragraph\_extraction@\spxentry{modules.data\_storage.paragraph\_extraction}}\index{modules.data\_storage.paragraph\_extraction@\spxentry{modules.data\_storage.paragraph\_extraction}!module@\spxentry{module}}
\sphinxAtStartPar
PDF Paragraph Extraction and CSR Indicator Matching Tool

\sphinxAtStartPar
This module provides functions to extract paragraphs from CSR reports in PDF format stored in MinIO,
match them against indicators stored in a PostgreSQL database, and store the matched results.

\sphinxAtStartPar
Modules used:
\sphinxhyphen{} MinIO for object storage access
\sphinxhyphen{} pdfplumber for PDF text extraction
\sphinxhyphen{} fuzzywuzzy for keyword similarity matching
\sphinxhyphen{} psycopg2 for PostgreSQL interaction
\sphinxhyphen{} tqdm for progress display
\sphinxhyphen{} multiprocessing for parallel processing
\index{check\_memory\_usage() (in module modules.data\_storage.paragraph\_extraction)@\spxentry{check\_memory\_usage()}\spxextra{in module modules.data\_storage.paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.paragraph_extraction.check_memory_usage}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{check\_memory\_usage}}}
{\sphinxparam{\DUrole{n}{threshold\_percent}\DUrole{o}{=}\DUrole{default_value}{90}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Check current memory usage and print a warning if it exceeds a given threshold.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{threshold\_percent}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Memory usage percentage threshold.

\sphinxlineitem{Returns}
\sphinxAtStartPar
True if memory usage is below threshold, else False.

\sphinxlineitem{Return type}
\sphinxAtStartPar
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{extract\_paragraphs\_from\_pdf() (in module modules.data\_storage.paragraph\_extraction)@\spxentry{extract\_paragraphs\_from\_pdf()}\spxextra{in module modules.data\_storage.paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.paragraph_extraction.extract_paragraphs_from_pdf}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{extract\_paragraphs\_from\_pdf}}}
{\sphinxparam{\DUrole{n}{file\_path}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Extract paragraphs from a PDF file.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{file\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Path to the local PDF file.

\sphinxlineitem{Yield}
\sphinxAtStartPar
Tuple containing page number and cleaned paragraph text.

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple{[}int, str{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{find\_matching\_paragraphs() (in module modules.data\_storage.paragraph\_extraction)@\spxentry{find\_matching\_paragraphs()}\spxextra{in module modules.data\_storage.paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.paragraph_extraction.find_matching_paragraphs}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{find\_matching\_paragraphs}}}
{\sphinxparam{\DUrole{n}{paragraphs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{keywords}}\sphinxparamcomma \sphinxparam{\DUrole{n}{threshold}\DUrole{o}{=}\DUrole{default_value}{80}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Find paragraphs that match a set of keywords using fuzzy string matching.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{paragraphs}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} List of (page number, paragraph) tuples.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{keywords}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} List of keyword strings to match.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Matching threshold (0\textendash{}100), defaults to 80.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
List of matched paragraphs with page numbers.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list{[}dict{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{insert\_matched\_data() (in module modules.data\_storage.paragraph\_extraction)@\spxentry{insert\_matched\_data()}\spxextra{in module modules.data\_storage.paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.paragraph_extraction.insert_matched_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{insert\_matched\_data}}}
{\sphinxparam{\DUrole{n}{conn}}\sphinxparamcomma \sphinxparam{\DUrole{n}{security}}\sphinxparamcomma \sphinxparam{\DUrole{n}{report\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{indicator\_id}}\sphinxparamcomma \sphinxparam{\DUrole{n}{indicator\_name}}\sphinxparamcomma \sphinxparam{\DUrole{n}{matched}}\sphinxparamcomma \sphinxparam{\DUrole{n}{extraction\_time}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Insert matched paragraphs into the csr\_reporting.CSR\_Data table.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn}} (\sphinxstyleliteralemphasis{\sphinxupquote{psycopg2.connection}}) \textendash{} PostgreSQL connection object.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{security}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Security identifier.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{report\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Year of the report.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indicator\_id}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} ID of the matched indicator.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indicator\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Name of the matched indicator.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{matched}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} List of matched paragraph entries.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{extraction\_time}} (\sphinxstyleliteralemphasis{\sphinxupquote{datetime.datetime}}) \textendash{} Timestamp of extraction.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{load\_indicators\_from\_db() (in module modules.data\_storage.paragraph\_extraction)@\spxentry{load\_indicators\_from\_db()}\spxextra{in module modules.data\_storage.paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.paragraph_extraction.load_indicators_from_db}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{load\_indicators\_from\_db}}}
{\sphinxparam{\DUrole{n}{conn}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Load CSR indicators and associated keywords from the database.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn}} (\sphinxstyleliteralemphasis{\sphinxupquote{psycopg2.connection}}) \textendash{} PostgreSQL database connection.

\sphinxlineitem{Returns}
\sphinxAtStartPar
List of tuples (indicator\_id, indicator\_name, keywords).

\sphinxlineitem{Return type}
\sphinxAtStartPar
list{[}tuple{[}int, str, list{[}str{]}{]}{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{parse\_security\_and\_year() (in module modules.data\_storage.paragraph\_extraction)@\spxentry{parse\_security\_and\_year()}\spxextra{in module modules.data\_storage.paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.paragraph_extraction.parse_security_and_year}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{parse\_security\_and\_year}}}
{\sphinxparam{\DUrole{n}{object\_name}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Parse the security identifier and report year from a given object name.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{object\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The name of the PDF object in MinIO.

\sphinxlineitem{Returns}
\sphinxAtStartPar
Tuple of (security, year) or (None, None) if parsing fails.

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple{[}str, int | None{]}

\end{description}\end{quote}

\end{fulllineitems}

\index{process\_all\_pdfs() (in module modules.data\_storage.paragraph\_extraction)@\spxentry{process\_all\_pdfs()}\spxextra{in module modules.data\_storage.paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.paragraph_extraction.process_all_pdfs}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{process\_all\_pdfs}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Main pipeline to process all PDF files from MinIO:
\sphinxhyphen{} Downloads each file
\sphinxhyphen{} Extracts paragraphs
\sphinxhyphen{} Matches with indicators
\sphinxhyphen{} Saves matched results to the database
\sphinxhyphen{} Logs failed files

\end{fulllineitems}

\index{process\_report() (in module modules.data\_storage.paragraph\_extraction)@\spxentry{process\_report()}\spxextra{in module modules.data\_storage.paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.paragraph_extraction.process_report}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{process\_report}}}
{\sphinxparam{\DUrole{n}{args}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Process a single PDF report: download, extract, match indicators, and insert data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{args}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} Tuple of (conn\_config, MinIO object, indicators).

\sphinxlineitem{Returns}
\sphinxAtStartPar
Object name if failed, else None.

\sphinxlineitem{Return type}
\sphinxAtStartPar
str | None

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{modules.data\_storage.retry\_failed\_reports module}
\label{\detokenize{modules.data_storage:module-modules.data_storage.retry_failed_reports}}\label{\detokenize{modules.data_storage:modules-data-storage-retry-failed-reports-module}}\index{module@\spxentry{module}!modules.data\_storage.retry\_failed\_reports@\spxentry{modules.data\_storage.retry\_failed\_reports}}\index{modules.data\_storage.retry\_failed\_reports@\spxentry{modules.data\_storage.retry\_failed\_reports}!module@\spxentry{module}}
\sphinxAtStartPar
This module is responsible for processing CSR (Corporate Social Responsibility) reports.
It connects to a MinIO server to download the reports, extracts text paragraphs from
PDF files, matches them against CSR indicators loaded from a PostgreSQL database,
and stores the matched data back into the database.

\sphinxAtStartPar
The workflow includes the following key steps:
1. Downloading the CSR report from MinIO.
2. Extracting text paragraphs from the report’s PDF file.
3. Matching the extracted paragraphs with predefined CSR indicators using fuzzy string matching.
4. Inserting matched data into the PostgreSQL database.
5. Supporting retry logic for processing failed reports.

\sphinxAtStartPar
Configuration:
\sphinxhyphen{} MinIO: Used for storing and retrieving CSR report PDF files.
\sphinxhyphen{} PostgreSQL: Used to store CSR indicators and matched data.

\sphinxAtStartPar
Dependencies:
\sphinxhyphen{} psycopg2: PostgreSQL database adapter.
\sphinxhyphen{} pdfplumber: PDF text extraction library.
\sphinxhyphen{} fuzzywuzzy: Fuzzy string matching library.
\sphinxhyphen{} tqdm: For progress bars.
\sphinxhyphen{} minio: MinIO Python client for object storage.
\index{extract\_paragraphs\_from\_pdf() (in module modules.data\_storage.retry\_failed\_reports)@\spxentry{extract\_paragraphs\_from\_pdf()}\spxextra{in module modules.data\_storage.retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.retry_failed_reports.extract_paragraphs_from_pdf}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{extract\_paragraphs\_from\_pdf}}}
{\sphinxparam{\DUrole{n}{file\_path}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Extracts paragraphs from a PDF file.

\sphinxAtStartPar
This function opens the specified PDF file, extracts the text from each page,
and splits the text into paragraphs based on sentence delimiters. It only retains
paragraphs with more than 20 characters.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{file\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The path to the PDF file.

\sphinxlineitem{Returns}
\sphinxAtStartPar
A list of tuples, each containing the page number and a paragraph.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list of tuples (int, str)

\end{description}\end{quote}

\end{fulllineitems}

\index{find\_matching\_paragraphs() (in module modules.data\_storage.retry\_failed\_reports)@\spxentry{find\_matching\_paragraphs()}\spxextra{in module modules.data\_storage.retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.retry_failed_reports.find_matching_paragraphs}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{find\_matching\_paragraphs}}}
{\sphinxparam{\DUrole{n}{paragraphs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{keywords}}\sphinxparamcomma \sphinxparam{\DUrole{n}{threshold}\DUrole{o}{=}\DUrole{default_value}{80}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Finds paragraphs that match the given keywords based on fuzzy string matching.

\sphinxAtStartPar
This function compares each paragraph with the provided keywords using fuzzy
string matching (via the fuzzywuzzy library) and returns the paragraphs with
matches above a specified threshold.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{paragraphs}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{tuples}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} A list of paragraphs to search.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{keywords}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} A list of keywords to match against.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The minimum fuzzy match score to consider a paragraph as a match.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
A list of dictionaries containing the matched paragraphs with their page number.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list of dict

\end{description}\end{quote}

\end{fulllineitems}

\index{insert\_matched\_data() (in module modules.data\_storage.retry\_failed\_reports)@\spxentry{insert\_matched\_data()}\spxextra{in module modules.data\_storage.retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.retry_failed_reports.insert_matched_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{insert\_matched\_data}}}
{\sphinxparam{\DUrole{n}{conn}}\sphinxparamcomma \sphinxparam{\DUrole{n}{security}}\sphinxparamcomma \sphinxparam{\DUrole{n}{report\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{indicator\_id}}\sphinxparamcomma \sphinxparam{\DUrole{n}{indicator\_name}}\sphinxparamcomma \sphinxparam{\DUrole{n}{matched}}\sphinxparamcomma \sphinxparam{\DUrole{n}{extraction\_time}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Inserts the matched CSR data into the database.

\sphinxAtStartPar
This function inserts the matched paragraphs along with metadata into the
PostgreSQL database for later retrieval and reporting.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn}} (\sphinxstyleliteralemphasis{\sphinxupquote{psycopg2.connection}}) \textendash{} The database connection object.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{security}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The security identifier of the company.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{report\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The year of the CSR report.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indicator\_id}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The ID of the CSR indicator.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indicator\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The name of the CSR indicator.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{matched}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} A list of matched paragraphs.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{extraction\_time}} (\sphinxstyleliteralemphasis{\sphinxupquote{datetime.datetime}}) \textendash{} The time when the data was extracted.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{load\_indicators\_from\_db() (in module modules.data\_storage.retry\_failed\_reports)@\spxentry{load\_indicators\_from\_db()}\spxextra{in module modules.data\_storage.retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.retry_failed_reports.load_indicators_from_db}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{load\_indicators\_from\_db}}}
{\sphinxparam{\DUrole{n}{conn}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Loads CSR indicators from the PostgreSQL database.

\sphinxAtStartPar
This function queries the database for CSR indicator data, including indicator
names and keywords, which are used later to match against extracted paragraphs.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn}} (\sphinxstyleliteralemphasis{\sphinxupquote{psycopg2.connection}}) \textendash{} The database connection object.

\sphinxlineitem{Returns}
\sphinxAtStartPar
A list of tuples containing indicator\_id, indicator\_name, and keywords.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list of tuples (int, str, list)

\end{description}\end{quote}

\end{fulllineitems}

\index{parse\_security\_and\_year() (in module modules.data\_storage.retry\_failed\_reports)@\spxentry{parse\_security\_and\_year()}\spxextra{in module modules.data\_storage.retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.retry_failed_reports.parse_security_and_year}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{parse\_security\_and\_year}}}
{\sphinxparam{\DUrole{n}{object\_name}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Parses the security identifier and report year from the given object name.

\sphinxAtStartPar
This function expects the object name to follow a specific naming convention
where the filename contains a security identifier followed by a 4\sphinxhyphen{}digit year
(e.g., “ABC\_2021.pdf”).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{object\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The name of the object (PDF file) stored in MinIO.

\sphinxlineitem{Returns}
\sphinxAtStartPar
A tuple containing the security identifier and report year,
or (None, None) if parsing fails.

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple or (None, None)

\end{description}\end{quote}

\end{fulllineitems}

\index{process\_single\_report() (in module modules.data\_storage.retry\_failed\_reports)@\spxentry{process\_single\_report()}\spxextra{in module modules.data\_storage.retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.retry_failed_reports.process_single_report}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{process\_single\_report}}}
{\sphinxparam{\DUrole{n}{object\_name}}\sphinxparamcomma \sphinxparam{\DUrole{n}{indicators}}\sphinxparamcomma \sphinxparam{\DUrole{n}{conn\_config}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Processes a single report by downloading it from MinIO, extracting paragraphs,
matching them with indicators, and saving the results to the database.

\sphinxAtStartPar
This function downloads the report, extracts its paragraphs, matches them with
CSR indicators, and stores the results in the database.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{object\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The name of the object (PDF file) stored in MinIO.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indicators}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{tuples}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} A list of CSR indicators to match against.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conn\_config}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} The configuration for connecting to the PostgreSQL database.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
True if the report was processed successfully, False otherwise.

\sphinxlineitem{Return type}
\sphinxAtStartPar
bool

\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If any error occurs during the processing of the report.

\end{description}\end{quote}

\end{fulllineitems}

\index{retry\_failed\_reports() (in module modules.data\_storage.retry\_failed\_reports)@\spxentry{retry\_failed\_reports()}\spxextra{in module modules.data\_storage.retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.data_storage:modules.data_storage.retry_failed_reports.retry_failed_reports}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.data\_storage.retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{retry\_failed\_reports}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Retries processing of reports that failed during a previous attempt.
If retrying fails, the report names are saved in the ‘failed\_reports.json’ file.

\sphinxAtStartPar
This function reads a list of failed report names from a JSON file, retries
processing them, and updates the list of failed reports if necessary.
\begin{quote}\begin{description}
\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Exception}} \textendash{} If any error occurs during the retry process.

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{Module contents}
\label{\detokenize{modules.data_storage:module-modules.data_storage}}\label{\detokenize{modules.data_storage:module-contents}}\index{module@\spxentry{module}!modules.data\_storage@\spxentry{modules.data\_storage}}\index{modules.data\_storage@\spxentry{modules.data\_storage}!module@\spxentry{module}}
\sphinxstepscope


\subsection{modules.frontend package}
\label{\detokenize{modules.frontend:modules-frontend-package}}\label{\detokenize{modules.frontend::doc}}

\subsubsection{Module contents}
\label{\detokenize{modules.frontend:module-modules.frontend}}\label{\detokenize{modules.frontend:module-contents}}\index{module@\spxentry{module}!modules.frontend@\spxentry{modules.frontend}}\index{modules.frontend@\spxentry{modules.frontend}!module@\spxentry{module}}
\sphinxstepscope


\subsection{modules.security package}
\label{\detokenize{modules.security:modules-security-package}}\label{\detokenize{modules.security::doc}}

\subsubsection{Submodules}
\label{\detokenize{modules.security:submodules}}

\subsubsection{modules.security.scan\_code module}
\label{\detokenize{modules.security:module-modules.security.scan_code}}\label{\detokenize{modules.security:modules-security-scan-code-module}}\index{module@\spxentry{module}!modules.security.scan\_code@\spxentry{modules.security.scan\_code}}\index{modules.security.scan\_code@\spxentry{modules.security.scan\_code}!module@\spxentry{module}}
\sphinxAtStartPar
This module provides a function to run a security scan on a specified source code directory using Bandit.

\sphinxAtStartPar
Bandit is a tool designed to find common security issues in Python code. This module uses the \sphinxtitleref{poetry} package
to execute the Bandit scan on a specified directory (\sphinxtitleref{modules/data\_storage}).

\sphinxAtStartPar
Main function:
\sphinxhyphen{} \sphinxtitleref{run\_bandit\_scan}: Executes Bandit on the source code directory to identify security issues.

\sphinxAtStartPar
To run this module:
\sphinxhyphen{} Execute it as the main program using the \sphinxtitleref{if \_\_name\_\_ == “\_\_main\_\_”:} block.
\index{run\_bandit\_scan() (in module modules.security.scan\_code)@\spxentry{run\_bandit\_scan()}\spxextra{in module modules.security.scan\_code}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.security:modules.security.scan_code.run_bandit_scan}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.security.scan\_code.}}\sphinxbfcode{\sphinxupquote{run\_bandit\_scan}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Executes a security scan on the source code directory using Bandit.

\sphinxAtStartPar
This function runs the Bandit tool on the \sphinxtitleref{modules/data\_storage} directory, scanning the Python source code
for common security issues. It uses \sphinxtitleref{poetry} to execute the scan.

\sphinxAtStartPar
The Bandit scan helps identify potential security flaws, such as improper handling of inputs, hardcoded
passwords, insecure cryptographic practices, and more.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
None

\sphinxlineitem{Return type}
\sphinxAtStartPar
None

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{modules.security.scan\_dependencies module}
\label{\detokenize{modules.security:module-modules.security.scan_dependencies}}\label{\detokenize{modules.security:modules-security-scan-dependencies-module}}\index{module@\spxentry{module}!modules.security.scan\_dependencies@\spxentry{modules.security.scan\_dependencies}}\index{modules.security.scan\_dependencies@\spxentry{modules.security.scan\_dependencies}!module@\spxentry{module}}
\sphinxAtStartPar
This module provides a function to run a security check on the project dependencies using Safety.

\sphinxAtStartPar
Safety is a tool for checking Python dependencies for known security vulnerabilities. This module uses \sphinxtitleref{poetry}
to execute the Safety check command.

\sphinxAtStartPar
Main function:
\sphinxhyphen{} \sphinxtitleref{run\_safety\_check}: Executes Safety to check for known security issues in the project dependencies.

\sphinxAtStartPar
To run this module:
\sphinxhyphen{} Execute it as the main program using the \sphinxtitleref{if \_\_name\_\_ == “\_\_main\_\_”:} block.
\index{run\_safety\_check() (in module modules.security.scan\_dependencies)@\spxentry{run\_safety\_check()}\spxextra{in module modules.security.scan\_dependencies}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules.security:modules.security.scan_dependencies.run_safety_check}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{modules.security.scan\_dependencies.}}\sphinxbfcode{\sphinxupquote{run\_safety\_check}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Executes a security check on the project dependencies using Safety.

\sphinxAtStartPar
This function runs the Safety tool, which checks the project’s dependencies for known security vulnerabilities.
The check is executed using \sphinxtitleref{poetry} as the package manager to run the Safety command.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
None

\sphinxlineitem{Return type}
\sphinxAtStartPar
None

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{Module contents}
\label{\detokenize{modules.security:module-modules.security}}\label{\detokenize{modules.security:module-contents}}\index{module@\spxentry{module}!modules.security@\spxentry{modules.security}}\index{modules.security@\spxentry{modules.security}!module@\spxentry{module}}

\section{Module contents}
\label{\detokenize{modules:module-modules}}\label{\detokenize{modules:module-contents}}\index{module@\spxentry{module}!modules@\spxentry{modules}}\index{modules@\spxentry{modules}!module@\spxentry{module}}
\sphinxstepscope


\chapter{my\_fastapi package}
\label{\detokenize{my_fastapi:my-fastapi-package}}\label{\detokenize{my_fastapi::doc}}

\section{Submodules}
\label{\detokenize{my_fastapi:submodules}}

\section{my\_fastapi.main module}
\label{\detokenize{my_fastapi:module-my_fastapi.main}}\label{\detokenize{my_fastapi:my-fastapi-main-module}}\index{module@\spxentry{module}!my\_fastapi.main@\spxentry{my\_fastapi.main}}\index{my\_fastapi.main@\spxentry{my\_fastapi.main}!module@\spxentry{module}}
\sphinxAtStartPar
This module defines a FastAPI application that serves as an API for accessing CSR (Corporate Social Responsibility) data.
It includes endpoints for querying CSR indicators, CSR data, and company reports from a PostgreSQL database.
Additionally, it serves static files for frontend development and includes CORS configuration for cross\sphinxhyphen{}origin requests.

\sphinxAtStartPar
Main functionality:
\sphinxhyphen{} CORS setup for allowing specific origins.
\sphinxhyphen{} Static file serving for frontend deployment (React).
\sphinxhyphen{} Database connections and query execution using psycopg2.
\sphinxhyphen{} API endpoints for accessing and querying CSR data, indicators, and reports.

\sphinxAtStartPar
To run the application:
\sphinxhyphen{} Run \sphinxtitleref{poetry run uvicorn my\_fastapi.main:app \textendash{}host 0.0.0.0 \textendash{}port 8000 \textendash{}reload}
\sphinxhyphen{} Run \sphinxtitleref{ngrok http \textendash{}url=csr.jacaranda.ngrok.app 8000}
\sphinxhyphen{} Access Swagger UI at \sphinxtitleref{http://127.0.0.1:8000/docs}
\sphinxhyphen{} Original JSON schema can be found at \sphinxtitleref{http://127.0.0.1:8000/openapi.json}
\index{get\_all\_company\_reports() (in module my\_fastapi.main)@\spxentry{get\_all\_company\_reports()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.get_all_company_reports}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{get\_all\_company\_reports}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Retrieves all company reports from the database.

\sphinxAtStartPar
This endpoint queries the \sphinxtitleref{csr\_reporting.company\_reports} table and returns all rows ordered by \sphinxtitleref{id}.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
A list of company reports.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_all\_data() (in module my\_fastapi.main)@\spxentry{get\_all\_data()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.get_all_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{get\_all\_data}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Retrieves all CSR data from the database.

\sphinxAtStartPar
This endpoint queries the \sphinxtitleref{csr\_reporting.CSR\_Data} table and returns the first 100 rows ordered by \sphinxtitleref{data\_id}.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
A list of CSR data entries.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_all\_indicators() (in module my\_fastapi.main)@\spxentry{get\_all\_indicators()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.get_all_indicators}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{get\_all\_indicators}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Retrieves all CSR indicators from the database.

\sphinxAtStartPar
This endpoint queries the \sphinxtitleref{csr\_reporting.CSR\_indicators} table and returns all rows ordered by \sphinxtitleref{indicator\_id}.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
A list of CSR indicators from the database.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_company\_report\_by\_id() (in module my\_fastapi.main)@\spxentry{get\_company\_report\_by\_id()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.get_company_report_by_id}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{get\_company\_report\_by\_id}}}
{\sphinxparam{\DUrole{n}{report\_id}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Retrieves a specific company report by its ID.

\sphinxAtStartPar
This endpoint queries the \sphinxtitleref{csr\_reporting.company\_reports} table for a record with the specified \sphinxtitleref{report\_id}.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{report\_id}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The ID of the company report to retrieve.

\sphinxlineitem{Returns}
\sphinxAtStartPar
The company report with the specified ID.

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{HTTPException}} \textendash{} If no company report is found with the given ID.

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_data\_by\_id() (in module my\_fastapi.main)@\spxentry{get\_data\_by\_id()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.get_data_by_id}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{get\_data\_by\_id}}}
{\sphinxparam{\DUrole{n}{data\_id}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Retrieves a specific CSR data entry by its ID.

\sphinxAtStartPar
This endpoint queries the \sphinxtitleref{csr\_reporting.CSR\_Data} table for a record with the specified \sphinxtitleref{data\_id}.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{data\_id}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The ID of the data entry to retrieve.

\sphinxlineitem{Returns}
\sphinxAtStartPar
The CSR data entry with the specified ID.

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{HTTPException}} \textendash{} If no data entry is found with the given ID.

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_db() (in module my\_fastapi.main)@\spxentry{get\_db()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.get_db}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{get\_db}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Establishes and returns a connection to the PostgreSQL database.

\sphinxAtStartPar
This function connects to the database using the credentials and configuration defined
in the \sphinxtitleref{db\_config} dictionary. It is used to execute queries against the database.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
A database connection object.

\sphinxlineitem{Return type}
\sphinxAtStartPar
psycopg2.extensions.connection

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_indicator\_by\_id() (in module my\_fastapi.main)@\spxentry{get\_indicator\_by\_id()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.get_indicator_by_id}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{get\_indicator\_by\_id}}}
{\sphinxparam{\DUrole{n}{indicator\_id}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Retrieves a specific CSR indicator by its ID.

\sphinxAtStartPar
This endpoint queries the \sphinxtitleref{csr\_reporting.CSR\_indicators} table for a record with the specified \sphinxtitleref{indicator\_id}.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indicator\_id}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The ID of the indicator to retrieve.

\sphinxlineitem{Returns}
\sphinxAtStartPar
The CSR indicator with the specified ID.

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{HTTPException}} \textendash{} If no indicator is found with the given ID.

\end{description}\end{quote}

\end{fulllineitems}

\index{query\_db() (in module my\_fastapi.main)@\spxentry{query\_db()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.query_db}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{query\_db}}}
{\sphinxparam{\DUrole{n}{query}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}}\sphinxparamcomma \sphinxparam{\DUrole{n}{params}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{tuple\DUrole{w}{ }\DUrole{p}{|}\DUrole{w}{ }None}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Executes a query on the database and returns the results.

\sphinxAtStartPar
This function executes a given SQL query on the database using the provided parameters
and returns the results as a list of dictionaries.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{query}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The SQL query to execute.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{params}} (\sphinxstyleliteralemphasis{\sphinxupquote{Optional}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} Optional parameters to pass to the query, defaults to None.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
The results of the query as a list of dictionaries.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{search\_data() (in module my\_fastapi.main)@\spxentry{search\_data()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.search_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{search\_data}}}
{\sphinxparam{\DUrole{n}{security}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str\DUrole{w}{ }\DUrole{p}{|}\DUrole{w}{ }None}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{Query(None)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{report\_year}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int\DUrole{w}{ }\DUrole{p}{|}\DUrole{w}{ }None}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{Query(None)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{indicator\_id}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int\DUrole{w}{ }\DUrole{p}{|}\DUrole{w}{ }None}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{Query(None)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{indicator\_name}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str\DUrole{w}{ }\DUrole{p}{|}\DUrole{w}{ }None}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{Query(None)}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Searches CSR data based on optional query parameters.

\sphinxAtStartPar
This endpoint allows filtering CSR data by security, report year, indicator ID, and/or indicator name.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{security}} (\sphinxstyleliteralemphasis{\sphinxupquote{Optional}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} The security of the data to search for (optional).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{report\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{Optional}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} The report year of the data to search for (optional).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indicator\_id}} (\sphinxstyleliteralemphasis{\sphinxupquote{Optional}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} The ID of the indicator to search for (optional).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indicator\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Optional}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} The name of the indicator to search for (optional).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
A list of filtered CSR data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{search\_indicators() (in module my\_fastapi.main)@\spxentry{search\_indicators()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.search_indicators}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{search\_indicators}}}
{\sphinxparam{\DUrole{n}{indicator\_name}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str\DUrole{w}{ }\DUrole{p}{|}\DUrole{w}{ }None}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{Query(None)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{theme}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str\DUrole{w}{ }\DUrole{p}{|}\DUrole{w}{ }None}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{Query(None)}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Searches CSR indicators based on optional query parameters.

\sphinxAtStartPar
This endpoint allows filtering CSR indicators by name and/or theme. It queries the \sphinxtitleref{csr\_reporting.CSR\_indicators}
table and applies the provided filters.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indicator\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Optional}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} The name of the indicator to search for (optional).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{theme}} (\sphinxstyleliteralemphasis{\sphinxupquote{Optional}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} The theme of the indicator to search for (optional).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
A list of filtered CSR indicators.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{search\_reports() (in module my\_fastapi.main)@\spxentry{search\_reports()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.search_reports}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{search\_reports}}}
{\sphinxparam{\DUrole{n}{symbol}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str\DUrole{w}{ }\DUrole{p}{|}\DUrole{w}{ }None}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{Query(None)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{security}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str\DUrole{w}{ }\DUrole{p}{|}\DUrole{w}{ }None}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{Query(None)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{report\_year}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int\DUrole{w}{ }\DUrole{p}{|}\DUrole{w}{ }None}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{Query(None)}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Searches company reports based on optional query parameters.

\sphinxAtStartPar
This endpoint allows filtering company reports by symbol, security, and/or report year.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{symbol}} (\sphinxstyleliteralemphasis{\sphinxupquote{Optional}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} The symbol of the report to search for (optional).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{security}} (\sphinxstyleliteralemphasis{\sphinxupquote{Optional}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} The security of the report to search for (optional).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{report\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{Optional}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{{]}}}) \textendash{} The report year of the report to search for (optional).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
A list of filtered company reports.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{serve\_frontend() (in module my\_fastapi.main)@\spxentry{serve\_frontend()}\spxextra{in module my\_fastapi.main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{my_fastapi:my_fastapi.main.serve_frontend}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{my\_fastapi.main.}}\sphinxbfcode{\sphinxupquote{serve\_frontend}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Serves the React frontend’s \sphinxtitleref{index.html} file.

\sphinxAtStartPar
This endpoint is used to serve the frontend React application after it has been built
and deployed to the server.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
The \sphinxtitleref{index.html} file of the React frontend.

\sphinxlineitem{Return type}
\sphinxAtStartPar
FileResponse

\end{description}\end{quote}

\end{fulllineitems}



\section{Module contents}
\label{\detokenize{my_fastapi:module-my_fastapi}}\label{\detokenize{my_fastapi:module-contents}}\index{module@\spxentry{module}!my\_fastapi@\spxentry{my\_fastapi}}\index{my\_fastapi@\spxentry{my\_fastapi}!module@\spxentry{module}}
\sphinxstepscope


\chapter{test package}
\label{\detokenize{test:test-package}}\label{\detokenize{test::doc}}

\section{Subpackages}
\label{\detokenize{test:subpackages}}
\sphinxstepscope


\subsection{test.data\_storage package}
\label{\detokenize{test.data_storage:test-data-storage-package}}\label{\detokenize{test.data_storage::doc}}

\subsubsection{Submodules}
\label{\detokenize{test.data_storage:submodules}}

\subsubsection{test.data\_storage.conftest module}
\label{\detokenize{test.data_storage:module-test.data_storage.conftest}}\label{\detokenize{test.data_storage:test-data-storage-conftest-module}}\index{module@\spxentry{module}!test.data\_storage.conftest@\spxentry{test.data\_storage.conftest}}\index{test.data\_storage.conftest@\spxentry{test.data\_storage.conftest}!module@\spxentry{module}}
\sphinxAtStartPar
This module provides test fixtures used by pytest for testing the \sphinxtitleref{modules.data\_storage} functionality.

\sphinxAtStartPar
Test Fixtures:
\sphinxhyphen{} \sphinxtitleref{mock\_db\_connection}: Mocks a PostgreSQL database connection for testing purposes.
\sphinxhyphen{} \sphinxtitleref{monkeypatch\_env}: Mocks the environment variable \sphinxtitleref{DEEPSEEK\_API\_KEY} for tests.

\sphinxAtStartPar
These fixtures help simulate interactions with external dependencies like a database and environment variables.
\index{mock\_db\_connection() (in module test.data\_storage.conftest)@\spxentry{mock\_db\_connection()}\spxextra{in module test.data\_storage.conftest}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.conftest.mock_db_connection}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.conftest.}}\sphinxbfcode{\sphinxupquote{mock\_db\_connection}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Mocks a PostgreSQL database connection for testing.

\sphinxAtStartPar
This fixture patches the \sphinxtitleref{psycopg2.connect} function to return a fake connection and cursor.
The cursor’s \sphinxtitleref{fetchall}, \sphinxtitleref{fetchone}, and \sphinxtitleref{execute} methods are mocked to simulate query results
without needing an actual database connection.

\sphinxAtStartPar
This fixture is scoped to the module, meaning it is created once per test module.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
A mocked database connection.

\sphinxlineitem{Return type}
\sphinxAtStartPar
MagicMock

\end{description}\end{quote}

\end{fulllineitems}

\index{monkeypatch\_env() (in module test.data\_storage.conftest)@\spxentry{monkeypatch\_env()}\spxextra{in module test.data\_storage.conftest}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.conftest.monkeypatch_env}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.conftest.}}\sphinxbfcode{\sphinxupquote{monkeypatch\_env}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Mocks the \sphinxtitleref{DEEPSEEK\_API\_KEY} environment variable for testing.

\sphinxAtStartPar
This fixture uses the \sphinxtitleref{monkeypatch} fixture to set the environment variable \sphinxtitleref{DEEPSEEK\_API\_KEY}
to a mock value (\sphinxtitleref{“mock\sphinxhyphen{}key”}) during testing. This allows tests to simulate the presence
of the environment variable without requiring an actual key.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} \textendash{} The pytest monkeypatch fixture.

\sphinxlineitem{Returns}
\sphinxAtStartPar
None

\sphinxlineitem{Return type}
\sphinxAtStartPar
None

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{test.data\_storage.test\_create\_table module}
\label{\detokenize{test.data_storage:module-test.data_storage.test_create_table}}\label{\detokenize{test.data_storage:test-data-storage-test-create-table-module}}\index{module@\spxentry{module}!test.data\_storage.test\_create\_table@\spxentry{test.data\_storage.test\_create\_table}}\index{test.data\_storage.test\_create\_table@\spxentry{test.data\_storage.test\_create\_table}!module@\spxentry{module}}
\sphinxAtStartPar
Module to simulate database connection and cursor behavior using dummy objects.
It includes tests for successful table creation, insert failures, and connection failures.
\index{DummyConnection (class in test.data\_storage.test\_create\_table)@\spxentry{DummyConnection}\spxextra{class in test.data\_storage.test\_create\_table}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.DummyConnection}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{test.data\_storage.test\_create\_table.}}\sphinxbfcode{\sphinxupquote{DummyConnection}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A dummy connection class to simulate database connection behavior for testing purposes.
\index{cursor\_obj (test.data\_storage.test\_create\_table.DummyConnection attribute)@\spxentry{cursor\_obj}\spxextra{test.data\_storage.test\_create\_table.DummyConnection attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.DummyConnection.cursor_obj}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{cursor\_obj}}}
\pysigstopsignatures
\sphinxAtStartPar
The dummy cursor object used for executing queries.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
{\hyperref[\detokenize{test.data_storage:test.data_storage.test_create_table.DummyCursor}]{\sphinxcrossref{DummyCursor}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{committed (test.data\_storage.test\_create\_table.DummyConnection attribute)@\spxentry{committed}\spxextra{test.data\_storage.test\_create\_table.DummyConnection attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.DummyConnection.committed}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{committed}}}
\pysigstopsignatures
\sphinxAtStartPar
A flag indicating whether the connection has been committed.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{closed (test.data\_storage.test\_create\_table.DummyConnection attribute)@\spxentry{closed}\spxextra{test.data\_storage.test\_create\_table.DummyConnection attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.DummyConnection.closed}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{closed}}}
\pysigstopsignatures
\sphinxAtStartPar
A flag indicating whether the connection has been closed.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{close() (test.data\_storage.test\_create\_table.DummyConnection method)@\spxentry{close()}\spxextra{test.data\_storage.test\_create\_table.DummyConnection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.DummyConnection.close}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{close}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulates closing the connection by setting the closed flag to True.

\end{fulllineitems}

\index{commit() (test.data\_storage.test\_create\_table.DummyConnection method)@\spxentry{commit()}\spxextra{test.data\_storage.test\_create\_table.DummyConnection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.DummyConnection.commit}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{commit}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulates committing a transaction by setting the committed flag to True.

\end{fulllineitems}

\index{cursor() (test.data\_storage.test\_create\_table.DummyConnection method)@\spxentry{cursor()}\spxextra{test.data\_storage.test\_create\_table.DummyConnection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.DummyConnection.cursor}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cursor}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Returns the cursor object associated with the connection.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
The cursor object for executing queries.

\sphinxlineitem{Return type}
\sphinxAtStartPar
{\hyperref[\detokenize{test.data_storage:test.data_storage.test_create_table.DummyCursor}]{\sphinxcrossref{DummyCursor}}}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{DummyCursor (class in test.data\_storage.test\_create\_table)@\spxentry{DummyCursor}\spxextra{class in test.data\_storage.test\_create\_table}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.DummyCursor}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{test.data\_storage.test\_create\_table.}}\sphinxbfcode{\sphinxupquote{DummyCursor}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A dummy cursor class to simulate database cursor behavior for testing purposes.
\index{executed\_queries (test.data\_storage.test\_create\_table.DummyCursor attribute)@\spxentry{executed\_queries}\spxextra{test.data\_storage.test\_create\_table.DummyCursor attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.DummyCursor.executed_queries}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{executed\_queries}}}
\pysigstopsignatures
\sphinxAtStartPar
A list that records SQL queries that were executed.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{execute() (test.data\_storage.test\_create\_table.DummyCursor method)@\spxentry{execute()}\spxextra{test.data\_storage.test\_create\_table.DummyCursor method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.DummyCursor.execute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{execute}}}
{\sphinxparam{\DUrole{n}{query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulates executing an SQL query by recording it in the executed\_queries list.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{query}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The SQL query to be executed.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{test\_create\_table\_connection\_failure() (in module test.data\_storage.test\_create\_table)@\spxentry{test\_create\_table\_connection\_failure()}\spxextra{in module test.data\_storage.test\_create\_table}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.test_create_table_connection_failure}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_create\_table.}}\sphinxbfcode{\sphinxupquote{test\_create\_table\_connection\_failure}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}\sphinxparamcomma \sphinxparam{\DUrole{n}{capsys}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case for a database connection failure.

\sphinxAtStartPar
Simulates a scenario where the database connection fails, and verifies
that the appropriate error message is logged and the connection is handled correctly.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} (\sphinxstyleliteralemphasis{\sphinxupquote{MonkeyPatch}}) \textendash{} A pytest fixture to modify functions or objects at runtime.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{capsys}} (\sphinxstyleliteralemphasis{\sphinxupquote{CaptureFixture}}) \textendash{} A pytest fixture to capture system outputs.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_create\_table\_insert\_failure() (in module test.data\_storage.test\_create\_table)@\spxentry{test\_create\_table\_insert\_failure()}\spxextra{in module test.data\_storage.test\_create\_table}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.test_create_table_insert_failure}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_create\_table.}}\sphinxbfcode{\sphinxupquote{test\_create\_table\_insert\_failure}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}\sphinxparamcomma \sphinxparam{\DUrole{n}{capsys}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case for a failure during the data insertion phase.

\sphinxAtStartPar
Simulates a scenario where data insertion fails, and verifies that the
appropriate error message is logged and the connection is closed.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} (\sphinxstyleliteralemphasis{\sphinxupquote{MonkeyPatch}}) \textendash{} A pytest fixture to modify functions or objects at runtime.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{capsys}} (\sphinxstyleliteralemphasis{\sphinxupquote{CaptureFixture}}) \textendash{} A pytest fixture to capture system outputs.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_create\_table\_success() (in module test.data\_storage.test\_create\_table)@\spxentry{test\_create\_table\_success()}\spxextra{in module test.data\_storage.test\_create\_table}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_create_table.test_create_table_success}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_create\_table.}}\sphinxbfcode{\sphinxupquote{test\_create\_table\_success}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}\sphinxparamcomma \sphinxparam{\DUrole{n}{capsys}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case for successfully creating a table and inserting data.

\sphinxAtStartPar
Simulates the scenario where the table creation and data insertion
are successful, and verifies the correct output and connection behavior.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} (\sphinxstyleliteralemphasis{\sphinxupquote{MonkeyPatch}}) \textendash{} A pytest fixture to modify functions or objects at runtime.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{capsys}} (\sphinxstyleliteralemphasis{\sphinxupquote{CaptureFixture}}) \textendash{} A pytest fixture to capture system outputs.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{test.data\_storage.test\_data\_export module}
\label{\detokenize{test.data_storage:module-test.data_storage.test_data_export}}\label{\detokenize{test.data_storage:test-data-storage-test-data-export-module}}\index{module@\spxentry{module}!test.data\_storage.test\_data\_export@\spxentry{test.data\_storage.test\_data\_export}}\index{test.data\_storage.test\_data\_export@\spxentry{test.data\_storage.test\_data\_export}!module@\spxentry{module}}
\sphinxAtStartPar
Module: data\_export\_tests

\sphinxAtStartPar
This module contains test functions for testing the functionalities
of the data export module in the \sphinxtitleref{data\_export} package. It tests
the SQL query formation for exporting tables, the export process,
and the correct execution of the \sphinxtitleref{main()} function.

\sphinxAtStartPar
The tests mock dependencies like the database connection and pandas
DataFrame methods to validate the correct behavior of the export logic.
\index{test\_export\_table\_query\_with\_order() (in module test.data\_storage.test\_data\_export)@\spxentry{test\_export\_table\_query\_with\_order()}\spxextra{in module test.data\_storage.test\_data\_export}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_data_export.test_export_table_query_with_order}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_data\_export.}}\sphinxbfcode{\sphinxupquote{test\_export\_table\_query\_with\_order}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test that the query string correctly appends the ORDER BY clause
when there are default order columns.

\sphinxAtStartPar
This test simulates the execution of a query with a default order
column (e.g., “ORDER BY id”) and verifies that the \sphinxtitleref{export\_table\_to\_csv}
function appends the ORDER BY clause in the query. It also checks if the
query is correctly passed to the pandas \sphinxtitleref{read\_sql\_query} function and if
the \sphinxtitleref{to\_csv} method is invoked with the correct path.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} \textendash{} The monkeypatch fixture provided by pytest.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_export\_table\_query\_without\_order() (in module test.data\_storage.test\_data\_export)@\spxentry{test\_export\_table\_query\_without\_order()}\spxextra{in module test.data\_storage.test\_data\_export}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_data_export.test_export_table_query_without_order}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_data\_export.}}\sphinxbfcode{\sphinxupquote{test\_export\_table\_query\_without\_order}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test that the query string does not include the ORDER BY clause
when there are no default order columns.

\sphinxAtStartPar
This test simulates the execution of a query without a default order
column and ensures that the \sphinxtitleref{export\_table\_to\_csv} function does not
append the ORDER BY clause to the query. It also checks that the
\sphinxtitleref{to\_csv} method is still called correctly.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} \textendash{} The monkeypatch fixture provided by pytest.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_main\_exports\_all\_tables() (in module test.data\_storage.test\_data\_export)@\spxentry{test\_main\_exports\_all\_tables()}\spxextra{in module test.data\_storage.test\_data\_export}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_data_export.test_main_exports_all_tables}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_data\_export.}}\sphinxbfcode{\sphinxupquote{test\_main\_exports\_all\_tables}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the main() function to ensure it exports all tables in order
and closes the connection.

\sphinxAtStartPar
This test simulates the process of exporting all tables by calling
the \sphinxtitleref{main} function and verifies that all expected tables are exported.
It also ensures that the database connection is closed after the export
process is complete.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} \textendash{} The monkeypatch fixture provided by pytest.

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{test.data\_storage.test\_data\_storage\_pipeline module}
\label{\detokenize{test.data_storage:module-test.data_storage.test_data_storage_pipeline}}\label{\detokenize{test.data_storage:test-data-storage-test-data-storage-pipeline-module}}\index{module@\spxentry{module}!test.data\_storage.test\_data\_storage\_pipeline@\spxentry{test.data\_storage.test\_data\_storage\_pipeline}}\index{test.data\_storage.test\_data\_storage\_pipeline@\spxentry{test.data\_storage.test\_data\_storage\_pipeline}!module@\spxentry{module}}
\sphinxAtStartPar
Module: main\_tests

\sphinxAtStartPar
This module contains unit tests for the main module of the data storage
system. It tests various aspects of the main module’s functionality, such
as reading and writing completed modules, running shell commands, handling
module execution, and ensuring correct pipeline behavior.

\sphinxAtStartPar
Tests use pytest’s monkeypatching and mocking techniques to simulate
various scenarios and edge cases.

\sphinxAtStartPar
Each function is designed to ensure the main module performs as expected
under different conditions, including success and failure cases.
\index{test\_main\_pipeline\_failure() (in module test.data\_storage.test\_data\_storage\_pipeline)@\spxentry{test\_main\_pipeline\_failure()}\spxextra{in module test.data\_storage.test\_data\_storage\_pipeline}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_data_storage_pipeline.test_main_pipeline_failure}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_data\_storage\_pipeline.}}\sphinxbfcode{\sphinxupquote{test\_main\_pipeline\_failure}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test that the main function exits with an error when a module fails.

\end{fulllineitems}

\index{test\_main\_skip\_and\_execute() (in module test.data\_storage.test\_data\_storage\_pipeline)@\spxentry{test\_main\_skip\_and\_execute()}\spxextra{in module test.data\_storage.test\_data\_storage\_pipeline}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_data_storage_pipeline.test_main_skip_and_execute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_data\_storage\_pipeline.}}\sphinxbfcode{\sphinxupquote{test\_main\_skip\_and\_execute}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the main function to ensure that already completed modules are skipped
and that the remaining modules are executed in the correct order.

\end{fulllineitems}

\index{test\_read\_completed\_modules() (in module test.data\_storage.test\_data\_storage\_pipeline)@\spxentry{test\_read\_completed\_modules()}\spxextra{in module test.data\_storage.test\_data\_storage\_pipeline}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_data_storage_pipeline.test_read_completed_modules}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_data\_storage\_pipeline.}}\sphinxbfcode{\sphinxupquote{test\_read\_completed\_modules}}}
{\sphinxparam{\DUrole{n}{tmp\_path}}\sphinxparamcomma \sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test that the read\_completed\_modules function behaves correctly when
the file does or does not exist.

\end{fulllineitems}

\index{test\_run\_command\_success\_and\_failure() (in module test.data\_storage.test\_data\_storage\_pipeline)@\spxentry{test\_run\_command\_success\_and\_failure()}\spxextra{in module test.data\_storage.test\_data\_storage\_pipeline}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_data_storage_pipeline.test_run_command_success_and_failure}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_data\_storage\_pipeline.}}\sphinxbfcode{\sphinxupquote{test\_run\_command\_success\_and\_failure}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the run\_command function for both success and failure scenarios.

\end{fulllineitems}

\index{test\_write\_completed\_module() (in module test.data\_storage.test\_data\_storage\_pipeline)@\spxentry{test\_write\_completed\_module()}\spxextra{in module test.data\_storage.test\_data\_storage\_pipeline}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_data_storage_pipeline.test_write_completed_module}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_data\_storage\_pipeline.}}\sphinxbfcode{\sphinxupquote{test\_write\_completed\_module}}}
{\sphinxparam{\DUrole{n}{tmp\_path}}\sphinxparamcomma \sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test that the write\_completed\_module function correctly appends module
names to the completed file.

\end{fulllineitems}



\subsubsection{test.data\_storage.test\_llm\_analyse module}
\label{\detokenize{test.data_storage:module-test.data_storage.test_llm_analyse}}\label{\detokenize{test.data_storage:test-data-storage-test-llm-analyse-module}}\index{module@\spxentry{module}!test.data\_storage.test\_llm\_analyse@\spxentry{test.data\_storage.test\_llm\_analyse}}\index{test.data\_storage.test\_llm\_analyse@\spxentry{test.data\_storage.test\_llm\_analyse}!module@\spxentry{module}}
\sphinxAtStartPar
Module for testing the LLM (Large Language Model) analysis functions.
This module contains various test cases to ensure the correct behavior of
functions like build\_prompt, process\_row, update\_result, and others in
the llm\_analyse module.
\index{DummyConnection (class in test.data\_storage.test\_llm\_analyse)@\spxentry{DummyConnection}\spxextra{class in test.data\_storage.test\_llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.DummyConnection}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_analyse.}}\sphinxbfcode{\sphinxupquote{DummyConnection}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A dummy database connection class to simulate database connection behavior.

\sphinxAtStartPar
This class is used to simulate database connection operations during testing.
\index{close() (test.data\_storage.test\_llm\_analyse.DummyConnection method)@\spxentry{close()}\spxextra{test.data\_storage.test\_llm\_analyse.DummyConnection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.DummyConnection.close}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{close}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulate closing the connection.

\end{fulllineitems}

\index{commit() (test.data\_storage.test\_llm\_analyse.DummyConnection method)@\spxentry{commit()}\spxextra{test.data\_storage.test\_llm\_analyse.DummyConnection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.DummyConnection.commit}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{commit}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulate committing a transaction.

\end{fulllineitems}

\index{cursor() (test.data\_storage.test\_llm\_analyse.DummyConnection method)@\spxentry{cursor()}\spxextra{test.data\_storage.test\_llm\_analyse.DummyConnection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.DummyConnection.cursor}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cursor}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulate getting a cursor from the connection.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
A dummy cursor instance.

\sphinxlineitem{Return type}
\sphinxAtStartPar
{\hyperref[\detokenize{test.data_storage:test.data_storage.test_llm_analyse.DummyCursor}]{\sphinxcrossref{DummyCursor}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{rollback() (test.data\_storage.test\_llm\_analyse.DummyConnection method)@\spxentry{rollback()}\spxextra{test.data\_storage.test\_llm\_analyse.DummyConnection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.DummyConnection.rollback}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{rollback}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulate rolling back a transaction.

\end{fulllineitems}


\end{fulllineitems}

\index{DummyCursor (class in test.data\_storage.test\_llm\_analyse)@\spxentry{DummyCursor}\spxextra{class in test.data\_storage.test\_llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.DummyCursor}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_analyse.}}\sphinxbfcode{\sphinxupquote{DummyCursor}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A dummy database cursor class to simulate database cursor behavior.

\sphinxAtStartPar
This class is used to simulate cursor behavior for database operations
during testing, specifically for testing the update\_result function.
\index{execute() (test.data\_storage.test\_llm\_analyse.DummyCursor method)@\spxentry{execute()}\spxextra{test.data\_storage.test\_llm\_analyse.DummyCursor method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.DummyCursor.execute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{execute}}}
{\sphinxparam{\DUrole{n}{query}}\sphinxparamcomma \sphinxparam{\DUrole{n}{params}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulate executing a database query.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{query}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The SQL query string to be executed.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{params}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} The parameters to be passed to the query.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{test\_build\_prompt\_target\_vs\_non\_target() (in module test.data\_storage.test\_llm\_analyse)@\spxentry{test\_build\_prompt\_target\_vs\_non\_target()}\spxextra{in module test.data\_storage.test\_llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.test_build_prompt_target_vs_non_target}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_analyse.}}\sphinxbfcode{\sphinxupquote{test\_build\_prompt\_target\_vs\_non\_target}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the build\_prompt function for target vs non\sphinxhyphen{}target classes.

\sphinxAtStartPar
This test verifies that the output prompt varies based on whether the
target class is specified or not.

\end{fulllineitems}

\index{test\_is\_valid\_number() (in module test.data\_storage.test\_llm\_analyse)@\spxentry{test\_is\_valid\_number()}\spxextra{in module test.data\_storage.test\_llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.test_is_valid_number}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_analyse.}}\sphinxbfcode{\sphinxupquote{test\_is\_valid\_number}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the is\_valid\_number function for valid and invalid number inputs.

\sphinxAtStartPar
This test checks if the function correctly identifies valid numeric values
and handles invalid inputs like strings, None, or empty values.

\end{fulllineitems}

\index{test\_main\_concurrent\_processing() (in module test.data\_storage.test\_llm\_analyse)@\spxentry{test\_main\_concurrent\_processing()}\spxextra{in module test.data\_storage.test\_llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.test_main_concurrent_processing}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_analyse.}}\sphinxbfcode{\sphinxupquote{test\_main\_concurrent\_processing}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}\sphinxparamcomma \sphinxparam{\DUrole{n}{capsys}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the main function with concurrent processing logic, including both successful
and failed tasks.

\sphinxAtStartPar
This test simulates a multi\sphinxhyphen{}threaded environment where multiple rows are processed concurrently,
some successfully and some failing, and verifies the expected output messages.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} (\sphinxstyleliteralemphasis{\sphinxupquote{pytest.MonkeyPatch}}) \textendash{} The monkeypatch object for mocking.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{capsys}} (\sphinxstyleliteralemphasis{\sphinxupquote{pytest.CaptureFixture}}) \textendash{} The capture fixture to capture the standard output.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_process\_row\_nontarget\_invalid\_number() (in module test.data\_storage.test\_llm\_analyse)@\spxentry{test\_process\_row\_nontarget\_invalid\_number()}\spxextra{in module test.data\_storage.test\_llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.test_process_row_nontarget_invalid_number}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_analyse.}}\sphinxbfcode{\sphinxupquote{test\_process\_row\_nontarget\_invalid\_number}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test process\_row function with target set to False and invalid number in the LLM output.

\sphinxAtStartPar
This test verifies that the function raises a ValueError and performs a rollback when
the output is a non\sphinxhyphen{}numeric value for a non\sphinxhyphen{}target row.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} (\sphinxstyleliteralemphasis{\sphinxupquote{pytest.MonkeyPatch}}) \textendash{} The monkeypatch object for mocking.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_process\_row\_nontarget\_json\_error() (in module test.data\_storage.test\_llm\_analyse)@\spxentry{test\_process\_row\_nontarget\_json\_error()}\spxextra{in module test.data\_storage.test\_llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.test_process_row_nontarget_json_error}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_analyse.}}\sphinxbfcode{\sphinxupquote{test\_process\_row\_nontarget\_json\_error}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test process\_row function with target set to False and invalid JSON format.

\sphinxAtStartPar
This test checks if the function raises a JSONDecodeError when the LLM output is
an invalid JSON string and performs a rollback.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} (\sphinxstyleliteralemphasis{\sphinxupquote{pytest.MonkeyPatch}}) \textendash{} The monkeypatch object for mocking.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_process\_row\_target\_json\_and\_nonjson() (in module test.data\_storage.test\_llm\_analyse)@\spxentry{test\_process\_row\_target\_json\_and\_nonjson()}\spxextra{in module test.data\_storage.test\_llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.test_process_row_target_json_and_nonjson}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_analyse.}}\sphinxbfcode{\sphinxupquote{test\_process\_row\_target\_json\_and\_nonjson}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test process\_row function with target set to True for both valid and invalid JSON outputs.

\sphinxAtStartPar
This test checks if the function handles cases where the LLM returns valid JSON
or invalid JSON, and ensures that the appropriate values are passed for updating
the database.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} (\sphinxstyleliteralemphasis{\sphinxupquote{pytest.MonkeyPatch}}) \textendash{} The monkeypatch object for mocking.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_process\_row\_target\_non\_str\_output() (in module test.data\_storage.test\_llm\_analyse)@\spxentry{test\_process\_row\_target\_non\_str\_output()}\spxextra{in module test.data\_storage.test\_llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.test_process_row_target_non_str_output}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_analyse.}}\sphinxbfcode{\sphinxupquote{test\_process\_row\_target\_non\_str\_output}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test process\_row function with target set to True when LLM outputs a non\sphinxhyphen{}string type.

\sphinxAtStartPar
This test ensures that the function correctly handles non\sphinxhyphen{}string types like bytes
and processes them appropriately without errors.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} (\sphinxstyleliteralemphasis{\sphinxupquote{pytest.MonkeyPatch}}) \textendash{} The monkeypatch object for mocking.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_update\_result\_executes\_commit() (in module test.data\_storage.test\_llm\_analyse)@\spxentry{test\_update\_result\_executes\_commit()}\spxextra{in module test.data\_storage.test\_llm\_analyse}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_analyse.test_update_result_executes_commit}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_analyse.}}\sphinxbfcode{\sphinxupquote{test\_update\_result\_executes\_commit}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test that the update\_result function executes an UPDATE query and commits.

\sphinxAtStartPar
This test verifies that the update\_result function correctly executes
an UPDATE statement and commits the changes to the database.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} (\sphinxstyleliteralemphasis{\sphinxupquote{pytest.MonkeyPatch}}) \textendash{} The monkeypatch object for mocking.

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{test.data\_storage.test\_llm\_standardize module}
\label{\detokenize{test.data_storage:module-test.data_storage.test_llm_standardize}}\label{\detokenize{test.data_storage:test-data-storage-test-llm-standardize-module}}\index{module@\spxentry{module}!test.data\_storage.test\_llm\_standardize@\spxentry{test.data\_storage.test\_llm\_standardize}}\index{test.data\_storage.test\_llm\_standardize@\spxentry{test.data\_storage.test\_llm\_standardize}!module@\spxentry{module}}
\sphinxAtStartPar
This module contains tests for the llm\_standardize functionality, which includes the processing and standardization
of measurement units using LLM (Large Language Models). It includes dummy database connection and cursor classes to
simulate interactions with a database and test various edge cases, such as invalid or non\sphinxhyphen{}convertible data, successful
standardizations, and handling of JSON errors.

\sphinxAtStartPar
Tests cover the following aspects:
\sphinxhyphen{} Parsing of JSON wrapped in markdown
\sphinxhyphen{} Construction of conversion prompts
\sphinxhyphen{} Execution of database updates for standardized data
\sphinxhyphen{} Handling of unit mismatches and the conversion process
\sphinxhyphen{} Proper handling of success and failure cases for standardization
\index{DummyConnection (class in test.data\_storage.test\_llm\_standardize)@\spxentry{DummyConnection}\spxextra{class in test.data\_storage.test\_llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.DummyConnection}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_standardize.}}\sphinxbfcode{\sphinxupquote{DummyConnection}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A dummy implementation of a database connection, simulating commit, rollback, and cursor functionalities.
\index{close() (test.data\_storage.test\_llm\_standardize.DummyConnection method)@\spxentry{close()}\spxextra{test.data\_storage.test\_llm\_standardize.DummyConnection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.DummyConnection.close}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{close}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulates closing the database connection.

\end{fulllineitems}

\index{commit() (test.data\_storage.test\_llm\_standardize.DummyConnection method)@\spxentry{commit()}\spxextra{test.data\_storage.test\_llm\_standardize.DummyConnection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.DummyConnection.commit}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{commit}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulates committing the current transaction.

\end{fulllineitems}

\index{cursor() (test.data\_storage.test\_llm\_standardize.DummyConnection method)@\spxentry{cursor()}\spxextra{test.data\_storage.test\_llm\_standardize.DummyConnection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.DummyConnection.cursor}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cursor}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Returns the simulated cursor object.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
The cursor object for executing queries.

\sphinxlineitem{Return type}
\sphinxAtStartPar
{\hyperref[\detokenize{test.data_storage:test.data_storage.test_llm_standardize.DummyCursor}]{\sphinxcrossref{DummyCursor}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{rollback() (test.data\_storage.test\_llm\_standardize.DummyConnection method)@\spxentry{rollback()}\spxextra{test.data\_storage.test\_llm\_standardize.DummyConnection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.DummyConnection.rollback}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{rollback}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulates rolling back the current transaction.

\end{fulllineitems}


\end{fulllineitems}

\index{DummyCursor (class in test.data\_storage.test\_llm\_standardize)@\spxentry{DummyCursor}\spxextra{class in test.data\_storage.test\_llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.DummyCursor}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_standardize.}}\sphinxbfcode{\sphinxupquote{DummyCursor}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A dummy implementation of a database cursor for simulating database interactions.
\index{close() (test.data\_storage.test\_llm\_standardize.DummyCursor method)@\spxentry{close()}\spxextra{test.data\_storage.test\_llm\_standardize.DummyCursor method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.DummyCursor.close}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{close}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulates closing the cursor.

\end{fulllineitems}

\index{execute() (test.data\_storage.test\_llm\_standardize.DummyCursor method)@\spxentry{execute()}\spxextra{test.data\_storage.test\_llm\_standardize.DummyCursor method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.DummyCursor.execute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{execute}}}
{\sphinxparam{\DUrole{n}{query}}\sphinxparamcomma \sphinxparam{\DUrole{n}{params}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Simulates executing a database query.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{query}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The SQL query string to execute.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{params}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Optional parameters for the SQL query.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{test\_build\_conversion\_prompt\_content() (in module test.data\_storage.test\_llm\_standardize)@\spxentry{test\_build\_conversion\_prompt\_content()}\spxextra{in module test.data\_storage.test\_llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.test_build_conversion_prompt_content}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_standardize.}}\sphinxbfcode{\sphinxupquote{test\_build\_conversion\_prompt\_content}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case for the build\_conversion\_prompt function to ensure the correct construction of conversion prompts.

\end{fulllineitems}

\index{test\_main\_standardization\_pipeline() (in module test.data\_storage.test\_llm\_standardize)@\spxentry{test\_main\_standardization\_pipeline()}\spxextra{in module test.data\_storage.test\_llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.test_main_standardization_pipeline}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_standardize.}}\sphinxbfcode{\sphinxupquote{test\_main\_standardization\_pipeline}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}\sphinxparamcomma \sphinxparam{\DUrole{n}{capsys}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case for the main function in the standardization pipeline, including bulk processing and file output.

\end{fulllineitems}

\index{test\_process\_row\_convertible\_false() (in module test.data\_storage.test\_llm\_standardize)@\spxentry{test\_process\_row\_convertible\_false()}\spxextra{in module test.data\_storage.test\_llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.test_process_row_convertible_false}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_standardize.}}\sphinxbfcode{\sphinxupquote{test\_process\_row\_convertible\_false}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case for the process\_row function when LLM returns a response indicating that conversion is not possible.

\end{fulllineitems}

\index{test\_process\_row\_invalid\_result\_value() (in module test.data\_storage.test\_llm\_standardize)@\spxentry{test\_process\_row\_invalid\_result\_value()}\spxextra{in module test.data\_storage.test\_llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.test_process_row_invalid_result_value}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_standardize.}}\sphinxbfcode{\sphinxupquote{test\_process\_row\_invalid\_result\_value}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}\sphinxparamcomma \sphinxparam{\DUrole{n}{capsys}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case for the process\_row function when the LLM returns a non\sphinxhyphen{}numeric value after conversion.

\end{fulllineitems}

\index{test\_process\_row\_success() (in module test.data\_storage.test\_llm\_standardize)@\spxentry{test\_process\_row\_success()}\spxextra{in module test.data\_storage.test\_llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.test_process_row_success}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_standardize.}}\sphinxbfcode{\sphinxupquote{test\_process\_row\_success}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case for the process\_row function when LLM returns a valid numeric conversion result.

\end{fulllineitems}

\index{test\_process\_row\_unit\_match() (in module test.data\_storage.test\_llm\_standardize)@\spxentry{test\_process\_row\_unit\_match()}\spxextra{in module test.data\_storage.test\_llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.test_process_row_unit_match}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_standardize.}}\sphinxbfcode{\sphinxupquote{test\_process\_row\_unit\_match}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case for the process\_row function where the unit matches and no conversion is needed.

\end{fulllineitems}

\index{test\_safe\_json\_parse\_cleanup\_and\_errors() (in module test.data\_storage.test\_llm\_standardize)@\spxentry{test\_safe\_json\_parse\_cleanup\_and\_errors()}\spxextra{in module test.data\_storage.test\_llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.test_safe_json_parse_cleanup_and_errors}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_standardize.}}\sphinxbfcode{\sphinxupquote{test\_safe\_json\_parse\_cleanup\_and\_errors}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case for the \sphinxtitleref{safe\_json\_parse} function to ensure proper handling of valid and invalid JSON strings.

\end{fulllineitems}

\index{test\_update\_standardized\_execution() (in module test.data\_storage.test\_llm\_standardize)@\spxentry{test\_update\_standardized\_execution()}\spxextra{in module test.data\_storage.test\_llm\_standardize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_llm_standardize.test_update_standardized_execution}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_llm\_standardize.}}\sphinxbfcode{\sphinxupquote{test\_update\_standardized\_execution}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case for the update\_standardized function to verify SQL execution and commit behavior.

\end{fulllineitems}



\subsubsection{test.data\_storage.test\_paragraph\_extraction module}
\label{\detokenize{test.data_storage:module-test.data_storage.test_paragraph_extraction}}\label{\detokenize{test.data_storage:test-data-storage-test-paragraph-extraction-module}}\index{module@\spxentry{module}!test.data\_storage.test\_paragraph\_extraction@\spxentry{test.data\_storage.test\_paragraph\_extraction}}\index{test.data\_storage.test\_paragraph\_extraction@\spxentry{test.data\_storage.test\_paragraph\_extraction}!module@\spxentry{module}}
\sphinxAtStartPar
Test module for paragraph extraction functionality within the data storage module.
This module tests various functions including PDF paragraph extraction, database insertion,
memory usage checks, and the processing of multiple PDFs.
\index{mock\_db() (in module test.data\_storage.test\_paragraph\_extraction)@\spxentry{mock\_db()}\spxextra{in module test.data\_storage.test\_paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_paragraph_extraction.mock_db}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{mock\_db}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fixture to mock database connection and cursor for testing database interactions.
\begin{quote}\begin{description}
\sphinxlineitem{Yields}
\sphinxAtStartPar
\sphinxstyleemphasis{mock\_conn (MagicMock)} \textendash{} The mocked database connection object.

\end{description}\end{quote}

\end{fulllineitems}

\index{mock\_minio() (in module test.data\_storage.test\_paragraph\_extraction)@\spxentry{mock\_minio()}\spxextra{in module test.data\_storage.test\_paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_paragraph_extraction.mock_minio}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{mock\_minio}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fixture to mock MinIO client by patching the ‘fget\_object’ method to return None.
\begin{quote}\begin{description}
\sphinxlineitem{Yields}
\sphinxAtStartPar
\sphinxstyleemphasis{mock\_fget (MagicMock)} \textendash{} The mocked MinIO ‘fget\_object’ method.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_check\_memory\_usage() (in module test.data\_storage.test\_paragraph\_extraction)@\spxentry{test\_check\_memory\_usage()}\spxextra{in module test.data\_storage.test\_paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_paragraph_extraction.test_check_memory_usage}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{test\_check\_memory\_usage}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the memory usage check function.

\sphinxAtStartPar
Verifies that the function returns the correct value based on system memory usage.

\end{fulllineitems}

\index{test\_extract\_paragraphs\_from\_pdf() (in module test.data\_storage.test\_paragraph\_extraction)@\spxentry{test\_extract\_paragraphs\_from\_pdf()}\spxextra{in module test.data\_storage.test\_paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_paragraph_extraction.test_extract_paragraphs_from_pdf}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{test\_extract\_paragraphs\_from\_pdf}}}
{\sphinxparam{\DUrole{n}{mock\_minio}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the extraction of paragraphs from a PDF file.

\sphinxAtStartPar
Simulates the process of extracting text from a PDF and verifies that paragraphs
are correctly extracted.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_minio}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} The mocked MinIO client for testing purposes.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_find\_matching\_paragraphs() (in module test.data\_storage.test\_paragraph\_extraction)@\spxentry{test\_find\_matching\_paragraphs()}\spxextra{in module test.data\_storage.test\_paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_paragraph_extraction.test_find_matching_paragraphs}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{test\_find\_matching\_paragraphs}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the functionality of finding paragraphs that match given keywords.

\sphinxAtStartPar
Verifies that the correct paragraphs are matched based on the provided keywords.

\end{fulllineitems}

\index{test\_insert\_matched\_data() (in module test.data\_storage.test\_paragraph\_extraction)@\spxentry{test\_insert\_matched\_data()}\spxextra{in module test.data\_storage.test\_paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_paragraph_extraction.test_insert_matched_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{test\_insert\_matched\_data}}}
{\sphinxparam{\DUrole{n}{mock\_db}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_minio}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the insertion of matched paragraphs into the database.

\sphinxAtStartPar
Verifies that the matched data is correctly inserted into the database and that the
proper SQL statement is executed.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_db}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} The mocked database connection object.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_minio}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} The mocked MinIO client for testing purposes.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_memory\_management() (in module test.data\_storage.test\_paragraph\_extraction)@\spxentry{test\_memory\_management()}\spxextra{in module test.data\_storage.test\_paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_paragraph_extraction.test_memory_management}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{test\_memory\_management}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the memory management functionality by simulating high and low memory usage.

\sphinxAtStartPar
Verifies that the system behaves as expected under varying memory conditions.

\end{fulllineitems}

\index{test\_parse\_security\_and\_year() (in module test.data\_storage.test\_paragraph\_extraction)@\spxentry{test\_parse\_security\_and\_year()}\spxextra{in module test.data\_storage.test\_paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_paragraph_extraction.test_parse_security_and_year}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{test\_parse\_security\_and\_year}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the extraction of security and year information from a file name.

\sphinxAtStartPar
Verifies that the correct security ticker and year are parsed from the file name.

\end{fulllineitems}

\index{test\_process\_all\_pdfs() (in module test.data\_storage.test\_paragraph\_extraction)@\spxentry{test\_process\_all\_pdfs()}\spxextra{in module test.data\_storage.test\_paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_paragraph_extraction.test_process_all_pdfs}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{test\_process\_all\_pdfs}}}
{\sphinxparam{\DUrole{n}{mock\_fget}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_list\_objects}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_db}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the processing of all PDF files from MinIO.

\sphinxAtStartPar
Verifies that all PDFs are processed correctly, including the retrieval and handling
of files, database updates, and the execution of relevant queries.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_fget}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} The mocked MinIO ‘fget\_object’ method.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_list\_objects}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} The mocked MinIO ‘list\_objects’ method.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_db}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} The mocked database connection object.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_process\_report() (in module test.data\_storage.test\_paragraph\_extraction)@\spxentry{test\_process\_report()}\spxextra{in module test.data\_storage.test\_paragraph\_extraction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_paragraph_extraction.test_process_report}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_paragraph\_extraction.}}\sphinxbfcode{\sphinxupquote{test\_process\_report}}}
{\sphinxparam{\DUrole{n}{mock\_fget}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_db}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the processing of a report file.

\sphinxAtStartPar
Simulates the entire process of handling a report, including database interactions,
memory usage checks, and file handling.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_fget}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} The mocked MinIO ‘fget\_object’ method.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_db}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} The mocked database connection object.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{test.data\_storage.test\_retry\_failed\_reports module}
\label{\detokenize{test.data_storage:module-test.data_storage.test_retry_failed_reports}}\label{\detokenize{test.data_storage:test-data-storage-test-retry-failed-reports-module}}\index{module@\spxentry{module}!test.data\_storage.test\_retry\_failed\_reports@\spxentry{test.data\_storage.test\_retry\_failed\_reports}}\index{test.data\_storage.test\_retry\_failed\_reports@\spxentry{test.data\_storage.test\_retry\_failed\_reports}!module@\spxentry{module}}
\sphinxAtStartPar
Test module for retrying failed reports in the paragraph extraction module.
This module tests the retry logic for handling failed report downloads,
matching paragraphs in PDFs, and database interactions.
\index{test\_download\_error() (in module test.data\_storage.test\_retry\_failed\_reports)@\spxentry{test\_download\_error()}\spxextra{in module test.data\_storage.test\_retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_retry_failed_reports.test_download_error}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{test\_download\_error}}}
{\sphinxparam{\DUrole{n}{mock\_connect}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_fget}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_open\_file}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_exists}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case where the file download fails during the retry process.

\sphinxAtStartPar
Verifies that the function handles download errors appropriately.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_connect}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked psycopg2 connect method for simulating database connection.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_fget}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked MinIO ‘fget\_object’ method to simulate a download error.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_open\_file}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked open function to simulate reading a PDF file name.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_exists}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked Path.exists method to simulate file existence.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_empty\_failed\_json() (in module test.data\_storage.test\_retry\_failed\_reports)@\spxentry{test\_empty\_failed\_json()}\spxextra{in module test.data\_storage.test\_retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_retry_failed_reports.test_empty_failed_json}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{test\_empty\_failed\_json}}}
{\sphinxparam{\DUrole{n}{mock\_open\_file}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_exists}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case where the ‘failed\_reports.json’ file is empty.

\sphinxAtStartPar
Verifies that the function does not attempt any processing when the JSON file
is empty.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_open\_file}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked open function to simulate reading an empty list.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_exists}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked Path.exists method to simulate file existence.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_failed\_json\_removed\_after\_success() (in module test.data\_storage.test\_retry\_failed\_reports)@\spxentry{test\_failed\_json\_removed\_after\_success()}\spxextra{in module test.data\_storage.test\_retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_retry_failed_reports.test_failed_json_removed_after_success}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{test\_failed\_json\_removed\_after\_success}}}
{\sphinxparam{\DUrole{n}{mock\_unlink}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_remove}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_os\_exists}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_pdf}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_connect}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_fget}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_open\_file}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_exists}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case where all files are successfully processed and the ‘failed\_reports.json’ is deleted.

\sphinxAtStartPar
Verifies that the function properly removes the ‘failed\_reports.json’ after all files are successfully processed.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_unlink}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked Path.unlink method to simulate file deletion.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_remove}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked os.remove method to simulate file removal.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_os\_exists}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked os.path.exists method to simulate file existence.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_pdf}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked pdfplumber.open to simulate PDF page extraction.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_connect}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked psycopg2 connect method for simulating database connection.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_fget}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked MinIO ‘fget\_object’ method for simulating file retrieval.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_open\_file}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked open function to simulate reading a PDF file name.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_exists}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked Path.exists method to simulate file existence.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_invalid\_filename\_skipped() (in module test.data\_storage.test\_retry\_failed\_reports)@\spxentry{test\_invalid\_filename\_skipped()}\spxextra{in module test.data\_storage.test\_retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_retry_failed_reports.test_invalid_filename_skipped}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{test\_invalid\_filename\_skipped}}}
{\sphinxparam{\DUrole{n}{mock\_connect}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_open\_file}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_exists}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case where ‘parse\_security\_and\_year’ returns None due to an invalid file name.

\sphinxAtStartPar
Verifies that the function skips processing for invalid filenames.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_connect}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked psycopg2 connect method for simulating database connection.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_open\_file}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked open function to simulate reading an invalid file name.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_exists}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked Path.exists method to simulate file existence.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_no\_failed\_json() (in module test.data\_storage.test\_retry\_failed\_reports)@\spxentry{test\_no\_failed\_json()}\spxextra{in module test.data\_storage.test\_retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_retry_failed_reports.test_no_failed_json}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{test\_no\_failed\_json}}}
{\sphinxparam{\DUrole{n}{mock\_exists}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case where the ‘failed\_reports.json’ file does not exist.

\sphinxAtStartPar
Verifies that the function does not raise an error and returns immediately.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_exists}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked Path.exists method to simulate file absence.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_no\_matching\_paragraphs() (in module test.data\_storage.test\_retry\_failed\_reports)@\spxentry{test\_no\_matching\_paragraphs()}\spxextra{in module test.data\_storage.test\_retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_retry_failed_reports.test_no_matching_paragraphs}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{test\_no\_matching\_paragraphs}}}
{\sphinxparam{\DUrole{n}{mock\_pdf}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_connect}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_fget}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_open\_file}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_exists}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case where no paragraphs match the given keywords.

\sphinxAtStartPar
Verifies that the function skips further processing when no matching paragraphs are found.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_pdf}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked pdfplumber.open to simulate PDF page extraction.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_connect}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked psycopg2 connect method for simulating database connection.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_fget}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked MinIO ‘fget\_object’ method for simulating file retrieval.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_open\_file}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked open function to simulate reading a PDF file name.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_exists}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked Path.exists method to simulate file existence.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_pdf\_page\_no\_text() (in module test.data\_storage.test\_retry\_failed\_reports)@\spxentry{test\_pdf\_page\_no\_text()}\spxextra{in module test.data\_storage.test\_retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_retry_failed_reports.test_pdf_page_no_text}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{test\_pdf\_page\_no\_text}}}
{\sphinxparam{\DUrole{n}{mock\_pdf}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_connect}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_fget}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_open\_file}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_exists}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case where the PDF page extraction returns None (no text extracted).

\sphinxAtStartPar
Verifies that the function handles the case of missing text on a PDF page appropriately.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_pdf}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked pdfplumber.open to simulate PDF page extraction.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_connect}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked psycopg2 connect method for simulating database connection.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_fget}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked MinIO ‘fget\_object’ method for simulating file retrieval.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_open\_file}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked open function to simulate reading a PDF file name.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_exists}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked Path.exists method to simulate file existence.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_successful\_extraction() (in module test.data\_storage.test\_retry\_failed\_reports)@\spxentry{test\_successful\_extraction()}\spxextra{in module test.data\_storage.test\_retry\_failed\_reports}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.data_storage:test.data_storage.test_retry_failed_reports.test_successful_extraction}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.data\_storage.test\_retry\_failed\_reports.}}\sphinxbfcode{\sphinxupquote{test\_successful\_extraction}}}
{\sphinxparam{\DUrole{n}{mock\_remove}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_os\_exists}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_pdf}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_connect}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_fget}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_open\_file}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mock\_exists}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test case where the paragraph extraction is successful and database updates occur.

\sphinxAtStartPar
Verifies that the extraction is successful, the data is processed, and the database is updated.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_remove}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked os.remove method to simulate file removal.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_os\_exists}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked os.path.exists method to simulate file existence.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_pdf}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked pdfplumber.open to simulate PDF page extraction.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_connect}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked psycopg2 connect method for simulating database connection.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_fget}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked MinIO ‘fget\_object’ method for simulating file retrieval.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_open\_file}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked open function to simulate reading a PDF file name.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_exists}} (\sphinxstyleliteralemphasis{\sphinxupquote{MagicMock}}) \textendash{} Mocked Path.exists method to simulate file existence.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{Module contents}
\label{\detokenize{test.data_storage:module-test.data_storage}}\label{\detokenize{test.data_storage:module-contents}}\index{module@\spxentry{module}!test.data\_storage@\spxentry{test.data\_storage}}\index{test.data\_storage@\spxentry{test.data\_storage}!module@\spxentry{module}}
\sphinxstepscope


\subsection{test.frontend package}
\label{\detokenize{test.frontend:test-frontend-package}}\label{\detokenize{test.frontend::doc}}

\subsubsection{Submodules}
\label{\detokenize{test.frontend:submodules}}

\subsubsection{test.frontend.test\_app module}
\label{\detokenize{test.frontend:module-test.frontend.test_app}}\label{\detokenize{test.frontend:test-frontend-test-app-module}}\index{module@\spxentry{module}!test.frontend.test\_app@\spxentry{test.frontend.test\_app}}\index{test.frontend.test\_app@\spxentry{test.frontend.test\_app}!module@\spxentry{module}}
\sphinxAtStartPar
Module: test\_app\_structure

\sphinxAtStartPar
This module contains tests to verify the structure and functionality of the frontend
\sphinxtitleref{App.js} file located within the \sphinxtitleref{modules/frontend/src/} directory. These tests ensure
that the file includes essential elements like React hooks, JSX components, and event handling.

\sphinxAtStartPar
Test cases:
\sphinxhyphen{} Structural validation of the App.js file (checking for required elements like hooks, JSX structure, and HTML elements).
\sphinxhyphen{} Functional validation to ensure that the App.js contains necessary event handling logic (e.g., \sphinxtitleref{onClick} event binding and state update logic).
\index{test\_app\_contains\_add\_functionality() (in module test.frontend.test\_app)@\spxentry{test\_app\_contains\_add\_functionality()}\spxextra{in module test.frontend.test\_app}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.frontend:test.frontend.test_app.test_app_contains_add_functionality}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.frontend.test\_app.}}\sphinxbfcode{\sphinxupquote{test\_app\_contains\_add\_functionality}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the functionality of the App.js file to check if it includes add functionality.

\sphinxAtStartPar
This test checks if the \sphinxtitleref{App.js} file contains logic for handling button click events and
updating state. Specifically, it verifies that an \sphinxtitleref{onClick} event handler is present and that
there is a state update logic, indicated by calls to functions that start with \sphinxtitleref{set}.

\sphinxAtStartPar
It performs the following checks:
\sphinxhyphen{} Verifies that the file contains an \sphinxtitleref{onClick} event handler.
\sphinxhyphen{} Verifies that a state update function (e.g., \sphinxtitleref{setState}) is called within the file.
\begin{quote}\begin{description}
\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{AssertionError}} \textendash{} If any of the above checks fail.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_app\_structure() (in module test.frontend.test\_app)@\spxentry{test\_app\_structure()}\spxextra{in module test.frontend.test\_app}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.frontend:test.frontend.test_app.test_app_structure}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.frontend.test\_app.}}\sphinxbfcode{\sphinxupquote{test\_app\_structure}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the structure of the App.js file.

\sphinxAtStartPar
This test verifies that the \sphinxtitleref{App.js} file contains the essential React elements, including
the use of the \sphinxtitleref{useState} hook, JSX structure, and required HTML elements such as \sphinxtitleref{\textless{}input\textgreater{}} and \sphinxtitleref{\textless{}button\textgreater{}}.
It ensures the basic structure of the component is set up correctly.

\sphinxAtStartPar
It performs the following checks:
\sphinxhyphen{} Verifies that \sphinxtitleref{useState} is used in the file.
\sphinxhyphen{} Verifies that the file contains a return statement with JSX.
\sphinxhyphen{} Verifies the inclusion of an \sphinxtitleref{\textless{}input\textgreater{}} element.
\sphinxhyphen{} Verifies the inclusion of a \sphinxtitleref{\textless{}button\textgreater{}} element.
\begin{quote}\begin{description}
\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{AssertionError}} \textendash{} If any of the above checks fail.

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{test.frontend.test\_index\_css module}
\label{\detokenize{test.frontend:module-test.frontend.test_index_css}}\label{\detokenize{test.frontend:test-frontend-test-index-css-module}}\index{module@\spxentry{module}!test.frontend.test\_index\_css@\spxentry{test.frontend.test\_index\_css}}\index{test.frontend.test\_index\_css@\spxentry{test.frontend.test\_index\_css}!module@\spxentry{module}}
\sphinxAtStartPar
Module: test\_custom\_checkbox\_class\_exists

\sphinxAtStartPar
This module contains a test function that checks if the necessary CSS classes related to
the custom checkbox, loading spinner, and error message elements are defined within
the \sphinxtitleref{index.css} file of the frontend project. It also verifies that Tailwind CSS has
been properly integrated into the project by checking for the presence of its directives.

\sphinxAtStartPar
Test case:
\sphinxhyphen{} Verifies the existence of specific CSS classes (\sphinxtitleref{.custom\sphinxhyphen{}checkbox}, \sphinxtitleref{.custom\sphinxhyphen{}checkbox:checked}, \sphinxtitleref{.loading\sphinxhyphen{}spinner}, and \sphinxtitleref{.error\sphinxhyphen{}message}).
\sphinxhyphen{} Verifies that Tailwind CSS directives (\sphinxtitleref{@tailwind base}, \sphinxtitleref{@tailwind components}, and \sphinxtitleref{@tailwind utilities}) are included in the \sphinxtitleref{index.css} file.
\index{test\_custom\_checkbox\_class\_exists() (in module test.frontend.test\_index\_css)@\spxentry{test\_custom\_checkbox\_class\_exists()}\spxextra{in module test.frontend.test\_index\_css}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.frontend:test.frontend.test_index_css.test_custom_checkbox_class_exists}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.frontend.test\_index\_css.}}\sphinxbfcode{\sphinxupquote{test\_custom\_checkbox\_class\_exists}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the existence of essential CSS classes and Tailwind integration in the \sphinxtitleref{index.css} file.

\sphinxAtStartPar
This test function reads the contents of the \sphinxtitleref{index.css} file, which is part of the frontend
project, and checks for the presence of the following:
\sphinxhyphen{} \sphinxtitleref{.custom\sphinxhyphen{}checkbox}: A class that should define custom checkbox styles.
\sphinxhyphen{} \sphinxtitleref{.custom\sphinxhyphen{}checkbox:checked}: A pseudo\sphinxhyphen{}class for checked custom checkboxes.
\sphinxhyphen{} \sphinxtitleref{.loading\sphinxhyphen{}spinner}: A class to define the loading spinner styles.
\sphinxhyphen{} \sphinxtitleref{.error\sphinxhyphen{}message}: A class to define the error message styles.
\sphinxhyphen{} Tailwind CSS directives: Verifies that the \sphinxtitleref{@tailwind} directives for \sphinxtitleref{base}, \sphinxtitleref{components},
and \sphinxtitleref{utilities} are present to ensure Tailwind CSS is integrated into the project.
\begin{quote}\begin{description}
\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{AssertionError}} \textendash{} If any of the CSS classes or Tailwind CSS directives are missing.

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{test.frontend.test\_index\_js module}
\label{\detokenize{test.frontend:module-test.frontend.test_index_js}}\label{\detokenize{test.frontend:test-frontend-test-index-js-module}}\index{module@\spxentry{module}!test.frontend.test\_index\_js@\spxentry{test.frontend.test\_index\_js}}\index{test.frontend.test\_index\_js@\spxentry{test.frontend.test\_index\_js}!module@\spxentry{module}}
\sphinxAtStartPar
Module: test\_index\_imports\_and\_mounts

\sphinxAtStartPar
This module contains a test function that verifies the correct imports and mounting logic
within the \sphinxtitleref{index.js} file in a frontend project. Specifically, it ensures that:
\sphinxhyphen{} The \sphinxtitleref{App} component is imported correctly.
\sphinxhyphen{} The \sphinxtitleref{ReactDOM.createRoot} method is called for mounting.
\sphinxhyphen{} The \sphinxtitleref{root.render} method is invoked to render the \sphinxtitleref{App} component.

\sphinxAtStartPar
Since Python cannot directly mock or execute JavaScript files, this test performs static checks on
the content of the \sphinxtitleref{index.js} file to confirm the required JavaScript functionality.

\sphinxAtStartPar
Test case:
\sphinxhyphen{} Ensures proper import and mounting of the \sphinxtitleref{App} component in \sphinxtitleref{index.js}.
\index{test\_index\_imports\_and\_mounts() (in module test.frontend.test\_index\_js)@\spxentry{test\_index\_imports\_and\_mounts()}\spxextra{in module test.frontend.test\_index\_js}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.frontend:test.frontend.test_index_js.test_index_imports_and_mounts}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.frontend.test\_index\_js.}}\sphinxbfcode{\sphinxupquote{test\_index\_imports\_and\_mounts}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the imports and mounting logic in the \sphinxtitleref{index.js} file.

\sphinxAtStartPar
This test checks that the \sphinxtitleref{index.js} file contains the necessary JavaScript code for:
\sphinxhyphen{} Importing the \sphinxtitleref{App} component with \sphinxtitleref{import App from}.
\sphinxhyphen{} Calling \sphinxtitleref{ReactDOM.createRoot} to initialize the app mounting point.
\sphinxhyphen{} Using \sphinxtitleref{root.render} to render the \sphinxtitleref{App} component.
\begin{quote}\begin{description}
\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{AssertionError}} \textendash{} If any of the required imports or method calls are missing.

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{test.frontend.test\_tailwind\_config module}
\label{\detokenize{test.frontend:module-test.frontend.test_tailwind_config}}\label{\detokenize{test.frontend:test-frontend-test-tailwind-config-module}}\index{module@\spxentry{module}!test.frontend.test\_tailwind\_config@\spxentry{test.frontend.test\_tailwind\_config}}\index{test.frontend.test\_tailwind\_config@\spxentry{test.frontend.test\_tailwind\_config}!module@\spxentry{module}}
\sphinxAtStartPar
Module: test\_tailwind\_config

\sphinxAtStartPar
This module contains tests for validating the contents and structure of the \sphinxtitleref{tailwind.config.js}
file in a frontend project. Specifically, it checks if certain expected keys, values, and settings
are present in the configuration file.

\sphinxAtStartPar
Test cases:
\sphinxhyphen{} Ensures the presence of specific keys and values in the Tailwind CSS configuration.
\index{test\_tailwind\_config\_contains\_expected\_keys() (in module test.frontend.test\_tailwind\_config)@\spxentry{test\_tailwind\_config\_contains\_expected\_keys()}\spxextra{in module test.frontend.test\_tailwind\_config}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.frontend:test.frontend.test_tailwind_config.test_tailwind_config_contains_expected_keys}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.frontend.test\_tailwind\_config.}}\sphinxbfcode{\sphinxupquote{test\_tailwind\_config\_contains\_expected\_keys}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test that the \sphinxtitleref{tailwind.config.js} file contains expected keys and values.

\sphinxAtStartPar
This test verifies that the following elements are present in the Tailwind CSS configuration file:
\sphinxhyphen{} The \sphinxtitleref{module.exports} keyword, indicating that the file exports the configuration.
\sphinxhyphen{} The \sphinxtitleref{theme:} key for defining theme\sphinxhyphen{}related customizations.
\sphinxhyphen{} The \sphinxtitleref{extend:} key to check for extensions in the theme.
\sphinxhyphen{} A custom color \sphinxtitleref{\#1a8c70} for teal.
\sphinxhyphen{} The animation name \sphinxtitleref{pulse}.
\begin{quote}\begin{description}
\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{AssertionError}} \textendash{} If any of the expected keys or values are missing from the configuration file.

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{Module contents}
\label{\detokenize{test.frontend:module-test.frontend}}\label{\detokenize{test.frontend:module-contents}}\index{module@\spxentry{module}!test.frontend@\spxentry{test.frontend}}\index{test.frontend@\spxentry{test.frontend}!module@\spxentry{module}}
\sphinxstepscope


\subsection{test.my\_fastapi package}
\label{\detokenize{test.my_fastapi:test-my-fastapi-package}}\label{\detokenize{test.my_fastapi::doc}}

\subsubsection{Submodules}
\label{\detokenize{test.my_fastapi:submodules}}

\subsubsection{test.my\_fastapi.test\_main module}
\label{\detokenize{test.my_fastapi:module-test.my_fastapi.test_main}}\label{\detokenize{test.my_fastapi:test-my-fastapi-test-main-module}}\index{module@\spxentry{module}!test.my\_fastapi.test\_main@\spxentry{test.my\_fastapi.test\_main}}\index{test.my\_fastapi.test\_main@\spxentry{test.my\_fastapi.test\_main}!module@\spxentry{module}}
\sphinxAtStartPar
Module: test\_main

\sphinxAtStartPar
This module contains test cases for the FastAPI application endpoints.
It uses pytest and unittest.mock to test various endpoints that interact
with a database, returning indicator, data, and report information. The tests
cover scenarios such as successful retrieval, search with parameters, and error handling.

\sphinxAtStartPar
Each test mocks the database query (\sphinxtitleref{query\_db}) to return predefined values,
allowing for consistent and controlled test execution.

\sphinxAtStartPar
Test cases include:
\sphinxhyphen{} Retrieving all indicators.
\sphinxhyphen{} Searching for indicators by name or theme.
\sphinxhyphen{} Retrieving data by ID.
\sphinxhyphen{} Searching for data based on multiple parameters.
\sphinxhyphen{} Handling of reports and errors (e.g., not found).

\sphinxAtStartPar
The tests verify the status codes, response structures, and expected behaviors of the API.
\index{test\_favicon() (in module test.my\_fastapi.test\_main)@\spxentry{test\_favicon()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_favicon}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_favicon}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the favicon endpoint.

\sphinxAtStartPar
This test ensures that the favicon URL returns a valid response (either 200 or 404) depending
on the existence of the favicon file.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} \textendash{} A pytest fixture that allows patching functions for testing purposes.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_get\_all\_data() (in module test.my\_fastapi.test\_main)@\spxentry{test\_get\_all\_data()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_get_all_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_get\_all\_data}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /data endpoint.

\sphinxAtStartPar
This test ensures that the endpoint returns a list of data items with the correct structure.
It verifies that the response status is 200 and that the returned data is a list.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to return predefined data.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_get\_company\_report\_by\_id() (in module test.my\_fastapi.test\_main)@\spxentry{test\_get\_company\_report\_by\_id()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_get_company_report_by_id}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_get\_company\_report\_by\_id}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /reports/\{id\} endpoint by report ID.

\sphinxAtStartPar
This test ensures that the endpoint correctly retrieves a report by its ID.
It verifies that the response status is 200 and the report contains the ‘symbol’ field.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to return predefined data for the specified report ID.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_get\_data\_by\_id() (in module test.my\_fastapi.test\_main)@\spxentry{test\_get\_data\_by\_id()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_get_data_by_id}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_get\_data\_by\_id}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /data/\{id\} endpoint by ID.

\sphinxAtStartPar
This test ensures that the endpoint correctly retrieves data by its ID.
It verifies that the response status is 200 and the data ID is 100.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to return predefined data for the specified ID.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_get\_data\_by\_id\_not\_found() (in module test.my\_fastapi.test\_main)@\spxentry{test\_get\_data\_by\_id\_not\_found()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_get_data_by_id_not_found}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_get\_data\_by\_id\_not\_found}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /data/\{id\} endpoint when the data is not found.

\sphinxAtStartPar
This test ensures that the endpoint returns a 404 status code when the requested data is not found.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to simulate no data being found.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_get\_indicator\_by\_id() (in module test.my\_fastapi.test\_main)@\spxentry{test\_get\_indicator\_by\_id()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_get_indicator_by_id}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_get\_indicator\_by\_id}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /indicators/\{id\} endpoint by ID.

\sphinxAtStartPar
This test ensures that the endpoint correctly retrieves an indicator by its ID.
It verifies that the response status is 200 and that the indicator name matches “Water”.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to return predefined data for the specified ID.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_get\_indicator\_not\_found() (in module test.my\_fastapi.test\_main)@\spxentry{test\_get\_indicator\_not\_found()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_get_indicator_not_found}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_get\_indicator\_not\_found}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /indicators/\{id\} endpoint when the indicator is not found.

\sphinxAtStartPar
This test ensures that the endpoint returns a 404 status code when the requested indicator does not exist.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to simulate no data being found.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_get\_indicators() (in module test.my\_fastapi.test\_main)@\spxentry{test\_get\_indicators()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_get_indicators}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_get\_indicators}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /indicators endpoint.

\sphinxAtStartPar
This test ensures that the endpoint returns a list of indicators with the correct structure.
It verifies that the response status is 200 and that the ‘indicator\_name’ of the first item is “Energy”.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to return predefined data.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_get\_report\_not\_found() (in module test.my\_fastapi.test\_main)@\spxentry{test\_get\_report\_not\_found()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_get_report_not_found}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_get\_report\_not\_found}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /reports/\{id\} endpoint when the report is not found.

\sphinxAtStartPar
This test ensures that the endpoint returns a 404 status code when the requested report is not found.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to simulate no data being found.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_get\_reports() (in module test.my\_fastapi.test\_main)@\spxentry{test\_get\_reports()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_get_reports}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_get\_reports}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /reports endpoint.

\sphinxAtStartPar
This test ensures that the endpoint returns a list of reports with the correct structure.
It verifies that the response status is 200 and the returned data is a list.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to return predefined data.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_root\_frontend\_redirect() (in module test.my\_fastapi.test\_main)@\spxentry{test\_root\_frontend\_redirect()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_root_frontend_redirect}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_root\_frontend\_redirect}}}
{\sphinxparam{\DUrole{n}{monkeypatch}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the root URL for frontend redirect behavior.

\sphinxAtStartPar
This test ensures that the root URL either returns index.html or a 404 error depending on the
availability of the frontend build directory. The test mocks the existence of the directory.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{monkeypatch}} \textendash{} A pytest fixture that allows patching functions for testing purposes.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_search\_data\_all\_params() (in module test.my\_fastapi.test\_main)@\spxentry{test\_search\_data\_all\_params()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_search_data_all_params}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_search\_data\_all\_params}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /data/search endpoint with all search parameters.

\sphinxAtStartPar
This test ensures that the endpoint returns no data when searching with specific parameters.
It verifies that the response status is 200 and the returned data is an empty list.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to simulate no data matching the search parameters.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_search\_data\_no\_param() (in module test.my\_fastapi.test\_main)@\spxentry{test\_search\_data\_no\_param()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_search_data_no_param}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_search\_data\_no\_param}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /data/search endpoint with no search parameters.

\sphinxAtStartPar
This test ensures that the endpoint returns an empty list when no parameters are provided.
It verifies that the response status is 200 and the returned data is an empty list.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to simulate no data when no parameters are provided.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_search\_indicators\_no\_match() (in module test.my\_fastapi.test\_main)@\spxentry{test\_search\_indicators\_no\_match()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_search_indicators_no_match}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_search\_indicators\_no\_match}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /indicators/search endpoint with no matching indicators.

\sphinxAtStartPar
This test ensures that when no matching indicators are found, the response is an empty list.
It verifies that the response status is 200 and the JSON body is an empty list.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to return an empty list.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_search\_indicators\_with\_name\_and\_theme() (in module test.my\_fastapi.test\_main)@\spxentry{test\_search\_indicators\_with\_name\_and\_theme()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_search_indicators_with_name_and_theme}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_search\_indicators\_with\_name\_and\_theme}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /indicators/search endpoint with matching indicators.

\sphinxAtStartPar
This test ensures that the endpoint returns matching indicators when searching by name and theme.
It verifies that the response status is 200 and the returned data is a list.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to return predefined matching data.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_search\_reports() (in module test.my\_fastapi.test\_main)@\spxentry{test\_search\_reports()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_search_reports}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_search\_reports}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /reports/search endpoint with a partial search parameter.

\sphinxAtStartPar
This test ensures that the endpoint returns a list of reports even when only a partial search parameter is provided.
It verifies that the response status is 200 and the returned data is a list.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to return predefined data for the search.

\end{description}\end{quote}

\end{fulllineitems}

\index{test\_search\_reports\_all\_params() (in module test.my\_fastapi.test\_main)@\spxentry{test\_search\_reports\_all\_params()}\spxextra{in module test.my\_fastapi.test\_main}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{test.my_fastapi:test.my_fastapi.test_main.test_search_reports_all_params}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{test.my\_fastapi.test\_main.}}\sphinxbfcode{\sphinxupquote{test\_search\_reports\_all\_params}}}
{\sphinxparam{\DUrole{n}{mock\_query}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Test the GET /reports/search endpoint with all search parameters.

\sphinxAtStartPar
This test ensures that the endpoint returns matching reports when searching with specific parameters.
It verifies that the response status is 200 and the returned data is a list.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mock\_query}} \textendash{} The mocked query\_db function used to return predefined data for the search parameters.

\end{description}\end{quote}

\end{fulllineitems}



\subsubsection{Module contents}
\label{\detokenize{test.my_fastapi:module-test.my_fastapi}}\label{\detokenize{test.my_fastapi:module-contents}}\index{module@\spxentry{module}!test.my\_fastapi@\spxentry{test.my\_fastapi}}\index{test.my\_fastapi@\spxentry{test.my\_fastapi}!module@\spxentry{module}}

\section{Module contents}
\label{\detokenize{test:module-test}}\label{\detokenize{test:module-contents}}\index{module@\spxentry{module}!test@\spxentry{test}}\index{test@\spxentry{test}!module@\spxentry{module}}

\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{m}
\item\relax\sphinxstyleindexentry{modules}\sphinxstyleindexpageref{modules:\detokenize{module-modules}}
\item\relax\sphinxstyleindexentry{modules.data\_storage}\sphinxstyleindexpageref{modules.data_storage:\detokenize{module-modules.data_storage}}
\item\relax\sphinxstyleindexentry{modules.data\_storage.create\_table}\sphinxstyleindexpageref{modules.data_storage:\detokenize{module-modules.data_storage.create_table}}
\item\relax\sphinxstyleindexentry{modules.data\_storage.data\_export}\sphinxstyleindexpageref{modules.data_storage:\detokenize{module-modules.data_storage.data_export}}
\item\relax\sphinxstyleindexentry{modules.data\_storage.llm\_analyse}\sphinxstyleindexpageref{modules.data_storage:\detokenize{module-modules.data_storage.llm_analyse}}
\item\relax\sphinxstyleindexentry{modules.data\_storage.llm\_standardize}\sphinxstyleindexpageref{modules.data_storage:\detokenize{module-modules.data_storage.llm_standardize}}
\item\relax\sphinxstyleindexentry{modules.data\_storage.main}\sphinxstyleindexpageref{modules.data_storage:\detokenize{module-modules.data_storage.main}}
\item\relax\sphinxstyleindexentry{modules.data\_storage.paragraph\_extraction}\sphinxstyleindexpageref{modules.data_storage:\detokenize{module-modules.data_storage.paragraph_extraction}}
\item\relax\sphinxstyleindexentry{modules.data\_storage.retry\_failed\_reports}\sphinxstyleindexpageref{modules.data_storage:\detokenize{module-modules.data_storage.retry_failed_reports}}
\item\relax\sphinxstyleindexentry{modules.frontend}\sphinxstyleindexpageref{modules.frontend:\detokenize{module-modules.frontend}}
\item\relax\sphinxstyleindexentry{modules.security}\sphinxstyleindexpageref{modules.security:\detokenize{module-modules.security}}
\item\relax\sphinxstyleindexentry{modules.security.scan\_code}\sphinxstyleindexpageref{modules.security:\detokenize{module-modules.security.scan_code}}
\item\relax\sphinxstyleindexentry{modules.security.scan\_dependencies}\sphinxstyleindexpageref{modules.security:\detokenize{module-modules.security.scan_dependencies}}
\item\relax\sphinxstyleindexentry{my\_fastapi}\sphinxstyleindexpageref{my_fastapi:\detokenize{module-my_fastapi}}
\item\relax\sphinxstyleindexentry{my\_fastapi.main}\sphinxstyleindexpageref{my_fastapi:\detokenize{module-my_fastapi.main}}
\indexspace
\bigletter{t}
\item\relax\sphinxstyleindexentry{test}\sphinxstyleindexpageref{test:\detokenize{module-test}}
\item\relax\sphinxstyleindexentry{test.data\_storage}\sphinxstyleindexpageref{test.data_storage:\detokenize{module-test.data_storage}}
\item\relax\sphinxstyleindexentry{test.data\_storage.conftest}\sphinxstyleindexpageref{test.data_storage:\detokenize{module-test.data_storage.conftest}}
\item\relax\sphinxstyleindexentry{test.data\_storage.test\_create\_table}\sphinxstyleindexpageref{test.data_storage:\detokenize{module-test.data_storage.test_create_table}}
\item\relax\sphinxstyleindexentry{test.data\_storage.test\_data\_export}\sphinxstyleindexpageref{test.data_storage:\detokenize{module-test.data_storage.test_data_export}}
\item\relax\sphinxstyleindexentry{test.data\_storage.test\_data\_storage\_pipeline}\sphinxstyleindexpageref{test.data_storage:\detokenize{module-test.data_storage.test_data_storage_pipeline}}
\item\relax\sphinxstyleindexentry{test.data\_storage.test\_llm\_analyse}\sphinxstyleindexpageref{test.data_storage:\detokenize{module-test.data_storage.test_llm_analyse}}
\item\relax\sphinxstyleindexentry{test.data\_storage.test\_llm\_standardize}\sphinxstyleindexpageref{test.data_storage:\detokenize{module-test.data_storage.test_llm_standardize}}
\item\relax\sphinxstyleindexentry{test.data\_storage.test\_paragraph\_extraction}\sphinxstyleindexpageref{test.data_storage:\detokenize{module-test.data_storage.test_paragraph_extraction}}
\item\relax\sphinxstyleindexentry{test.data\_storage.test\_retry\_failed\_reports}\sphinxstyleindexpageref{test.data_storage:\detokenize{module-test.data_storage.test_retry_failed_reports}}
\item\relax\sphinxstyleindexentry{test.frontend}\sphinxstyleindexpageref{test.frontend:\detokenize{module-test.frontend}}
\item\relax\sphinxstyleindexentry{test.frontend.test\_app}\sphinxstyleindexpageref{test.frontend:\detokenize{module-test.frontend.test_app}}
\item\relax\sphinxstyleindexentry{test.frontend.test\_index\_css}\sphinxstyleindexpageref{test.frontend:\detokenize{module-test.frontend.test_index_css}}
\item\relax\sphinxstyleindexentry{test.frontend.test\_index\_js}\sphinxstyleindexpageref{test.frontend:\detokenize{module-test.frontend.test_index_js}}
\item\relax\sphinxstyleindexentry{test.frontend.test\_tailwind\_config}\sphinxstyleindexpageref{test.frontend:\detokenize{module-test.frontend.test_tailwind_config}}
\item\relax\sphinxstyleindexentry{test.my\_fastapi}\sphinxstyleindexpageref{test.my_fastapi:\detokenize{module-test.my_fastapi}}
\item\relax\sphinxstyleindexentry{test.my\_fastapi.test\_main}\sphinxstyleindexpageref{test.my_fastapi:\detokenize{module-test.my_fastapi.test_main}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}