<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>test.data_storage package &#8212; Bigdata_cw2_Jacaranda 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="test.frontend package" href="test.frontend.html" />
    <link rel="prev" title="test package" href="test.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="test-data-storage-package">
<h1>test.data_storage package<a class="headerlink" href="#test-data-storage-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-test.data_storage.conftest">
<span id="test-data-storage-conftest-module"></span><h2>test.data_storage.conftest module<a class="headerlink" href="#module-test.data_storage.conftest" title="Link to this heading">¶</a></h2>
<p>This module provides test fixtures used by pytest for testing the <cite>modules.data_storage</cite> functionality.</p>
<p>Test Fixtures:
- <cite>mock_db_connection</cite>: Mocks a PostgreSQL database connection for testing purposes.
- <cite>monkeypatch_env</cite>: Mocks the environment variable <cite>DEEPSEEK_API_KEY</cite> for tests.</p>
<p>These fixtures help simulate interactions with external dependencies like a database and environment variables.</p>
<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.conftest.mock_db_connection">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.conftest.</span></span><span class="sig-name descname"><span class="pre">mock_db_connection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/conftest.html#mock_db_connection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.conftest.mock_db_connection" title="Link to this definition">¶</a></dt>
<dd><p>Mocks a PostgreSQL database connection for testing.</p>
<p>This fixture patches the <cite>psycopg2.connect</cite> function to return a fake connection and cursor.
The cursor’s <cite>fetchall</cite>, <cite>fetchone</cite>, and <cite>execute</cite> methods are mocked to simulate query results
without needing an actual database connection.</p>
<p>This fixture is scoped to the module, meaning it is created once per test module.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A mocked database connection.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>MagicMock</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.conftest.monkeypatch_env">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.conftest.</span></span><span class="sig-name descname"><span class="pre">monkeypatch_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/conftest.html#monkeypatch_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.conftest.monkeypatch_env" title="Link to this definition">¶</a></dt>
<dd><p>Mocks the <cite>DEEPSEEK_API_KEY</cite> environment variable for testing.</p>
<p>This fixture uses the <cite>monkeypatch</cite> fixture to set the environment variable <cite>DEEPSEEK_API_KEY</cite>
to a mock value (<cite>“mock-key”</cite>) during testing. This allows tests to simulate the presence
of the environment variable without requiring an actual key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>monkeypatch</strong> – The pytest monkeypatch fixture.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-test.data_storage.test_create_table">
<span id="test-data-storage-test-create-table-module"></span><h2>test.data_storage.test_create_table module<a class="headerlink" href="#module-test.data_storage.test_create_table" title="Link to this heading">¶</a></h2>
<p>Module to simulate database connection and cursor behavior using dummy objects.
It includes tests for successful table creation, insert failures, and connection failures.</p>
<dl class="py class">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.DummyConnection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">test.data_storage.test_create_table.</span></span><span class="sig-name descname"><span class="pre">DummyConnection</span></span><a class="reference internal" href="_modules/test/data_storage/test_create_table.html#DummyConnection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_create_table.DummyConnection" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A dummy connection class to simulate database connection behavior for testing purposes.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.DummyConnection.cursor_obj">
<span class="sig-name descname"><span class="pre">cursor_obj</span></span><a class="headerlink" href="#test.data_storage.test_create_table.DummyConnection.cursor_obj" title="Link to this definition">¶</a></dt>
<dd><p>The dummy cursor object used for executing queries.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#test.data_storage.test_create_table.DummyCursor" title="test.data_storage.test_create_table.DummyCursor">DummyCursor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.DummyConnection.committed">
<span class="sig-name descname"><span class="pre">committed</span></span><a class="headerlink" href="#test.data_storage.test_create_table.DummyConnection.committed" title="Link to this definition">¶</a></dt>
<dd><p>A flag indicating whether the connection has been committed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.DummyConnection.closed">
<span class="sig-name descname"><span class="pre">closed</span></span><a class="headerlink" href="#test.data_storage.test_create_table.DummyConnection.closed" title="Link to this definition">¶</a></dt>
<dd><p>A flag indicating whether the connection has been closed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.DummyConnection.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_create_table.html#DummyConnection.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_create_table.DummyConnection.close" title="Link to this definition">¶</a></dt>
<dd><p>Simulates closing the connection by setting the closed flag to True.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.DummyConnection.commit">
<span class="sig-name descname"><span class="pre">commit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_create_table.html#DummyConnection.commit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_create_table.DummyConnection.commit" title="Link to this definition">¶</a></dt>
<dd><p>Simulates committing a transaction by setting the committed flag to True.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.DummyConnection.cursor">
<span class="sig-name descname"><span class="pre">cursor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_create_table.html#DummyConnection.cursor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_create_table.DummyConnection.cursor" title="Link to this definition">¶</a></dt>
<dd><p>Returns the cursor object associated with the connection.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The cursor object for executing queries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#test.data_storage.test_create_table.DummyCursor" title="test.data_storage.test_create_table.DummyCursor">DummyCursor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.DummyCursor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">test.data_storage.test_create_table.</span></span><span class="sig-name descname"><span class="pre">DummyCursor</span></span><a class="reference internal" href="_modules/test/data_storage/test_create_table.html#DummyCursor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_create_table.DummyCursor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A dummy cursor class to simulate database cursor behavior for testing purposes.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.DummyCursor.executed_queries">
<span class="sig-name descname"><span class="pre">executed_queries</span></span><a class="headerlink" href="#test.data_storage.test_create_table.DummyCursor.executed_queries" title="Link to this definition">¶</a></dt>
<dd><p>A list that records SQL queries that were executed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.DummyCursor.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_create_table.html#DummyCursor.execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_create_table.DummyCursor.execute" title="Link to this definition">¶</a></dt>
<dd><p>Simulates executing an SQL query by recording it in the executed_queries list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>query</strong> (<em>str</em>) – The SQL query to be executed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.test_create_table_connection_failure">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_create_table.</span></span><span class="sig-name descname"><span class="pre">test_create_table_connection_failure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capsys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_create_table.html#test_create_table_connection_failure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_create_table.test_create_table_connection_failure" title="Link to this definition">¶</a></dt>
<dd><p>Test case for a database connection failure.</p>
<p>Simulates a scenario where the database connection fails, and verifies
that the appropriate error message is logged and the connection is handled correctly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monkeypatch</strong> (<em>MonkeyPatch</em>) – A pytest fixture to modify functions or objects at runtime.</p></li>
<li><p><strong>capsys</strong> (<em>CaptureFixture</em>) – A pytest fixture to capture system outputs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.test_create_table_insert_failure">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_create_table.</span></span><span class="sig-name descname"><span class="pre">test_create_table_insert_failure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capsys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_create_table.html#test_create_table_insert_failure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_create_table.test_create_table_insert_failure" title="Link to this definition">¶</a></dt>
<dd><p>Test case for a failure during the data insertion phase.</p>
<p>Simulates a scenario where data insertion fails, and verifies that the
appropriate error message is logged and the connection is closed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monkeypatch</strong> (<em>MonkeyPatch</em>) – A pytest fixture to modify functions or objects at runtime.</p></li>
<li><p><strong>capsys</strong> (<em>CaptureFixture</em>) – A pytest fixture to capture system outputs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_create_table.test_create_table_success">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_create_table.</span></span><span class="sig-name descname"><span class="pre">test_create_table_success</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capsys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_create_table.html#test_create_table_success"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_create_table.test_create_table_success" title="Link to this definition">¶</a></dt>
<dd><p>Test case for successfully creating a table and inserting data.</p>
<p>Simulates the scenario where the table creation and data insertion
are successful, and verifies the correct output and connection behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monkeypatch</strong> (<em>MonkeyPatch</em>) – A pytest fixture to modify functions or objects at runtime.</p></li>
<li><p><strong>capsys</strong> (<em>CaptureFixture</em>) – A pytest fixture to capture system outputs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-test.data_storage.test_data_export">
<span id="test-data-storage-test-data-export-module"></span><h2>test.data_storage.test_data_export module<a class="headerlink" href="#module-test.data_storage.test_data_export" title="Link to this heading">¶</a></h2>
<p>Module: data_export_tests</p>
<p>This module contains test functions for testing the functionalities
of the data export module in the <cite>data_export</cite> package. It tests
the SQL query formation for exporting tables, the export process,
and the correct execution of the <cite>main()</cite> function.</p>
<p>The tests mock dependencies like the database connection and pandas
DataFrame methods to validate the correct behavior of the export logic.</p>
<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_data_export.test_export_table_query_with_order">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_data_export.</span></span><span class="sig-name descname"><span class="pre">test_export_table_query_with_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_data_export.html#test_export_table_query_with_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_data_export.test_export_table_query_with_order" title="Link to this definition">¶</a></dt>
<dd><p>Test that the query string correctly appends the ORDER BY clause
when there are default order columns.</p>
<p>This test simulates the execution of a query with a default order
column (e.g., “ORDER BY id”) and verifies that the <cite>export_table_to_csv</cite>
function appends the ORDER BY clause in the query. It also checks if the
query is correctly passed to the pandas <cite>read_sql_query</cite> function and if
the <cite>to_csv</cite> method is invoked with the correct path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>monkeypatch</strong> – The monkeypatch fixture provided by pytest.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_data_export.test_export_table_query_without_order">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_data_export.</span></span><span class="sig-name descname"><span class="pre">test_export_table_query_without_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_data_export.html#test_export_table_query_without_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_data_export.test_export_table_query_without_order" title="Link to this definition">¶</a></dt>
<dd><p>Test that the query string does not include the ORDER BY clause
when there are no default order columns.</p>
<p>This test simulates the execution of a query without a default order
column and ensures that the <cite>export_table_to_csv</cite> function does not
append the ORDER BY clause to the query. It also checks that the
<cite>to_csv</cite> method is still called correctly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>monkeypatch</strong> – The monkeypatch fixture provided by pytest.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_data_export.test_main_exports_all_tables">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_data_export.</span></span><span class="sig-name descname"><span class="pre">test_main_exports_all_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_data_export.html#test_main_exports_all_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_data_export.test_main_exports_all_tables" title="Link to this definition">¶</a></dt>
<dd><p>Test the main() function to ensure it exports all tables in order
and closes the connection.</p>
<p>This test simulates the process of exporting all tables by calling
the <cite>main</cite> function and verifies that all expected tables are exported.
It also ensures that the database connection is closed after the export
process is complete.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>monkeypatch</strong> – The monkeypatch fixture provided by pytest.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-test.data_storage.test_data_storage_pipeline">
<span id="test-data-storage-test-data-storage-pipeline-module"></span><h2>test.data_storage.test_data_storage_pipeline module<a class="headerlink" href="#module-test.data_storage.test_data_storage_pipeline" title="Link to this heading">¶</a></h2>
<p>Module: main_tests</p>
<p>This module contains unit tests for the main module of the data storage
system. It tests various aspects of the main module’s functionality, such
as reading and writing completed modules, running shell commands, handling
module execution, and ensuring correct pipeline behavior.</p>
<p>Tests use pytest’s monkeypatching and mocking techniques to simulate
various scenarios and edge cases.</p>
<p>Each function is designed to ensure the main module performs as expected
under different conditions, including success and failure cases.</p>
<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_data_storage_pipeline.test_main_pipeline_failure">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_data_storage_pipeline.</span></span><span class="sig-name descname"><span class="pre">test_main_pipeline_failure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_data_storage_pipeline.html#test_main_pipeline_failure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_data_storage_pipeline.test_main_pipeline_failure" title="Link to this definition">¶</a></dt>
<dd><p>Test that the main function exits with an error when a module fails.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_data_storage_pipeline.test_main_skip_and_execute">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_data_storage_pipeline.</span></span><span class="sig-name descname"><span class="pre">test_main_skip_and_execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_data_storage_pipeline.html#test_main_skip_and_execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_data_storage_pipeline.test_main_skip_and_execute" title="Link to this definition">¶</a></dt>
<dd><p>Test the main function to ensure that already completed modules are skipped
and that the remaining modules are executed in the correct order.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_data_storage_pipeline.test_read_completed_modules">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_data_storage_pipeline.</span></span><span class="sig-name descname"><span class="pre">test_read_completed_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmp_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_data_storage_pipeline.html#test_read_completed_modules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_data_storage_pipeline.test_read_completed_modules" title="Link to this definition">¶</a></dt>
<dd><p>Test that the read_completed_modules function behaves correctly when
the file does or does not exist.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_data_storage_pipeline.test_run_command_success_and_failure">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_data_storage_pipeline.</span></span><span class="sig-name descname"><span class="pre">test_run_command_success_and_failure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_data_storage_pipeline.html#test_run_command_success_and_failure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_data_storage_pipeline.test_run_command_success_and_failure" title="Link to this definition">¶</a></dt>
<dd><p>Test the run_command function for both success and failure scenarios.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_data_storage_pipeline.test_write_completed_module">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_data_storage_pipeline.</span></span><span class="sig-name descname"><span class="pre">test_write_completed_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmp_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_data_storage_pipeline.html#test_write_completed_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_data_storage_pipeline.test_write_completed_module" title="Link to this definition">¶</a></dt>
<dd><p>Test that the write_completed_module function correctly appends module
names to the completed file.</p>
</dd></dl>

</section>
<section id="module-test.data_storage.test_llm_analyse">
<span id="test-data-storage-test-llm-analyse-module"></span><h2>test.data_storage.test_llm_analyse module<a class="headerlink" href="#module-test.data_storage.test_llm_analyse" title="Link to this heading">¶</a></h2>
<p>Module for testing the LLM (Large Language Model) analysis functions.
This module contains various test cases to ensure the correct behavior of
functions like build_prompt, process_row, update_result, and others in
the llm_analyse module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.DummyConnection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_analyse.</span></span><span class="sig-name descname"><span class="pre">DummyConnection</span></span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#DummyConnection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.DummyConnection" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A dummy database connection class to simulate database connection behavior.</p>
<p>This class is used to simulate database connection operations during testing.</p>
<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.DummyConnection.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#DummyConnection.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.DummyConnection.close" title="Link to this definition">¶</a></dt>
<dd><p>Simulate closing the connection.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.DummyConnection.commit">
<span class="sig-name descname"><span class="pre">commit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#DummyConnection.commit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.DummyConnection.commit" title="Link to this definition">¶</a></dt>
<dd><p>Simulate committing a transaction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.DummyConnection.cursor">
<span class="sig-name descname"><span class="pre">cursor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#DummyConnection.cursor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.DummyConnection.cursor" title="Link to this definition">¶</a></dt>
<dd><p>Simulate getting a cursor from the connection.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dummy cursor instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#test.data_storage.test_llm_analyse.DummyCursor" title="test.data_storage.test_llm_analyse.DummyCursor">DummyCursor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.DummyConnection.rollback">
<span class="sig-name descname"><span class="pre">rollback</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#DummyConnection.rollback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.DummyConnection.rollback" title="Link to this definition">¶</a></dt>
<dd><p>Simulate rolling back a transaction.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.DummyCursor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_analyse.</span></span><span class="sig-name descname"><span class="pre">DummyCursor</span></span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#DummyCursor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.DummyCursor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A dummy database cursor class to simulate database cursor behavior.</p>
<p>This class is used to simulate cursor behavior for database operations
during testing, specifically for testing the update_result function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.DummyCursor.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#DummyCursor.execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.DummyCursor.execute" title="Link to this definition">¶</a></dt>
<dd><p>Simulate executing a database query.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<em>str</em>) – The SQL query string to be executed.</p></li>
<li><p><strong>params</strong> (<em>tuple</em>) – The parameters to be passed to the query.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.test_build_prompt_target_vs_non_target">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_analyse.</span></span><span class="sig-name descname"><span class="pre">test_build_prompt_target_vs_non_target</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#test_build_prompt_target_vs_non_target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.test_build_prompt_target_vs_non_target" title="Link to this definition">¶</a></dt>
<dd><p>Test the build_prompt function for target vs non-target classes.</p>
<p>This test verifies that the output prompt varies based on whether the
target class is specified or not.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.test_is_valid_number">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_analyse.</span></span><span class="sig-name descname"><span class="pre">test_is_valid_number</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#test_is_valid_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.test_is_valid_number" title="Link to this definition">¶</a></dt>
<dd><p>Test the is_valid_number function for valid and invalid number inputs.</p>
<p>This test checks if the function correctly identifies valid numeric values
and handles invalid inputs like strings, None, or empty values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.test_main_concurrent_processing">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_analyse.</span></span><span class="sig-name descname"><span class="pre">test_main_concurrent_processing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capsys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#test_main_concurrent_processing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.test_main_concurrent_processing" title="Link to this definition">¶</a></dt>
<dd><p>Test the main function with concurrent processing logic, including both successful
and failed tasks.</p>
<p>This test simulates a multi-threaded environment where multiple rows are processed concurrently,
some successfully and some failing, and verifies the expected output messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monkeypatch</strong> (<em>pytest.MonkeyPatch</em>) – The monkeypatch object for mocking.</p></li>
<li><p><strong>capsys</strong> (<em>pytest.CaptureFixture</em>) – The capture fixture to capture the standard output.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.test_process_row_nontarget_invalid_number">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_analyse.</span></span><span class="sig-name descname"><span class="pre">test_process_row_nontarget_invalid_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#test_process_row_nontarget_invalid_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.test_process_row_nontarget_invalid_number" title="Link to this definition">¶</a></dt>
<dd><p>Test process_row function with target set to False and invalid number in the LLM output.</p>
<p>This test verifies that the function raises a ValueError and performs a rollback when
the output is a non-numeric value for a non-target row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>monkeypatch</strong> (<em>pytest.MonkeyPatch</em>) – The monkeypatch object for mocking.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.test_process_row_nontarget_json_error">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_analyse.</span></span><span class="sig-name descname"><span class="pre">test_process_row_nontarget_json_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#test_process_row_nontarget_json_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.test_process_row_nontarget_json_error" title="Link to this definition">¶</a></dt>
<dd><p>Test process_row function with target set to False and invalid JSON format.</p>
<p>This test checks if the function raises a JSONDecodeError when the LLM output is
an invalid JSON string and performs a rollback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>monkeypatch</strong> (<em>pytest.MonkeyPatch</em>) – The monkeypatch object for mocking.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.test_process_row_target_json_and_nonjson">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_analyse.</span></span><span class="sig-name descname"><span class="pre">test_process_row_target_json_and_nonjson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#test_process_row_target_json_and_nonjson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.test_process_row_target_json_and_nonjson" title="Link to this definition">¶</a></dt>
<dd><p>Test process_row function with target set to True for both valid and invalid JSON outputs.</p>
<p>This test checks if the function handles cases where the LLM returns valid JSON
or invalid JSON, and ensures that the appropriate values are passed for updating
the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>monkeypatch</strong> (<em>pytest.MonkeyPatch</em>) – The monkeypatch object for mocking.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.test_process_row_target_non_str_output">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_analyse.</span></span><span class="sig-name descname"><span class="pre">test_process_row_target_non_str_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#test_process_row_target_non_str_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.test_process_row_target_non_str_output" title="Link to this definition">¶</a></dt>
<dd><p>Test process_row function with target set to True when LLM outputs a non-string type.</p>
<p>This test ensures that the function correctly handles non-string types like bytes
and processes them appropriately without errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>monkeypatch</strong> (<em>pytest.MonkeyPatch</em>) – The monkeypatch object for mocking.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_analyse.test_update_result_executes_commit">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_analyse.</span></span><span class="sig-name descname"><span class="pre">test_update_result_executes_commit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_analyse.html#test_update_result_executes_commit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_analyse.test_update_result_executes_commit" title="Link to this definition">¶</a></dt>
<dd><p>Test that the update_result function executes an UPDATE query and commits.</p>
<p>This test verifies that the update_result function correctly executes
an UPDATE statement and commits the changes to the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>monkeypatch</strong> (<em>pytest.MonkeyPatch</em>) – The monkeypatch object for mocking.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-test.data_storage.test_llm_standardize">
<span id="test-data-storage-test-llm-standardize-module"></span><h2>test.data_storage.test_llm_standardize module<a class="headerlink" href="#module-test.data_storage.test_llm_standardize" title="Link to this heading">¶</a></h2>
<p>This module contains tests for the llm_standardize functionality, which includes the processing and standardization
of measurement units using LLM (Large Language Models). It includes dummy database connection and cursor classes to
simulate interactions with a database and test various edge cases, such as invalid or non-convertible data, successful
standardizations, and handling of JSON errors.</p>
<p>Tests cover the following aspects:
- Parsing of JSON wrapped in markdown
- Construction of conversion prompts
- Execution of database updates for standardized data
- Handling of unit mismatches and the conversion process
- Proper handling of success and failure cases for standardization</p>
<dl class="py class">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.DummyConnection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_standardize.</span></span><span class="sig-name descname"><span class="pre">DummyConnection</span></span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#DummyConnection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.DummyConnection" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A dummy implementation of a database connection, simulating commit, rollback, and cursor functionalities.</p>
<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.DummyConnection.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#DummyConnection.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.DummyConnection.close" title="Link to this definition">¶</a></dt>
<dd><p>Simulates closing the database connection.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.DummyConnection.commit">
<span class="sig-name descname"><span class="pre">commit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#DummyConnection.commit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.DummyConnection.commit" title="Link to this definition">¶</a></dt>
<dd><p>Simulates committing the current transaction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.DummyConnection.cursor">
<span class="sig-name descname"><span class="pre">cursor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#DummyConnection.cursor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.DummyConnection.cursor" title="Link to this definition">¶</a></dt>
<dd><p>Returns the simulated cursor object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The cursor object for executing queries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#test.data_storage.test_llm_standardize.DummyCursor" title="test.data_storage.test_llm_standardize.DummyCursor">DummyCursor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.DummyConnection.rollback">
<span class="sig-name descname"><span class="pre">rollback</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#DummyConnection.rollback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.DummyConnection.rollback" title="Link to this definition">¶</a></dt>
<dd><p>Simulates rolling back the current transaction.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.DummyCursor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_standardize.</span></span><span class="sig-name descname"><span class="pre">DummyCursor</span></span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#DummyCursor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.DummyCursor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A dummy implementation of a database cursor for simulating database interactions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.DummyCursor.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#DummyCursor.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.DummyCursor.close" title="Link to this definition">¶</a></dt>
<dd><p>Simulates closing the cursor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.DummyCursor.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#DummyCursor.execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.DummyCursor.execute" title="Link to this definition">¶</a></dt>
<dd><p>Simulates executing a database query.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<em>str</em>) – The SQL query string to execute.</p></li>
<li><p><strong>params</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional parameters for the SQL query.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.test_build_conversion_prompt_content">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_standardize.</span></span><span class="sig-name descname"><span class="pre">test_build_conversion_prompt_content</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#test_build_conversion_prompt_content"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.test_build_conversion_prompt_content" title="Link to this definition">¶</a></dt>
<dd><p>Test case for the build_conversion_prompt function to ensure the correct construction of conversion prompts.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.test_main_standardization_pipeline">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_standardize.</span></span><span class="sig-name descname"><span class="pre">test_main_standardization_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capsys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#test_main_standardization_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.test_main_standardization_pipeline" title="Link to this definition">¶</a></dt>
<dd><p>Test case for the main function in the standardization pipeline, including bulk processing and file output.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.test_process_row_convertible_false">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_standardize.</span></span><span class="sig-name descname"><span class="pre">test_process_row_convertible_false</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#test_process_row_convertible_false"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.test_process_row_convertible_false" title="Link to this definition">¶</a></dt>
<dd><p>Test case for the process_row function when LLM returns a response indicating that conversion is not possible.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.test_process_row_invalid_result_value">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_standardize.</span></span><span class="sig-name descname"><span class="pre">test_process_row_invalid_result_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capsys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#test_process_row_invalid_result_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.test_process_row_invalid_result_value" title="Link to this definition">¶</a></dt>
<dd><p>Test case for the process_row function when the LLM returns a non-numeric value after conversion.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.test_process_row_success">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_standardize.</span></span><span class="sig-name descname"><span class="pre">test_process_row_success</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#test_process_row_success"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.test_process_row_success" title="Link to this definition">¶</a></dt>
<dd><p>Test case for the process_row function when LLM returns a valid numeric conversion result.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.test_process_row_unit_match">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_standardize.</span></span><span class="sig-name descname"><span class="pre">test_process_row_unit_match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#test_process_row_unit_match"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.test_process_row_unit_match" title="Link to this definition">¶</a></dt>
<dd><p>Test case for the process_row function where the unit matches and no conversion is needed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.test_safe_json_parse_cleanup_and_errors">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_standardize.</span></span><span class="sig-name descname"><span class="pre">test_safe_json_parse_cleanup_and_errors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#test_safe_json_parse_cleanup_and_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.test_safe_json_parse_cleanup_and_errors" title="Link to this definition">¶</a></dt>
<dd><p>Test case for the <cite>safe_json_parse</cite> function to ensure proper handling of valid and invalid JSON strings.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_llm_standardize.test_update_standardized_execution">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_llm_standardize.</span></span><span class="sig-name descname"><span class="pre">test_update_standardized_execution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_llm_standardize.html#test_update_standardized_execution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_llm_standardize.test_update_standardized_execution" title="Link to this definition">¶</a></dt>
<dd><p>Test case for the update_standardized function to verify SQL execution and commit behavior.</p>
</dd></dl>

</section>
<section id="module-test.data_storage.test_paragraph_extraction">
<span id="test-data-storage-test-paragraph-extraction-module"></span><h2>test.data_storage.test_paragraph_extraction module<a class="headerlink" href="#module-test.data_storage.test_paragraph_extraction" title="Link to this heading">¶</a></h2>
<p>Test module for paragraph extraction functionality within the data storage module.
This module tests various functions including PDF paragraph extraction, database insertion,
memory usage checks, and the processing of multiple PDFs.</p>
<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_paragraph_extraction.mock_db">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_paragraph_extraction.</span></span><span class="sig-name descname"><span class="pre">mock_db</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_paragraph_extraction.html#mock_db"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_paragraph_extraction.mock_db" title="Link to this definition">¶</a></dt>
<dd><p>Fixture to mock database connection and cursor for testing database interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>mock_conn (MagicMock)</em> – The mocked database connection object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_paragraph_extraction.mock_minio">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_paragraph_extraction.</span></span><span class="sig-name descname"><span class="pre">mock_minio</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_paragraph_extraction.html#mock_minio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_paragraph_extraction.mock_minio" title="Link to this definition">¶</a></dt>
<dd><p>Fixture to mock MinIO client by patching the ‘fget_object’ method to return None.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>mock_fget (MagicMock)</em> – The mocked MinIO ‘fget_object’ method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_paragraph_extraction.test_check_memory_usage">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_paragraph_extraction.</span></span><span class="sig-name descname"><span class="pre">test_check_memory_usage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_paragraph_extraction.html#test_check_memory_usage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_paragraph_extraction.test_check_memory_usage" title="Link to this definition">¶</a></dt>
<dd><p>Test the memory usage check function.</p>
<p>Verifies that the function returns the correct value based on system memory usage.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_paragraph_extraction.test_extract_paragraphs_from_pdf">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_paragraph_extraction.</span></span><span class="sig-name descname"><span class="pre">test_extract_paragraphs_from_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_minio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_paragraph_extraction.html#test_extract_paragraphs_from_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_paragraph_extraction.test_extract_paragraphs_from_pdf" title="Link to this definition">¶</a></dt>
<dd><p>Test the extraction of paragraphs from a PDF file.</p>
<p>Simulates the process of extracting text from a PDF and verifies that paragraphs
are correctly extracted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mock_minio</strong> (<em>MagicMock</em>) – The mocked MinIO client for testing purposes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_paragraph_extraction.test_find_matching_paragraphs">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_paragraph_extraction.</span></span><span class="sig-name descname"><span class="pre">test_find_matching_paragraphs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_paragraph_extraction.html#test_find_matching_paragraphs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_paragraph_extraction.test_find_matching_paragraphs" title="Link to this definition">¶</a></dt>
<dd><p>Test the functionality of finding paragraphs that match given keywords.</p>
<p>Verifies that the correct paragraphs are matched based on the provided keywords.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_paragraph_extraction.test_insert_matched_data">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_paragraph_extraction.</span></span><span class="sig-name descname"><span class="pre">test_insert_matched_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_minio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_paragraph_extraction.html#test_insert_matched_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_paragraph_extraction.test_insert_matched_data" title="Link to this definition">¶</a></dt>
<dd><p>Test the insertion of matched paragraphs into the database.</p>
<p>Verifies that the matched data is correctly inserted into the database and that the
proper SQL statement is executed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mock_db</strong> (<em>MagicMock</em>) – The mocked database connection object.</p></li>
<li><p><strong>mock_minio</strong> (<em>MagicMock</em>) – The mocked MinIO client for testing purposes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_paragraph_extraction.test_memory_management">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_paragraph_extraction.</span></span><span class="sig-name descname"><span class="pre">test_memory_management</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_paragraph_extraction.html#test_memory_management"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_paragraph_extraction.test_memory_management" title="Link to this definition">¶</a></dt>
<dd><p>Test the memory management functionality by simulating high and low memory usage.</p>
<p>Verifies that the system behaves as expected under varying memory conditions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_paragraph_extraction.test_parse_security_and_year">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_paragraph_extraction.</span></span><span class="sig-name descname"><span class="pre">test_parse_security_and_year</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_paragraph_extraction.html#test_parse_security_and_year"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_paragraph_extraction.test_parse_security_and_year" title="Link to this definition">¶</a></dt>
<dd><p>Test the extraction of security and year information from a file name.</p>
<p>Verifies that the correct security ticker and year are parsed from the file name.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_paragraph_extraction.test_process_all_pdfs">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_paragraph_extraction.</span></span><span class="sig-name descname"><span class="pre">test_process_all_pdfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_fget</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_list_objects</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_db</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_paragraph_extraction.html#test_process_all_pdfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_paragraph_extraction.test_process_all_pdfs" title="Link to this definition">¶</a></dt>
<dd><p>Test the processing of all PDF files from MinIO.</p>
<p>Verifies that all PDFs are processed correctly, including the retrieval and handling
of files, database updates, and the execution of relevant queries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mock_fget</strong> (<em>MagicMock</em>) – The mocked MinIO ‘fget_object’ method.</p></li>
<li><p><strong>mock_list_objects</strong> (<em>MagicMock</em>) – The mocked MinIO ‘list_objects’ method.</p></li>
<li><p><strong>mock_db</strong> (<em>MagicMock</em>) – The mocked database connection object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_paragraph_extraction.test_process_report">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_paragraph_extraction.</span></span><span class="sig-name descname"><span class="pre">test_process_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_fget</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_db</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_paragraph_extraction.html#test_process_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_paragraph_extraction.test_process_report" title="Link to this definition">¶</a></dt>
<dd><p>Test the processing of a report file.</p>
<p>Simulates the entire process of handling a report, including database interactions,
memory usage checks, and file handling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mock_fget</strong> (<em>MagicMock</em>) – The mocked MinIO ‘fget_object’ method.</p></li>
<li><p><strong>mock_db</strong> (<em>MagicMock</em>) – The mocked database connection object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-test.data_storage.test_retry_failed_reports">
<span id="test-data-storage-test-retry-failed-reports-module"></span><h2>test.data_storage.test_retry_failed_reports module<a class="headerlink" href="#module-test.data_storage.test_retry_failed_reports" title="Link to this heading">¶</a></h2>
<p>Test module for retrying failed reports in the paragraph extraction module.
This module tests the retry logic for handling failed report downloads,
matching paragraphs in PDFs, and database interactions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_retry_failed_reports.test_download_error">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_retry_failed_reports.</span></span><span class="sig-name descname"><span class="pre">test_download_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_connect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_fget</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_open_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_exists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_retry_failed_reports.html#test_download_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_retry_failed_reports.test_download_error" title="Link to this definition">¶</a></dt>
<dd><p>Test case where the file download fails during the retry process.</p>
<p>Verifies that the function handles download errors appropriately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mock_connect</strong> (<em>MagicMock</em>) – Mocked psycopg2 connect method for simulating database connection.</p></li>
<li><p><strong>mock_fget</strong> (<em>MagicMock</em>) – Mocked MinIO ‘fget_object’ method to simulate a download error.</p></li>
<li><p><strong>mock_open_file</strong> (<em>MagicMock</em>) – Mocked open function to simulate reading a PDF file name.</p></li>
<li><p><strong>mock_exists</strong> (<em>MagicMock</em>) – Mocked Path.exists method to simulate file existence.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_retry_failed_reports.test_empty_failed_json">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_retry_failed_reports.</span></span><span class="sig-name descname"><span class="pre">test_empty_failed_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_open_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_exists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_retry_failed_reports.html#test_empty_failed_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_retry_failed_reports.test_empty_failed_json" title="Link to this definition">¶</a></dt>
<dd><p>Test case where the ‘failed_reports.json’ file is empty.</p>
<p>Verifies that the function does not attempt any processing when the JSON file
is empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mock_open_file</strong> (<em>MagicMock</em>) – Mocked open function to simulate reading an empty list.</p></li>
<li><p><strong>mock_exists</strong> (<em>MagicMock</em>) – Mocked Path.exists method to simulate file existence.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_retry_failed_reports.test_failed_json_removed_after_success">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_retry_failed_reports.</span></span><span class="sig-name descname"><span class="pre">test_failed_json_removed_after_success</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_unlink</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_remove</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_os_exists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_connect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_fget</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_open_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_exists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_retry_failed_reports.html#test_failed_json_removed_after_success"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_retry_failed_reports.test_failed_json_removed_after_success" title="Link to this definition">¶</a></dt>
<dd><p>Test case where all files are successfully processed and the ‘failed_reports.json’ is deleted.</p>
<p>Verifies that the function properly removes the ‘failed_reports.json’ after all files are successfully processed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mock_unlink</strong> (<em>MagicMock</em>) – Mocked Path.unlink method to simulate file deletion.</p></li>
<li><p><strong>mock_remove</strong> (<em>MagicMock</em>) – Mocked os.remove method to simulate file removal.</p></li>
<li><p><strong>mock_os_exists</strong> (<em>MagicMock</em>) – Mocked os.path.exists method to simulate file existence.</p></li>
<li><p><strong>mock_pdf</strong> (<em>MagicMock</em>) – Mocked pdfplumber.open to simulate PDF page extraction.</p></li>
<li><p><strong>mock_connect</strong> (<em>MagicMock</em>) – Mocked psycopg2 connect method for simulating database connection.</p></li>
<li><p><strong>mock_fget</strong> (<em>MagicMock</em>) – Mocked MinIO ‘fget_object’ method for simulating file retrieval.</p></li>
<li><p><strong>mock_open_file</strong> (<em>MagicMock</em>) – Mocked open function to simulate reading a PDF file name.</p></li>
<li><p><strong>mock_exists</strong> (<em>MagicMock</em>) – Mocked Path.exists method to simulate file existence.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_retry_failed_reports.test_invalid_filename_skipped">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_retry_failed_reports.</span></span><span class="sig-name descname"><span class="pre">test_invalid_filename_skipped</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_connect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_open_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_exists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_retry_failed_reports.html#test_invalid_filename_skipped"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_retry_failed_reports.test_invalid_filename_skipped" title="Link to this definition">¶</a></dt>
<dd><p>Test case where ‘parse_security_and_year’ returns None due to an invalid file name.</p>
<p>Verifies that the function skips processing for invalid filenames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mock_connect</strong> (<em>MagicMock</em>) – Mocked psycopg2 connect method for simulating database connection.</p></li>
<li><p><strong>mock_open_file</strong> (<em>MagicMock</em>) – Mocked open function to simulate reading an invalid file name.</p></li>
<li><p><strong>mock_exists</strong> (<em>MagicMock</em>) – Mocked Path.exists method to simulate file existence.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_retry_failed_reports.test_no_failed_json">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_retry_failed_reports.</span></span><span class="sig-name descname"><span class="pre">test_no_failed_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_exists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_retry_failed_reports.html#test_no_failed_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_retry_failed_reports.test_no_failed_json" title="Link to this definition">¶</a></dt>
<dd><p>Test case where the ‘failed_reports.json’ file does not exist.</p>
<p>Verifies that the function does not raise an error and returns immediately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mock_exists</strong> (<em>MagicMock</em>) – Mocked Path.exists method to simulate file absence.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_retry_failed_reports.test_no_matching_paragraphs">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_retry_failed_reports.</span></span><span class="sig-name descname"><span class="pre">test_no_matching_paragraphs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_connect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_fget</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_open_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_exists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_retry_failed_reports.html#test_no_matching_paragraphs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_retry_failed_reports.test_no_matching_paragraphs" title="Link to this definition">¶</a></dt>
<dd><p>Test case where no paragraphs match the given keywords.</p>
<p>Verifies that the function skips further processing when no matching paragraphs are found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mock_pdf</strong> (<em>MagicMock</em>) – Mocked pdfplumber.open to simulate PDF page extraction.</p></li>
<li><p><strong>mock_connect</strong> (<em>MagicMock</em>) – Mocked psycopg2 connect method for simulating database connection.</p></li>
<li><p><strong>mock_fget</strong> (<em>MagicMock</em>) – Mocked MinIO ‘fget_object’ method for simulating file retrieval.</p></li>
<li><p><strong>mock_open_file</strong> (<em>MagicMock</em>) – Mocked open function to simulate reading a PDF file name.</p></li>
<li><p><strong>mock_exists</strong> (<em>MagicMock</em>) – Mocked Path.exists method to simulate file existence.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_retry_failed_reports.test_pdf_page_no_text">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_retry_failed_reports.</span></span><span class="sig-name descname"><span class="pre">test_pdf_page_no_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_connect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_fget</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_open_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_exists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_retry_failed_reports.html#test_pdf_page_no_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_retry_failed_reports.test_pdf_page_no_text" title="Link to this definition">¶</a></dt>
<dd><p>Test case where the PDF page extraction returns None (no text extracted).</p>
<p>Verifies that the function handles the case of missing text on a PDF page appropriately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mock_pdf</strong> (<em>MagicMock</em>) – Mocked pdfplumber.open to simulate PDF page extraction.</p></li>
<li><p><strong>mock_connect</strong> (<em>MagicMock</em>) – Mocked psycopg2 connect method for simulating database connection.</p></li>
<li><p><strong>mock_fget</strong> (<em>MagicMock</em>) – Mocked MinIO ‘fget_object’ method for simulating file retrieval.</p></li>
<li><p><strong>mock_open_file</strong> (<em>MagicMock</em>) – Mocked open function to simulate reading a PDF file name.</p></li>
<li><p><strong>mock_exists</strong> (<em>MagicMock</em>) – Mocked Path.exists method to simulate file existence.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="test.data_storage.test_retry_failed_reports.test_successful_extraction">
<span class="sig-prename descclassname"><span class="pre">test.data_storage.test_retry_failed_reports.</span></span><span class="sig-name descname"><span class="pre">test_successful_extraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mock_remove</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_os_exists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_connect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_fget</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_open_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock_exists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/test/data_storage/test_retry_failed_reports.html#test_successful_extraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test.data_storage.test_retry_failed_reports.test_successful_extraction" title="Link to this definition">¶</a></dt>
<dd><p>Test case where the paragraph extraction is successful and database updates occur.</p>
<p>Verifies that the extraction is successful, the data is processed, and the database is updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mock_remove</strong> (<em>MagicMock</em>) – Mocked os.remove method to simulate file removal.</p></li>
<li><p><strong>mock_os_exists</strong> (<em>MagicMock</em>) – Mocked os.path.exists method to simulate file existence.</p></li>
<li><p><strong>mock_pdf</strong> (<em>MagicMock</em>) – Mocked pdfplumber.open to simulate PDF page extraction.</p></li>
<li><p><strong>mock_connect</strong> (<em>MagicMock</em>) – Mocked psycopg2 connect method for simulating database connection.</p></li>
<li><p><strong>mock_fget</strong> (<em>MagicMock</em>) – Mocked MinIO ‘fget_object’ method for simulating file retrieval.</p></li>
<li><p><strong>mock_open_file</strong> (<em>MagicMock</em>) – Mocked open function to simulate reading a PDF file name.</p></li>
<li><p><strong>mock_exists</strong> (<em>MagicMock</em>) – Mocked Path.exists method to simulate file existence.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-test.data_storage">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-test.data_storage" title="Link to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Bigdata_cw2_Jacaranda</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="modules.html">modules package</a></li>
<li class="toctree-l1"><a class="reference internal" href="my_fastapi.html">my_fastapi package</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="test.html">test package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="test.html#subpackages">Subpackages</a></li>
<li class="toctree-l2"><a class="reference internal" href="test.html#module-test">Module contents</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="test.html">test package</a><ul>
      <li>Previous: <a href="test.html" title="previous chapter">test package</a></li>
      <li>Next: <a href="test.frontend.html" title="next chapter">test.frontend package</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Roger.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/test.data_storage.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>